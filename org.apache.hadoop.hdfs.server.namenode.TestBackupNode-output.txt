2016-09-12 17:14:26,676 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:<init>(446)) - starting cluster: numNameNodes=1, numDataNodes=0
Formatting using clusterid: testClusterID
2016-09-12 17:14:28,198 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(727)) - No KeyProvider found.
2016-09-12 17:14:28,199 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(737)) - fsLock is fair:true
2016-09-12 17:14:28,287 INFO  Configuration.deprecation (Configuration.java:warnOnceIfDeprecated(1173)) - hadoop.configured.node.mapping is deprecated. Instead, use net.topology.configured.node.mapping
2016-09-12 17:14:28,288 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(242)) - dfs.block.invalidate.limit=1000
2016-09-12 17:14:28,288 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(248)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2016-09-12 17:14:28,291 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(71)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2016-09-12 17:14:28,297 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(76)) - The block deletion will start around 2016 九月 12 17:14:28
2016-09-12 17:14:28,302 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map BlocksMap
2016-09-12 17:14:28,302 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:28,306 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 2.0% max memory 3.6 GB = 72.8 MB
2016-09-12 17:14:28,307 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^23 = 8388608 entries
2016-09-12 17:14:28,349 INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(365)) - dfs.block.access.token.enable=false
2016-09-12 17:14:28,350 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(350)) - defaultReplication         = 0
2016-09-12 17:14:28,350 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(351)) - maxReplication             = 512
2016-09-12 17:14:28,350 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(352)) - minReplication             = 1
2016-09-12 17:14:28,355 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(353)) - maxReplicationStreams      = 2
2016-09-12 17:14:28,356 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(354)) - shouldCheckForEnoughRacks  = false
2016-09-12 17:14:28,356 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(355)) - replicationRecheckInterval = 3000
2016-09-12 17:14:28,357 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(356)) - encryptDataTransfer        = false
2016-09-12 17:14:28,357 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(357)) - maxNumBlocksToLog          = 1000
2016-09-12 17:14:28,374 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(757)) - fsOwner             = root (auth:SIMPLE)
2016-09-12 17:14:28,374 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(758)) - supergroup          = supergroup
2016-09-12 17:14:28,375 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(759)) - isPermissionEnabled = true
2016-09-12 17:14:28,396 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(770)) - HA Enabled: false
2016-09-12 17:14:28,404 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(809)) - Append Enabled: true
2016-09-12 17:14:28,801 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map INodeMap
2016-09-12 17:14:28,802 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:28,802 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 1.0% max memory 3.6 GB = 36.4 MB
2016-09-12 17:14:28,803 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^22 = 4194304 entries
2016-09-12 17:14:28,807 INFO  namenode.FSDirectory (FSDirectory.java:<init>(235)) - ACLs enabled? false
2016-09-12 17:14:28,807 INFO  namenode.FSDirectory (FSDirectory.java:<init>(239)) - XAttrs enabled? true
2016-09-12 17:14:28,808 INFO  namenode.FSDirectory (FSDirectory.java:<init>(247)) - Maximum size of an xattr: 16384
2016-09-12 17:14:28,808 INFO  namenode.NameNode (FSDirectory.java:<init>(295)) - Caching file names occuring more than 10 times
2016-09-12 17:14:28,821 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map cachedBlocks
2016-09-12 17:14:28,822 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:28,822 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.25% max memory 3.6 GB = 9.1 MB
2016-09-12 17:14:28,823 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^20 = 1048576 entries
2016-09-12 17:14:28,825 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5664)) - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2016-09-12 17:14:28,826 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5665)) - dfs.namenode.safemode.min.datanodes = 0
2016-09-12 17:14:28,826 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5666)) - dfs.namenode.safemode.extension     = 0
2016-09-12 17:14:28,826 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:28,833 INFO  metrics.TopMetrics (TopMetrics.java:logConf(65)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2016-09-12 17:14:28,833 INFO  metrics.TopMetrics (TopMetrics.java:logConf(67)) - NNTop conf: dfs.namenode.top.num.users = 10
2016-09-12 17:14:28,834 INFO  metrics.TopMetrics (TopMetrics.java:logConf(69)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2016-09-12 17:14:28,836 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(920)) - Retry cache on namenode is enabled
2016-09-12 17:14:28,836 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(928)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2016-09-12 17:14:28,839 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map NameNodeRetryCache
2016-09-12 17:14:28,840 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:28,840 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.029999999329447746% max memory 3.6 GB = 1.1 MB
2016-09-12 17:14:28,841 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^17 = 131072 entries
2016-09-12 17:14:28,966 INFO  namenode.FSImage (FSImage.java:format(168)) - Allocated new BlockPoolId: BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:29,314 INFO  common.Storage (NNStorage.java:format(552)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1 has been successfully formatted.
2016-09-12 17:14:29,346 INFO  common.Storage (NNStorage.java:format(552)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2 has been successfully formatted.
2016-09-12 17:14:29,587 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage.ckpt_0000000000000000000 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000
2016-09-12 17:14:29,588 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage.ckpt_0000000000000000000 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000000
2016-09-12 17:14:29,607 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 1 images with txid >= 0
2016-09-12 17:14:29,611 INFO  namenode.NameNode (NameNode.java:createNameNode(1419)) - createNameNode []
2016-09-12 17:14:29,693 WARN  impl.MetricsConfig (MetricsConfig.java:loadFirst(125)) - Cannot locate configuration: tried hadoop-metrics2-namenode.properties,hadoop-metrics2.properties
2016-09-12 17:14:29,825 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:startTimer(377)) - Scheduled snapshot period at 10 second(s).
2016-09-12 17:14:29,826 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:start(192)) - NameNode metrics system started
2016-09-12 17:14:29,834 INFO  namenode.NameNode (NameNode.java:setClientNamenodeAddress(399)) - fs.defaultFS is hdfs://127.0.0.1:0
2016-09-12 17:14:29,910 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1703)) - Starting Web-server for hdfs at: http://localhost:0
2016-09-12 17:14:30,060 INFO  mortbay.log (Slf4jLog.java:info(67)) - Logging to org.slf4j.impl.Log4jLoggerAdapter(org.mortbay.log) via org.mortbay.log.Slf4jLog
2016-09-12 17:14:30,078 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:30,091 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.namenode is not defined
2016-09-12 17:14:30,105 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:30,110 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hdfs
2016-09-12 17:14:30,111 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:30,111 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:30,153 INFO  http.HttpServer2 (NameNodeHttpServer.java:initWebHdfs(86)) - Added filter 'org.apache.hadoop.hdfs.web.AuthFilter' (class=org.apache.hadoop.hdfs.web.AuthFilter)
2016-09-12 17:14:30,155 INFO  http.HttpServer2 (HttpServer2.java:addJerseyResourcePackage(609)) - addJerseyResourcePackage: packageName=org.apache.hadoop.hdfs.server.namenode.web.resources;org.apache.hadoop.hdfs.web.resources, pathSpec=/webhdfs/v1/*
2016-09-12 17:14:30,184 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 45063
2016-09-12 17:14:30,185 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:30,321 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:45063
2016-09-12 17:14:30,334 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(727)) - No KeyProvider found.
2016-09-12 17:14:30,334 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(737)) - fsLock is fair:true
2016-09-12 17:14:30,337 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(242)) - dfs.block.invalidate.limit=1000
2016-09-12 17:14:30,337 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(248)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2016-09-12 17:14:30,338 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(71)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2016-09-12 17:14:30,339 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(76)) - The block deletion will start around 2016 九月 12 17:14:30
2016-09-12 17:14:30,339 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map BlocksMap
2016-09-12 17:14:30,340 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:30,340 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 2.0% max memory 3.6 GB = 72.8 MB
2016-09-12 17:14:30,341 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^23 = 8388608 entries
2016-09-12 17:14:30,356 INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(365)) - dfs.block.access.token.enable=false
2016-09-12 17:14:30,357 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(350)) - defaultReplication         = 0
2016-09-12 17:14:30,357 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(351)) - maxReplication             = 512
2016-09-12 17:14:30,357 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(352)) - minReplication             = 1
2016-09-12 17:14:30,358 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(353)) - maxReplicationStreams      = 2
2016-09-12 17:14:30,358 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(354)) - shouldCheckForEnoughRacks  = false
2016-09-12 17:14:30,358 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(355)) - replicationRecheckInterval = 3000
2016-09-12 17:14:30,359 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(356)) - encryptDataTransfer        = false
2016-09-12 17:14:30,359 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(357)) - maxNumBlocksToLog          = 1000
2016-09-12 17:14:30,360 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(757)) - fsOwner             = root (auth:SIMPLE)
2016-09-12 17:14:30,360 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(758)) - supergroup          = supergroup
2016-09-12 17:14:30,385 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(759)) - isPermissionEnabled = true
2016-09-12 17:14:30,386 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(770)) - HA Enabled: false
2016-09-12 17:14:30,387 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(809)) - Append Enabled: true
2016-09-12 17:14:30,388 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map INodeMap
2016-09-12 17:14:30,388 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:30,389 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 1.0% max memory 3.6 GB = 36.4 MB
2016-09-12 17:14:30,389 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^22 = 4194304 entries
2016-09-12 17:14:30,396 INFO  namenode.FSDirectory (FSDirectory.java:<init>(235)) - ACLs enabled? false
2016-09-12 17:14:30,399 INFO  namenode.FSDirectory (FSDirectory.java:<init>(239)) - XAttrs enabled? true
2016-09-12 17:14:30,400 INFO  namenode.FSDirectory (FSDirectory.java:<init>(247)) - Maximum size of an xattr: 16384
2016-09-12 17:14:30,403 INFO  namenode.NameNode (FSDirectory.java:<init>(295)) - Caching file names occuring more than 10 times
2016-09-12 17:14:30,404 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map cachedBlocks
2016-09-12 17:14:30,404 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:30,405 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.25% max memory 3.6 GB = 9.1 MB
2016-09-12 17:14:30,405 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^20 = 1048576 entries
2016-09-12 17:14:30,407 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5664)) - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2016-09-12 17:14:30,407 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5665)) - dfs.namenode.safemode.min.datanodes = 0
2016-09-12 17:14:30,408 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5666)) - dfs.namenode.safemode.extension     = 0
2016-09-12 17:14:30,408 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:30,409 INFO  metrics.TopMetrics (TopMetrics.java:logConf(65)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2016-09-12 17:14:30,410 INFO  metrics.TopMetrics (TopMetrics.java:logConf(67)) - NNTop conf: dfs.namenode.top.num.users = 10
2016-09-12 17:14:30,410 INFO  metrics.TopMetrics (TopMetrics.java:logConf(69)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2016-09-12 17:14:30,411 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(920)) - Retry cache on namenode is enabled
2016-09-12 17:14:30,411 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(928)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2016-09-12 17:14:30,411 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map NameNodeRetryCache
2016-09-12 17:14:30,412 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:30,412 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.029999999329447746% max memory 3.6 GB = 1.1 MB
2016-09-12 17:14:30,413 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^17 = 131072 entries
2016-09-12 17:14:30,443 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:30,467 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:30,468 TRACE namenode.FSImage (FSImage.java:recoverTransitionRead(228)) - Data dir states:
  Storage Directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1: NORMAL
  Storage Directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2: NORMAL
2016-09-12 17:14:30,474 INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(362)) - Recovering unfinalized segments in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current
2016-09-12 17:14:30,475 INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(362)) - Recovering unfinalized segments in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current
2016-09-12 17:14:30,476 INFO  namenode.FSImage (FSImage.java:loadFSImage(679)) - No edit log streams selected.
2016-09-12 17:14:30,477 DEBUG namenode.FSImage (FSImage.java:loadFSImageFile(740)) - Planning to load image :
FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000, cpktTxId=0000000000000000000)
2016-09-12 17:14:30,503 INFO  namenode.FSImageFormatPBINode (FSImageFormatPBINode.java:loadINodeSection(259)) - Loading 1 INodes.
2016-09-12 17:14:30,516 INFO  namenode.FSImageFormatProtobuf (FSImageFormatProtobuf.java:load(181)) - Loaded FSImage in 0 seconds.
2016-09-12 17:14:30,517 INFO  namenode.FSImage (FSImage.java:loadFSImage(982)) - Loaded image for txid 0 from /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000
2016-09-12 17:14:30,517 DEBUG namenode.FSImage (FSImage.java:loadEdits(834)) - About to load edits:
  
2016-09-12 17:14:30,526 INFO  namenode.FSNamesystem (FSNamesystem.java:loadFSImage(997)) - Need to save fs image? false (staleImage=false, haEnabled=false, isRollingUpgrade=false)
2016-09-12 17:14:30,527 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 1
2016-09-12 17:14:30,624 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2016-09-12 17:14:30,625 INFO  namenode.FSNamesystem (FSNamesystem.java:loadFromDisk(699)) - Finished loading FSImage in 208 msecs
2016-09-12 17:14:30,961 INFO  namenode.NameNode (NameNodeRpcServer.java:<init>(342)) - RPC server is binding to localhost:0
2016-09-12 17:14:30,975 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:31,003 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 60949
2016-09-12 17:14:31,068 INFO  namenode.NameNode (NameNode.java:initialize(654)) - Clients are to use localhost:60949 to access this namenode/service.
2016-09-12 17:14:31,073 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(6536)) - Registered FSNamesystemState MBean
2016-09-12 17:14:31,099 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:31,100 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:31,100 INFO  namenode.FSNamesystem (FSNamesystem.java:initializeReplQueues(1202)) - initializing replication queues
2016-09-12 17:14:31,101 INFO  hdfs.StateChange (FSNamesystem.java:leave(5739)) - STATE* Leaving safe mode after 0 secs
2016-09-12 17:14:31,102 INFO  hdfs.StateChange (FSNamesystem.java:leave(5751)) - STATE* Network topology has 0 racks and 0 datanodes
2016-09-12 17:14:31,103 INFO  hdfs.StateChange (FSNamesystem.java:leave(5754)) - STATE* UnderReplicatedBlocks has 0 blocks
2016-09-12 17:14:31,118 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:31,120 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2766)) - Total number of blocks            = 0
2016-09-12 17:14:31,121 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2767)) - Number of invalid blocks          = 0
2016-09-12 17:14:31,121 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2768)) - Number of under-replicated blocks = 0
2016-09-12 17:14:31,121 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2769)) - Number of  over-replicated blocks = 0
2016-09-12 17:14:31,121 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2771)) - Number of blocks being written    = 0
2016-09-12 17:14:31,121 INFO  hdfs.StateChange (BlockManager.java:processMisReplicatesAsync(2772)) - STATE* Replication Queue initialization scan for invalid, over- and under-replicated blocks completed in 19 msec
2016-09-12 17:14:31,201 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:31,202 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 60949: starting
2016-09-12 17:14:31,208 INFO  namenode.NameNode (NameNode.java:startCommonServices(697)) - NameNode RPC up at: localhost/127.0.0.1:60949
2016-09-12 17:14:31,209 INFO  namenode.FSNamesystem (FSNamesystem.java:startActiveServices(1123)) - Starting services required for active state
2016-09-12 17:14:31,217 INFO  blockmanagement.CacheReplicationMonitor (CacheReplicationMonitor.java:run(160)) - Starting CacheReplicationMonitor with interval 30000 milliseconds
2016-09-12 17:14:32,283 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2286)) - Cluster is active
2016-09-12 17:14:32,346 INFO  namenode.NameNode (NameNode.java:createNameNode(1419)) - createNameNode [-backup]
2016-09-12 17:14:32,347 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(159)) - BackupNode metrics system started (again)
2016-09-12 17:14:32,350 INFO  namenode.NameNode (NameNode.java:setClientNamenodeAddress(399)) - fs.defaultFS is hdfs://localhost:60949
2016-09-12 17:14:32,351 INFO  namenode.NameNode (NameNode.java:setClientNamenodeAddress(419)) - Clients are to use localhost:60949 to access this namenode/service.
2016-09-12 17:14:32,481 WARN  common.Util (Util.java:stringAsURI(56)) - Path /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/ should be specified as a URI in configuration files. Please update hdfs configuration.
2016-09-12 17:14:32,482 WARN  common.Util (Util.java:stringAsURI(56)) - Path /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/ should be specified as a URI in configuration files. Please update hdfs configuration.
2016-09-12 17:14:32,486 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(727)) - No KeyProvider found.
2016-09-12 17:14:32,486 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(737)) - fsLock is fair:true
2016-09-12 17:14:32,488 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(242)) - dfs.block.invalidate.limit=1000
2016-09-12 17:14:32,489 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(248)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2016-09-12 17:14:32,490 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(71)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2016-09-12 17:14:32,491 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(76)) - The block deletion will start around 2016 九月 12 17:14:32
2016-09-12 17:14:32,491 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map BlocksMap
2016-09-12 17:14:32,492 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:32,492 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 2.0% max memory 3.6 GB = 72.8 MB
2016-09-12 17:14:32,493 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^23 = 8388608 entries
2016-09-12 17:14:32,501 INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(365)) - dfs.block.access.token.enable=false
2016-09-12 17:14:32,502 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(350)) - defaultReplication         = 0
2016-09-12 17:14:32,503 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(351)) - maxReplication             = 512
2016-09-12 17:14:32,503 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(352)) - minReplication             = 1
2016-09-12 17:14:32,503 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(353)) - maxReplicationStreams      = 2
2016-09-12 17:14:32,504 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(354)) - shouldCheckForEnoughRacks  = false
2016-09-12 17:14:32,504 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(355)) - replicationRecheckInterval = 3000
2016-09-12 17:14:32,504 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(356)) - encryptDataTransfer        = false
2016-09-12 17:14:32,504 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(357)) - maxNumBlocksToLog          = 1000
2016-09-12 17:14:32,505 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(757)) - fsOwner             = root (auth:SIMPLE)
2016-09-12 17:14:32,505 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(758)) - supergroup          = supergroup
2016-09-12 17:14:32,506 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(759)) - isPermissionEnabled = true
2016-09-12 17:14:32,506 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(770)) - HA Enabled: false
2016-09-12 17:14:32,507 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(809)) - Append Enabled: true
2016-09-12 17:14:32,508 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map INodeMap
2016-09-12 17:14:32,508 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:32,509 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 1.0% max memory 3.6 GB = 36.4 MB
2016-09-12 17:14:32,509 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^22 = 4194304 entries
2016-09-12 17:14:32,625 INFO  namenode.FSDirectory (FSDirectory.java:<init>(235)) - ACLs enabled? false
2016-09-12 17:14:32,626 INFO  namenode.FSDirectory (FSDirectory.java:<init>(239)) - XAttrs enabled? true
2016-09-12 17:14:32,626 INFO  namenode.FSDirectory (FSDirectory.java:<init>(247)) - Maximum size of an xattr: 16384
2016-09-12 17:14:32,627 INFO  namenode.NameNode (FSDirectory.java:<init>(295)) - Caching file names occuring more than 10 times
2016-09-12 17:14:32,627 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map cachedBlocks
2016-09-12 17:14:32,628 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:32,628 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.25% max memory 3.6 GB = 9.1 MB
2016-09-12 17:14:32,629 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^20 = 1048576 entries
2016-09-12 17:14:32,630 WARN  namenode.FSNamesystem (FSNamesystem.java:<init>(5655)) - The threshold value should't be greater than 1, threshold: 1.5
2016-09-12 17:14:32,631 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5664)) - dfs.namenode.safemode.threshold-pct = 1.5
2016-09-12 17:14:32,631 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5665)) - dfs.namenode.safemode.min.datanodes = 0
2016-09-12 17:14:32,631 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5666)) - dfs.namenode.safemode.extension     = 2147483647
2016-09-12 17:14:32,632 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:32,632 INFO  metrics.TopMetrics (TopMetrics.java:logConf(65)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2016-09-12 17:14:32,633 INFO  metrics.TopMetrics (TopMetrics.java:logConf(67)) - NNTop conf: dfs.namenode.top.num.users = 10
2016-09-12 17:14:32,633 INFO  metrics.TopMetrics (TopMetrics.java:logConf(69)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2016-09-12 17:14:32,634 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(920)) - Retry cache on namenode is enabled
2016-09-12 17:14:32,634 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(928)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2016-09-12 17:14:32,634 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map NameNodeRetryCache
2016-09-12 17:14:32,635 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:32,635 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.029999999329447746% max memory 3.6 GB = 1.1 MB
2016-09-12 17:14:32,636 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^17 = 131072 entries
2016-09-12 17:14:32,659 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:32,660 INFO  namenode.FSImage (BackupImage.java:recoverCreateRead(130)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1 is not formatted.
2016-09-12 17:14:32,661 INFO  namenode.FSImage (BackupImage.java:recoverCreateRead(131)) - Formatting ...
2016-09-12 17:14:32,662 INFO  namenode.NameNode (NameNodeRpcServer.java:<init>(342)) - RPC server is binding to localhost:0
2016-09-12 17:14:32,663 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:32,665 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 40793
2016-09-12 17:14:32,685 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(6536)) - Registered FSNamesystemState MBean
2016-09-12 17:14:32,686 WARN  common.Util (Util.java:stringAsURI(56)) - Path /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/ should be specified as a URI in configuration files. Please update hdfs configuration.
2016-09-12 17:14:32,696 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:32,696 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:32,697 INFO  hdfs.StateChange (FSNamesystem.java:leave(5739)) - STATE* Leaving safe mode after 0 secs
2016-09-12 17:14:32,697 INFO  hdfs.StateChange (FSNamesystem.java:leave(5751)) - STATE* Network topology has 0 racks and 0 datanodes
2016-09-12 17:14:32,698 INFO  hdfs.StateChange (FSNamesystem.java:leave(5754)) - STATE* UnderReplicatedBlocks has 0 blocks
2016-09-12 17:14:32,699 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:32,728 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1703)) - Starting Web-server for hdfs at: http://localhost:0
2016-09-12 17:14:32,731 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:32,732 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.namenode is not defined
2016-09-12 17:14:32,734 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:32,736 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hdfs
2016-09-12 17:14:32,737 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:32,737 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:32,740 INFO  http.HttpServer2 (NameNodeHttpServer.java:initWebHdfs(86)) - Added filter 'org.apache.hadoop.hdfs.web.AuthFilter' (class=org.apache.hadoop.hdfs.web.AuthFilter)
2016-09-12 17:14:32,740 INFO  http.HttpServer2 (HttpServer2.java:addJerseyResourcePackage(609)) - addJerseyResourcePackage: packageName=org.apache.hadoop.hdfs.server.namenode.web.resources;org.apache.hadoop.hdfs.web.resources, pathSpec=/webhdfs/v1/*
2016-09-12 17:14:32,746 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 51987
2016-09-12 17:14:32,747 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:32,766 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:51987
2016-09-12 17:14:32,767 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:32,768 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 40793: starting
2016-09-12 17:14:32,773 INFO  namenode.NameNode (NameNode.java:startCommonServices(697)) - Backup Node RPC up at: localhost/127.0.0.1:40793
2016-09-12 17:14:32,776 INFO  hdfs.StateChange (FSNamesystem.java:reportStatus(6007)) - STATE* Safe mode is ON. 
It was turned on manually. Use "hdfs dfsadmin -safemode leave" to turn safe mode off.
2016-09-12 17:14:32,777 INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(362)) - Recovering unfinalized segments in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current
2016-09-12 17:14:32,786 INFO  namenode.FSEditLog (FSEditLog.java:registerBackupNode(1382)) - Registering new backup node: NamenodeRegistration(localhost:40793, role=Backup Node)
2016-09-12 17:14:32,794 INFO  namenode.Checkpointer (Checkpointer.java:initialize(108)) - Checkpoint Period : 3600 secs (60 min)
2016-09-12 17:14:32,794 INFO  namenode.Checkpointer (Checkpointer.java:initialize(111)) - Transactions count is  : 1000000, to trigger checkpoint
2016-09-12 17:14:32,795 INFO  namenode.FSNamesystem (FSNamesystem.java:startActiveServices(1123)) - Starting services required for active state
2016-09-12 17:14:32,797 INFO  namenode.TestBackupNode (TestBackupNode.java:waitCheckpointDone(115)) - Waiting checkpoint to complete... checkpoint txid should increase above 1
2016-09-12 17:14:32,799 INFO  blockmanagement.CacheReplicationMonitor (CacheReplicationMonitor.java:run(160)) - Starting CacheReplicationMonitor with interval 30000 milliseconds
2016-09-12 17:14:32,802 INFO  namenode.FSNamesystem (FSNamesystem.java:startCheckpoint(6347)) - Start checkpoint for localhost:40793
2016-09-12 17:14:32,802 INFO  namenode.FSImage (FSImage.java:startCheckpoint(1333)) - Start checkpoint at txid 1
2016-09-12 17:14:32,802 INFO  namenode.FSEditLog (FSEditLog.java:rollEditLog(1202)) - Rolling edit logs
2016-09-12 17:14:32,802 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 1
2016-09-12 17:14:32,805 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 2 Total time for transactions(ms): 2 Number of transactions batched in Syncs: 0 Number of syncs: 3 SyncTimes(ms): 3 4 
2016-09-12 17:14:32,806 ERROR namenode.FSNamesystem (FSNamesystem.java:run(5190)) - Swallowing exception in NameNodeEditLogRoller:
java.lang.IllegalStateException: Bad state: BETWEEN_LOG_SEGMENTS
	at com.google.common.base.Preconditions.checkState(Preconditions.java:172)
	at org.apache.hadoop.hdfs.server.namenode.FSEditLog.getCurSegmentTxId(FSEditLog.java:515)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem$NameNodeEditLogRoller.run(FSNamesystem.java:5181)
	at java.lang.Thread.run(Thread.java:745)
2016-09-12 17:14:32,808 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000001 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000001-0000000000000000002
2016-09-12 17:14:32,816 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000001 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000001-0000000000000000002
2016-09-12 17:14:32,817 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 3
2016-09-12 17:14:32,923 INFO  namenode.FSImage (BackupImage.java:namenodeStartedLogSegment(350)) - NameNode started a new log segment at txid 3
2016-09-12 17:14:32,923 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 3
2016-09-12 17:14:32,928 DEBUG namenode.FSImage (BackupImage.java:setState(338)) - State transition DROP_UNTIL_NEXT_ROLL -> JOURNAL_ONLY
2016-09-12 17:14:32,935 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 3; numTxns = 1
2016-09-12 17:14:33,077 DEBUG namenode.Checkpointer (Checkpointer.java:doCheckpoint(211)) - Doing checkpoint. Last applied: 0
2016-09-12 17:14:33,429 INFO  namenode.TransferFsImage (TransferFsImage.java:getFileClient(396)) - Opening connection to http://localhost:45063/imagetransfer?getedit=1&startTxId=1&endTxId=2&storageInfo=-63:1058246572:0:testClusterID
2016-09-12 17:14:33,485 INFO  namenode.TransferFsImage (TransferFsImage.java:setTimeout(443)) - Image Transfer timeout configured to 60000 milliseconds
2016-09-12 17:14:33,653 INFO  namenode.TransferFsImage (TransferFsImage.java:receiveFile(553)) - Transfer took 0.03s at 0.00 KB/s
2016-09-12 17:14:33,653 INFO  namenode.TransferFsImage (TransferFsImage.java:downloadEditsToStorage(168)) - Downloaded file edits_tmp_0000000000000000001-0000000000000000002_0000000000972366428 size 0 bytes.
2016-09-12 17:14:33,659 INFO  namenode.Checkpointer (Checkpointer.java:rollForwardByApplyingLogs(309)) - Checkpointer about to load edits from 1 stream(s).
2016-09-12 17:14:33,660 DEBUG namenode.FSImage (FSImage.java:loadEdits(834)) - About to load edits:
  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000001-0000000000000000002
2016-09-12 17:14:33,660 INFO  namenode.FSImage (FSImage.java:loadEdits(844)) - Reading /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000001-0000000000000000002 expecting start txid #1
2016-09-12 17:14:33,660 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000001-0000000000000000002
2016-09-12 17:14:33,668 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_END_LOG_SEGMENT=1
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:33,668 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000001-0000000000000000002 of size 42 edits # 2 loaded in 0 seconds
2016-09-12 17:14:33,669 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2016-09-12 17:14:33,717 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/fsimage.ckpt_0000000000000000002 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/fsimage_0000000000000000002
2016-09-12 17:14:33,718 INFO  namenode.FSImageTransactionalStorageInspector (FSImageTransactionalStorageInspector.java:inspectDirectory(85)) - No version file in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1
2016-09-12 17:14:33,777 INFO  namenode.TransferFsImage (TransferFsImage.java:receiveFile(553)) - Transfer took 0.02s at 0.00 KB/s
2016-09-12 17:14:33,778 INFO  namenode.TransferFsImage (TransferFsImage.java:handleUploadImageRequest(134)) - Downloaded file fsimage.ckpt_0000000000000000002 size 351 bytes.
2016-09-12 17:14:33,798 INFO  namenode.TestBackupNode (TestBackupNode.java:waitCheckpointDone(115)) - Waiting checkpoint to complete... checkpoint txid should increase above 1
2016-09-12 17:14:33,810 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage.ckpt_0000000000000000002 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000002
2016-09-12 17:14:33,810 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage.ckpt_0000000000000000002 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000002
2016-09-12 17:14:33,812 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 0
2016-09-12 17:14:33,817 INFO  namenode.TransferFsImage (TransferFsImage.java:uploadImageFromStorage(237)) - Uploaded image with txid 2 to namenode at http://localhost:45063 in 0.075 seconds
2016-09-12 17:14:33,821 INFO  namenode.FSNamesystem (FSNamesystem.java:endCheckpoint(6375)) - End checkpoint for localhost:40793
2016-09-12 17:14:33,821 INFO  namenode.FSImage (FSImage.java:endCheckpoint(1373)) - End checkpoint at txid 3
2016-09-12 17:14:33,852 INFO  namenode.FSImage (BackupImage.java:tryConvergeJournalSpool(314)) - Going to finish converging with remaining 1 txns from in-progress stream org.apache.hadoop.hdfs.server.namenode.RedundantEditLogInputStream@9cb18a4
2016-09-12 17:14:33,852 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000003
2016-09-12 17:14:33,853 INFO  namenode.EditLogInputStream (RedundantEditLogInputStream.java:nextOp(176)) - Fast-forwarding stream '/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000003' to transaction ID 3
2016-09-12 17:14:33,855 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:33,855 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000003 of size 1048576 edits # 1 loaded in 0 seconds
2016-09-12 17:14:33,856 INFO  namenode.FSImage (BackupImage.java:tryConvergeJournalSpool(326)) - Successfully synced BackupNode with NameNode at txnid 3
2016-09-12 17:14:33,856 DEBUG namenode.FSImage (BackupImage.java:setState(338)) - State transition JOURNAL_ONLY -> IN_SYNC
2016-09-12 17:14:33,857 INFO  namenode.Checkpointer (Checkpointer.java:doCheckpoint(278)) - Checkpoint completed in 1 seconds. New Image Size: 351
2016-09-12 17:14:34,803 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(462)) - examining name dir with files: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000003,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000001-0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000002.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/VERSION,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/seen_txid
2016-09-12 17:14:34,804 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(465)) - Examining storage dir /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current with contents: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000003, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000001-0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000002.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/VERSION, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/seen_txid
2016-09-12 17:14:34,804 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(462)) - examining name dir with files: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000003,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000001-0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000002.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/VERSION,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000000.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000000,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/seen_txid
2016-09-12 17:14:34,805 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(465)) - Examining storage dir /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current with contents: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000003, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000001-0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000002.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/VERSION, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000000.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000000, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/seen_txid
2016-09-12 17:14:34,808 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:startDataNodes(1413)) - Starting DataNode 0 with dfs.datanode.data.dir: [DISK]file:/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1,[DISK]file:/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2
2016-09-12 17:14:34,883 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(159)) - DataNode metrics system started (again)
2016-09-12 17:14:34,890 INFO  datanode.BlockScanner (BlockScanner.java:<init>(172)) - Initialized block scanner with targetBytesPerSec 1048576
2016-09-12 17:14:34,890 INFO  datanode.DataNode (DataNode.java:<init>(434)) - Configured hostname is 127.0.0.1
2016-09-12 17:14:34,892 INFO  datanode.DataNode (DataNode.java:startDataNode(1147)) - Starting DataNode with maxLockedMemory = 0
2016-09-12 17:14:34,907 INFO  datanode.DataNode (DataXceiverServer.java:<init>(76)) - Balancing bandwith is 1048576 bytes/s
2016-09-12 17:14:34,908 INFO  datanode.DataNode (DataXceiverServer.java:<init>(77)) - Number threads for balancing is 5
2016-09-12 17:14:34,912 INFO  datanode.DataNode (DataNode.java:initDataXceiver(929)) - Opened streaming server at /127.0.0.1:37818
2016-09-12 17:14:34,927 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:34,929 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.datanode is not defined
2016-09-12 17:14:34,930 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:34,933 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context datanode
2016-09-12 17:14:34,933 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:34,934 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:34,940 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 50289
2016-09-12 17:14:34,940 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:34,976 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:50289
2016-09-12 17:14:35,209 INFO  web.DatanodeHttpServer (DatanodeHttpServer.java:start(186)) - Listening HTTP traffic on /127.0.0.1:55208
2016-09-12 17:14:35,212 INFO  datanode.DataNode (DataNode.java:startDataNode(1164)) - dnUserName = root
2016-09-12 17:14:35,212 INFO  datanode.DataNode (DataNode.java:startDataNode(1165)) - supergroup = supergroup
2016-09-12 17:14:35,238 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:35,239 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 44394
2016-09-12 17:14:35,251 INFO  datanode.DataNode (DataNode.java:initIpcServer(824)) - Opened IPC server at /127.0.0.1:44394
2016-09-12 17:14:35,272 INFO  datanode.DataNode (BlockPoolManager.java:refreshNamenodes(152)) - Refresh request received for nameservices: bnCluster
2016-09-12 17:14:35,279 INFO  datanode.DataNode (BlockPoolManager.java:doRefreshNamenodes(197)) - Starting BPOfferServices for nameservices: bnCluster
2016-09-12 17:14:35,298 INFO  datanode.DataNode (BPServiceActor.java:run(794)) - Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:40793 starting to offer service
2016-09-12 17:14:35,299 INFO  datanode.DataNode (BPServiceActor.java:run(794)) - Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:60949 starting to offer service
2016-09-12 17:14:35,310 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:35,310 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 44394: starting
2016-09-12 17:14:35,318 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:startDataNodes(1413)) - Starting DataNode 1 with dfs.datanode.data.dir: [DISK]file:/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3,[DISK]file:/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4
2016-09-12 17:14:35,336 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(159)) - DataNode metrics system started (again)
2016-09-12 17:14:35,337 INFO  datanode.BlockScanner (BlockScanner.java:<init>(172)) - Initialized block scanner with targetBytesPerSec 1048576
2016-09-12 17:14:35,337 INFO  datanode.DataNode (DataNode.java:<init>(434)) - Configured hostname is 127.0.0.1
2016-09-12 17:14:35,338 INFO  datanode.DataNode (DataNode.java:startDataNode(1147)) - Starting DataNode with maxLockedMemory = 0
2016-09-12 17:14:35,339 INFO  datanode.DataNode (DataXceiverServer.java:<init>(76)) - Balancing bandwith is 1048576 bytes/s
2016-09-12 17:14:35,339 INFO  datanode.DataNode (DataXceiverServer.java:<init>(77)) - Number threads for balancing is 5
2016-09-12 17:14:35,340 INFO  datanode.DataNode (DataNode.java:initDataXceiver(929)) - Opened streaming server at /127.0.0.1:39486
2016-09-12 17:14:35,345 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:35,346 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.datanode is not defined
2016-09-12 17:14:35,347 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:35,349 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context datanode
2016-09-12 17:14:35,350 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:35,350 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:35,354 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 37882
2016-09-12 17:14:35,354 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:35,387 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:37882
2016-09-12 17:14:35,399 INFO  web.DatanodeHttpServer (DatanodeHttpServer.java:start(186)) - Listening HTTP traffic on /127.0.0.1:35750
2016-09-12 17:14:35,407 INFO  datanode.DataNode (DataNode.java:startDataNode(1164)) - dnUserName = root
2016-09-12 17:14:35,408 INFO  datanode.DataNode (DataNode.java:startDataNode(1165)) - supergroup = supergroup
2016-09-12 17:14:35,408 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:35,414 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 49661
2016-09-12 17:14:35,417 INFO  datanode.DataNode (DataNode.java:initIpcServer(824)) - Opened IPC server at /127.0.0.1:49661
2016-09-12 17:14:35,432 INFO  datanode.DataNode (BlockPoolManager.java:refreshNamenodes(152)) - Refresh request received for nameservices: bnCluster
2016-09-12 17:14:35,433 INFO  datanode.DataNode (BlockPoolManager.java:doRefreshNamenodes(197)) - Starting BPOfferServices for nameservices: bnCluster
2016-09-12 17:14:35,435 INFO  datanode.DataNode (BPServiceActor.java:run(794)) - Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:40793 starting to offer service
2016-09-12 17:14:35,438 INFO  datanode.DataNode (BPServiceActor.java:run(794)) - Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:60949 starting to offer service
2016-09-12 17:14:35,439 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:35,445 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 49661: starting
2016-09-12 17:14:35,452 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:35,453 INFO  common.Storage (DataStorage.java:loadStorageDirectory(273)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1 is not formatted for BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:35,454 INFO  common.Storage (DataStorage.java:loadStorageDirectory(275)) - Formatting ...
2016-09-12 17:14:35,455 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:startDataNodes(1413)) - Starting DataNode 2 with dfs.datanode.data.dir: [DISK]file:/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5,[DISK]file:/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6
2016-09-12 17:14:35,488 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:35,489 INFO  common.Storage (DataStorage.java:loadStorageDirectory(273)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3 is not formatted for BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:35,489 INFO  common.Storage (DataStorage.java:loadStorageDirectory(275)) - Formatting ...
2016-09-12 17:14:35,492 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(159)) - DataNode metrics system started (again)
2016-09-12 17:14:35,492 INFO  datanode.BlockScanner (BlockScanner.java:<init>(172)) - Initialized block scanner with targetBytesPerSec 1048576
2016-09-12 17:14:35,493 INFO  datanode.DataNode (DataNode.java:<init>(434)) - Configured hostname is 127.0.0.1
2016-09-12 17:14:35,494 INFO  datanode.DataNode (DataNode.java:startDataNode(1147)) - Starting DataNode with maxLockedMemory = 0
2016-09-12 17:14:35,495 INFO  datanode.DataNode (DataXceiverServer.java:<init>(76)) - Balancing bandwith is 1048576 bytes/s
2016-09-12 17:14:35,495 INFO  datanode.DataNode (DataXceiverServer.java:<init>(77)) - Number threads for balancing is 5
2016-09-12 17:14:35,496 INFO  datanode.DataNode (DataNode.java:initDataXceiver(929)) - Opened streaming server at /127.0.0.1:57649
2016-09-12 17:14:35,501 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:35,502 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.datanode is not defined
2016-09-12 17:14:35,503 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:35,505 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context datanode
2016-09-12 17:14:35,505 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:35,505 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:35,508 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 48668
2016-09-12 17:14:35,509 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:35,532 INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(241)) - Analyzing storage directories for bpid BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:35,533 INFO  common.Storage (Storage.java:lock(675)) - Locking is disabled for /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current/BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:35,534 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:48668
2016-09-12 17:14:35,535 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(158)) - Block pool storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current/BP-1380221086-192.168.9.78-1473671668891 is not formatted for BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:35,535 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(160)) - Formatting ...
2016-09-12 17:14:35,535 INFO  common.Storage (BlockPoolSliceStorage.java:format(267)) - Formatting block pool BP-1380221086-192.168.9.78-1473671668891 directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current/BP-1380221086-192.168.9.78-1473671668891/current
2016-09-12 17:14:35,540 INFO  web.DatanodeHttpServer (DatanodeHttpServer.java:start(186)) - Listening HTTP traffic on /127.0.0.1:39959
2016-09-12 17:14:35,541 INFO  datanode.DataNode (DataNode.java:startDataNode(1164)) - dnUserName = root
2016-09-12 17:14:35,541 INFO  datanode.DataNode (DataNode.java:startDataNode(1165)) - supergroup = supergroup
2016-09-12 17:14:35,543 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:35,544 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 56487
2016-09-12 17:14:35,551 INFO  datanode.DataNode (DataNode.java:initIpcServer(824)) - Opened IPC server at /127.0.0.1:56487
2016-09-12 17:14:35,565 INFO  common.Storage (BlockPoolSliceStorage.java:doTransition(359)) - Restored 0 block files from trash.
2016-09-12 17:14:35,566 INFO  datanode.DataNode (BlockPoolManager.java:refreshNamenodes(152)) - Refresh request received for nameservices: bnCluster
2016-09-12 17:14:35,567 INFO  datanode.DataNode (BlockPoolManager.java:doRefreshNamenodes(197)) - Starting BPOfferServices for nameservices: bnCluster
2016-09-12 17:14:35,570 INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(241)) - Analyzing storage directories for bpid BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:35,570 INFO  common.Storage (Storage.java:lock(675)) - Locking is disabled for /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current/BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:35,571 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(158)) - Block pool storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current/BP-1380221086-192.168.9.78-1473671668891 is not formatted for BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:35,571 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(160)) - Formatting ...
2016-09-12 17:14:35,571 INFO  common.Storage (BlockPoolSliceStorage.java:format(267)) - Formatting block pool BP-1380221086-192.168.9.78-1473671668891 directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current/BP-1380221086-192.168.9.78-1473671668891/current
2016-09-12 17:14:35,571 INFO  datanode.DataNode (BPServiceActor.java:run(794)) - Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:40793 starting to offer service
2016-09-12 17:14:35,572 INFO  datanode.DataNode (BPServiceActor.java:run(794)) - Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:60949 starting to offer service
2016-09-12 17:14:35,573 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:35,582 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 56487: starting
2016-09-12 17:14:35,597 INFO  common.Storage (BlockPoolSliceStorage.java:doTransition(359)) - Restored 0 block files from trash.
2016-09-12 17:14:35,598 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:35,598 INFO  common.Storage (DataStorage.java:loadStorageDirectory(273)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2 is not formatted for BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:35,598 INFO  common.Storage (DataStorage.java:loadStorageDirectory(275)) - Formatting ...
2016-09-12 17:14:35,601 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2303)) - dnInfo.length != numDataNodes
2016-09-12 17:14:35,601 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2255)) - Waiting for cluster to become active
2016-09-12 17:14:35,649 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:35,649 INFO  common.Storage (DataStorage.java:loadStorageDirectory(273)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5 is not formatted for BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:35,650 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:35,650 INFO  common.Storage (DataStorage.java:loadStorageDirectory(275)) - Formatting ...
2016-09-12 17:14:35,651 INFO  common.Storage (DataStorage.java:loadStorageDirectory(273)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4 is not formatted for BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:35,651 INFO  common.Storage (DataStorage.java:loadStorageDirectory(275)) - Formatting ...
2016-09-12 17:14:35,681 INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(241)) - Analyzing storage directories for bpid BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:35,682 INFO  common.Storage (Storage.java:lock(675)) - Locking is disabled for /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current/BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:35,682 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(158)) - Block pool storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current/BP-1380221086-192.168.9.78-1473671668891 is not formatted for BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:35,683 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(160)) - Formatting ...
2016-09-12 17:14:35,683 INFO  common.Storage (BlockPoolSliceStorage.java:format(267)) - Formatting block pool BP-1380221086-192.168.9.78-1473671668891 directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current/BP-1380221086-192.168.9.78-1473671668891/current
2016-09-12 17:14:35,706 INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(241)) - Analyzing storage directories for bpid BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:35,707 INFO  common.Storage (Storage.java:lock(675)) - Locking is disabled for /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current/BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:35,707 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(158)) - Block pool storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current/BP-1380221086-192.168.9.78-1473671668891 is not formatted for BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:35,707 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2303)) - dnInfo.length != numDataNodes
2016-09-12 17:14:35,708 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2255)) - Waiting for cluster to become active
2016-09-12 17:14:35,708 INFO  common.Storage (BlockPoolSliceStorage.java:doTransition(359)) - Restored 0 block files from trash.
2016-09-12 17:14:35,710 INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(241)) - Analyzing storage directories for bpid BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:35,710 INFO  common.Storage (Storage.java:lock(675)) - Locking is disabled for /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current/BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:35,710 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(158)) - Block pool storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current/BP-1380221086-192.168.9.78-1473671668891 is not formatted for BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:35,711 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(160)) - Formatting ...
2016-09-12 17:14:35,711 INFO  common.Storage (BlockPoolSliceStorage.java:format(267)) - Formatting block pool BP-1380221086-192.168.9.78-1473671668891 directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current/BP-1380221086-192.168.9.78-1473671668891/current
2016-09-12 17:14:35,707 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(160)) - Formatting ...
2016-09-12 17:14:35,712 INFO  common.Storage (BlockPoolSliceStorage.java:format(267)) - Formatting block pool BP-1380221086-192.168.9.78-1473671668891 directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current/BP-1380221086-192.168.9.78-1473671668891/current
2016-09-12 17:14:35,716 INFO  datanode.DataNode (DataNode.java:initStorage(1411)) - Setting up storage: nsid=1058246572;bpid=BP-1380221086-192.168.9.78-1473671668891;lv=-56;nsInfo=lv=-63;cid=testClusterID;nsid=1058246572;c=0;bpid=BP-1380221086-192.168.9.78-1473671668891;dnuuid=null
2016-09-12 17:14:35,738 INFO  common.Storage (BlockPoolSliceStorage.java:doTransition(359)) - Restored 0 block files from trash.
2016-09-12 17:14:35,739 INFO  common.Storage (BlockPoolSliceStorage.java:doTransition(359)) - Restored 0 block files from trash.
2016-09-12 17:14:35,745 INFO  datanode.DataNode (DataNode.java:initStorage(1411)) - Setting up storage: nsid=1058246572;bpid=BP-1380221086-192.168.9.78-1473671668891;lv=-56;nsInfo=lv=-63;cid=testClusterID;nsid=1058246572;c=0;bpid=BP-1380221086-192.168.9.78-1473671668891;dnuuid=null
2016-09-12 17:14:35,766 INFO  datanode.DataNode (DataNode.java:checkDatanodeUuid(1240)) - Generated and persisted new Datanode UUID f98553a7-ea28-4269-9d05-be2fd64d4b23
2016-09-12 17:14:35,775 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:35,775 INFO  common.Storage (DataStorage.java:loadStorageDirectory(273)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6 is not formatted for BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:35,776 INFO  common.Storage (DataStorage.java:loadStorageDirectory(275)) - Formatting ...
2016-09-12 17:14:35,798 INFO  datanode.DataNode (DataNode.java:checkDatanodeUuid(1240)) - Generated and persisted new Datanode UUID fa93f85e-bb01-4346-b328-4240e783e581
2016-09-12 17:14:35,811 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2303)) - dnInfo.length != numDataNodes
2016-09-12 17:14:35,812 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2255)) - Waiting for cluster to become active
2016-09-12 17:14:35,817 INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(303)) - Added new volume: DS-e2ddd6e2-747c-4648-9b42-5d27018560d5
2016-09-12 17:14:35,817 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(380)) - Added volume - /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current, StorageType: DISK
2016-09-12 17:14:35,818 INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(303)) - Added new volume: DS-cf6c0412-4780-4b45-85c9-8f5f33ef5981
2016-09-12 17:14:36,276 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(380)) - Added volume - /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current, StorageType: DISK
2016-09-12 17:14:35,830 INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(303)) - Added new volume: DS-9d9c8e94-e9d3-47d2-b18f-9cfffdca27e0
2016-09-12 17:14:36,277 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(380)) - Added volume - /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current, StorageType: DISK
2016-09-12 17:14:36,278 INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(303)) - Added new volume: DS-0efe469b-e896-4ea3-a125-03402b1bd3fc
2016-09-12 17:14:36,278 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(380)) - Added volume - /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current, StorageType: DISK
2016-09-12 17:14:36,281 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2303)) - dnInfo.length != numDataNodes
2016-09-12 17:14:36,281 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2255)) - Waiting for cluster to become active
2016-09-12 17:14:36,287 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:registerMBean(2028)) - Registered FSDatasetState MBean
2016-09-12 17:14:36,287 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:registerMBean(2028)) - Registered FSDatasetState MBean
2016-09-12 17:14:36,288 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addBlockPool(2474)) - Adding block pool BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:36,288 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addBlockPool(2474)) - Adding block pool BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:36,290 INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(241)) - Analyzing storage directories for bpid BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:36,290 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(402)) - Scanning block pool BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current...
2016-09-12 17:14:36,290 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(402)) - Scanning block pool BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current...
2016-09-12 17:14:36,290 INFO  common.Storage (Storage.java:lock(675)) - Locking is disabled for /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current/BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:36,291 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(158)) - Block pool storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current/BP-1380221086-192.168.9.78-1473671668891 is not formatted for BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:36,291 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(160)) - Formatting ...
2016-09-12 17:14:36,291 INFO  common.Storage (BlockPoolSliceStorage.java:format(267)) - Formatting block pool BP-1380221086-192.168.9.78-1473671668891 directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current/BP-1380221086-192.168.9.78-1473671668891/current
2016-09-12 17:14:36,294 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(402)) - Scanning block pool BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current...
2016-09-12 17:14:36,294 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(402)) - Scanning block pool BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current...
2016-09-12 17:14:36,313 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(407)) - Time taken to scan block pool BP-1380221086-192.168.9.78-1473671668891 on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current: 19ms
2016-09-12 17:14:36,313 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(407)) - Time taken to scan block pool BP-1380221086-192.168.9.78-1473671668891 on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current: 22ms
2016-09-12 17:14:36,313 INFO  common.Storage (BlockPoolSliceStorage.java:doTransition(359)) - Restored 0 block files from trash.
2016-09-12 17:14:36,319 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(407)) - Time taken to scan block pool BP-1380221086-192.168.9.78-1473671668891 on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current: 25ms
2016-09-12 17:14:36,319 INFO  impl.FsDatasetImpl (FsVolumeList.java:addBlockPool(433)) - Total time to scan all replicas for block pool BP-1380221086-192.168.9.78-1473671668891: 30ms
2016-09-12 17:14:36,320 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(189)) - Adding replicas to map for block pool BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current...
2016-09-12 17:14:36,320 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(189)) - Adding replicas to map for block pool BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current...
2016-09-12 17:14:36,321 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(194)) - Time to add replicas to map for block pool BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current: 0ms
2016-09-12 17:14:36,321 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(194)) - Time to add replicas to map for block pool BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current: 1ms
2016-09-12 17:14:36,322 INFO  impl.FsDatasetImpl (FsVolumeList.java:getAllVolumesMap(220)) - Total time to add all replicas to map: 3ms
2016-09-12 17:14:36,325 INFO  datanode.DataNode (DataNode.java:initStorage(1411)) - Setting up storage: nsid=1058246572;bpid=BP-1380221086-192.168.9.78-1473671668891;lv=-56;nsInfo=lv=-63;cid=testClusterID;nsid=1058246572;c=0;bpid=BP-1380221086-192.168.9.78-1473671668891;dnuuid=null
2016-09-12 17:14:36,351 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(407)) - Time taken to scan block pool BP-1380221086-192.168.9.78-1473671668891 on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current: 61ms
2016-09-12 17:14:36,351 INFO  impl.FsDatasetImpl (FsVolumeList.java:addBlockPool(433)) - Total time to scan all replicas for block pool BP-1380221086-192.168.9.78-1473671668891: 63ms
2016-09-12 17:14:36,352 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(189)) - Adding replicas to map for block pool BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current...
2016-09-12 17:14:36,352 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(189)) - Adding replicas to map for block pool BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current...
2016-09-12 17:14:36,352 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(194)) - Time to add replicas to map for block pool BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current: 0ms
2016-09-12 17:14:36,353 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(194)) - Time to add replicas to map for block pool BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current: 1ms
2016-09-12 17:14:36,353 INFO  impl.FsDatasetImpl (FsVolumeList.java:getAllVolumesMap(220)) - Total time to add all replicas to map: 2ms
2016-09-12 17:14:36,384 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2303)) - dnInfo.length != numDataNodes
2016-09-12 17:14:36,384 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2255)) - Waiting for cluster to become active
2016-09-12 17:14:36,385 INFO  datanode.DataNode (DataNode.java:checkDatanodeUuid(1240)) - Generated and persisted new Datanode UUID e85fe368-860e-4014-b010-98bb5b9311b3
2016-09-12 17:14:36,388 INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(303)) - Added new volume: DS-455a7f94-f84b-4251-b6d6-6cc324793ed9
2016-09-12 17:14:36,388 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(380)) - Added volume - /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current, StorageType: DISK
2016-09-12 17:14:36,389 INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(303)) - Added new volume: DS-2b2d0606-22e5-41c9-b306-25b6bc87b260
2016-09-12 17:14:36,390 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(380)) - Added volume - /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current, StorageType: DISK
2016-09-12 17:14:36,391 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:registerMBean(2028)) - Registered FSDatasetState MBean
2016-09-12 17:14:36,392 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addBlockPool(2474)) - Adding block pool BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:36,393 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(402)) - Scanning block pool BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current...
2016-09-12 17:14:36,393 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(402)) - Scanning block pool BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current...
2016-09-12 17:14:36,401 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(407)) - Time taken to scan block pool BP-1380221086-192.168.9.78-1473671668891 on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current: 8ms
2016-09-12 17:14:36,401 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(407)) - Time taken to scan block pool BP-1380221086-192.168.9.78-1473671668891 on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current: 8ms
2016-09-12 17:14:36,402 INFO  impl.FsDatasetImpl (FsVolumeList.java:addBlockPool(433)) - Total time to scan all replicas for block pool BP-1380221086-192.168.9.78-1473671668891: 10ms
2016-09-12 17:14:36,403 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(189)) - Adding replicas to map for block pool BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current...
2016-09-12 17:14:36,403 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(189)) - Adding replicas to map for block pool BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current...
2016-09-12 17:14:36,404 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(194)) - Time to add replicas to map for block pool BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current: 1ms
2016-09-12 17:14:36,404 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(194)) - Time to add replicas to map for block pool BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current: 0ms
2016-09-12 17:14:36,404 INFO  impl.FsDatasetImpl (FsVolumeList.java:getAllVolumesMap(220)) - Total time to add all replicas to map: 1ms
2016-09-12 17:14:36,489 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2303)) - dnInfo.length != numDataNodes
2016-09-12 17:14:36,489 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2255)) - Waiting for cluster to become active
2016-09-12 17:14:36,592 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2303)) - dnInfo.length != numDataNodes
2016-09-12 17:14:36,593 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2255)) - Waiting for cluster to become active
2016-09-12 17:14:36,670 INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(378)) - Now scanning bpid BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4
2016-09-12 17:14:36,670 INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(378)) - Now scanning bpid BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2
2016-09-12 17:14:36,671 INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(378)) - Now scanning bpid BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3
2016-09-12 17:14:36,670 INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(378)) - Now scanning bpid BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1
2016-09-12 17:14:36,670 INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(378)) - Now scanning bpid BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6
2016-09-12 17:14:36,672 INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(378)) - Now scanning bpid BP-1380221086-192.168.9.78-1473671668891 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5
2016-09-12 17:14:36,673 INFO  datanode.VolumeScanner (VolumeScanner.java:runLoop(533)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3, DS-e2ddd6e2-747c-4648-9b42-5d27018560d5): finished scanning block pool BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:36,673 INFO  datanode.VolumeScanner (VolumeScanner.java:runLoop(533)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4, DS-cf6c0412-4780-4b45-85c9-8f5f33ef5981): finished scanning block pool BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:36,673 INFO  datanode.VolumeScanner (VolumeScanner.java:runLoop(533)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6, DS-2b2d0606-22e5-41c9-b306-25b6bc87b260): finished scanning block pool BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:36,674 INFO  datanode.VolumeScanner (VolumeScanner.java:runLoop(533)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1, DS-9d9c8e94-e9d3-47d2-b18f-9cfffdca27e0): finished scanning block pool BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:36,673 INFO  datanode.VolumeScanner (VolumeScanner.java:runLoop(533)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5, DS-455a7f94-f84b-4251-b6d6-6cc324793ed9): finished scanning block pool BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:36,673 INFO  datanode.VolumeScanner (VolumeScanner.java:runLoop(533)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2, DS-0efe469b-e896-4ea3-a125-03402b1bd3fc): finished scanning block pool BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:36,677 INFO  datanode.DirectoryScanner (DirectoryScanner.java:start(332)) - Periodic Directory Tree Verification scan starting at 1473678310677 with interval 21600000
2016-09-12 17:14:36,677 INFO  datanode.DirectoryScanner (DirectoryScanner.java:start(332)) - Periodic Directory Tree Verification scan starting at 1473680923677 with interval 21600000
2016-09-12 17:14:36,677 INFO  datanode.DirectoryScanner (DirectoryScanner.java:start(332)) - Periodic Directory Tree Verification scan starting at 1473689211677 with interval 21600000
2016-09-12 17:14:36,694 INFO  datanode.DataNode (BPServiceActor.java:register(749)) - Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid null) service to localhost/127.0.0.1:60949 beginning handshake with NN
2016-09-12 17:14:36,694 INFO  datanode.DataNode (BPServiceActor.java:register(749)) - Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid null) service to localhost/127.0.0.1:60949 beginning handshake with NN
2016-09-12 17:14:36,694 INFO  datanode.DataNode (BPServiceActor.java:register(749)) - Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid null) service to localhost/127.0.0.1:40793 beginning handshake with NN
2016-09-12 17:14:36,694 INFO  datanode.DataNode (BPServiceActor.java:register(749)) - Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid null) service to localhost/127.0.0.1:40793 beginning handshake with NN
2016-09-12 17:14:36,695 INFO  datanode.DataNode (BPServiceActor.java:register(749)) - Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid null) service to localhost/127.0.0.1:40793 beginning handshake with NN
2016-09-12 17:14:36,696 INFO  datanode.DataNode (BPServiceActor.java:register(749)) - Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid null) service to localhost/127.0.0.1:60949 beginning handshake with NN
2016-09-12 17:14:36,697 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2303)) - dnInfo.length != numDataNodes
2016-09-12 17:14:36,697 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2255)) - Waiting for cluster to become active
2016-09-12 17:14:36,710 INFO  hdfs.StateChange (DatanodeManager.java:registerDatanode(891)) - BLOCK* registerDatanode: from DatanodeRegistration(127.0.0.1:39486, datanodeUuid=fa93f85e-bb01-4346-b328-4240e783e581, infoPort=35750, infoSecurePort=0, ipcPort=49661, storageInfo=lv=-56;cid=testClusterID;nsid=1058246572;c=0) storage fa93f85e-bb01-4346-b328-4240e783e581
2016-09-12 17:14:36,711 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:36,711 INFO  hdfs.StateChange (DatanodeManager.java:registerDatanode(891)) - BLOCK* registerDatanode: from DatanodeRegistration(127.0.0.1:37818, datanodeUuid=f98553a7-ea28-4269-9d05-be2fd64d4b23, infoPort=55208, infoSecurePort=0, ipcPort=44394, storageInfo=lv=-56;cid=testClusterID;nsid=1058246572;c=0) storage f98553a7-ea28-4269-9d05-be2fd64d4b23
2016-09-12 17:14:36,712 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:36,713 INFO  net.NetworkTopology (NetworkTopology.java:add(419)) - Adding a new node: /default-rack/127.0.0.1:37818
2016-09-12 17:14:36,713 INFO  net.NetworkTopology (NetworkTopology.java:add(419)) - Adding a new node: /default-rack/127.0.0.1:39486
2016-09-12 17:14:36,716 INFO  hdfs.StateChange (DatanodeManager.java:registerDatanode(891)) - BLOCK* registerDatanode: from DatanodeRegistration(127.0.0.1:37818, datanodeUuid=f98553a7-ea28-4269-9d05-be2fd64d4b23, infoPort=55208, infoSecurePort=0, ipcPort=44394, storageInfo=lv=-56;cid=testClusterID;nsid=1058246572;c=0) storage f98553a7-ea28-4269-9d05-be2fd64d4b23
2016-09-12 17:14:36,716 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:36,720 INFO  hdfs.StateChange (DatanodeManager.java:registerDatanode(891)) - BLOCK* registerDatanode: from DatanodeRegistration(127.0.0.1:57649, datanodeUuid=e85fe368-860e-4014-b010-98bb5b9311b3, infoPort=39959, infoSecurePort=0, ipcPort=56487, storageInfo=lv=-56;cid=testClusterID;nsid=1058246572;c=0) storage e85fe368-860e-4014-b010-98bb5b9311b3
2016-09-12 17:14:36,721 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:36,721 INFO  net.NetworkTopology (NetworkTopology.java:add(419)) - Adding a new node: /default-rack/127.0.0.1:37818
2016-09-12 17:14:36,721 INFO  net.NetworkTopology (NetworkTopology.java:add(419)) - Adding a new node: /default-rack/127.0.0.1:57649
2016-09-12 17:14:36,722 INFO  hdfs.StateChange (DatanodeManager.java:registerDatanode(891)) - BLOCK* registerDatanode: from DatanodeRegistration(127.0.0.1:57649, datanodeUuid=e85fe368-860e-4014-b010-98bb5b9311b3, infoPort=39959, infoSecurePort=0, ipcPort=56487, storageInfo=lv=-56;cid=testClusterID;nsid=1058246572;c=0) storage e85fe368-860e-4014-b010-98bb5b9311b3
2016-09-12 17:14:36,724 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:36,725 INFO  datanode.DataNode (BPServiceActor.java:register(767)) - Block pool Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid null) service to localhost/127.0.0.1:60949 successfully registered with NN
2016-09-12 17:14:36,726 INFO  datanode.DataNode (BPServiceActor.java:offerService(625)) - For namenode localhost/127.0.0.1:60949 using DELETEREPORT_INTERVAL of 300000 msec  BLOCKREPORT_INTERVAL of 21600000msec CACHEREPORT_INTERVAL of 10000msec Initial delay: 0msec; heartBeatInterval=3000
2016-09-12 17:14:36,726 INFO  net.NetworkTopology (NetworkTopology.java:add(419)) - Adding a new node: /default-rack/127.0.0.1:57649
2016-09-12 17:14:36,722 INFO  hdfs.StateChange (DatanodeManager.java:registerDatanode(891)) - BLOCK* registerDatanode: from DatanodeRegistration(127.0.0.1:39486, datanodeUuid=fa93f85e-bb01-4346-b328-4240e783e581, infoPort=35750, infoSecurePort=0, ipcPort=49661, storageInfo=lv=-56;cid=testClusterID;nsid=1058246572;c=0) storage fa93f85e-bb01-4346-b328-4240e783e581
2016-09-12 17:14:36,724 INFO  datanode.DataNode (BPServiceActor.java:register(767)) - Block pool Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid null) service to localhost/127.0.0.1:40793 successfully registered with NN
2016-09-12 17:14:36,728 INFO  datanode.DataNode (BPServiceActor.java:offerService(625)) - For namenode localhost/127.0.0.1:40793 using DELETEREPORT_INTERVAL of 300000 msec  BLOCKREPORT_INTERVAL of 21600000msec CACHEREPORT_INTERVAL of 10000msec Initial delay: 0msec; heartBeatInterval=3000
2016-09-12 17:14:36,728 INFO  datanode.DataNode (BPServiceActor.java:register(767)) - Block pool Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid e85fe368-860e-4014-b010-98bb5b9311b3) service to localhost/127.0.0.1:40793 successfully registered with NN
2016-09-12 17:14:36,728 INFO  datanode.DataNode (BPServiceActor.java:offerService(625)) - For namenode localhost/127.0.0.1:40793 using DELETEREPORT_INTERVAL of 300000 msec  BLOCKREPORT_INTERVAL of 21600000msec CACHEREPORT_INTERVAL of 10000msec Initial delay: 0msec; heartBeatInterval=3000
2016-09-12 17:14:36,723 INFO  datanode.DataNode (BPServiceActor.java:register(767)) - Block pool Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid null) service to localhost/127.0.0.1:40793 successfully registered with NN
2016-09-12 17:14:36,729 INFO  datanode.DataNode (BPServiceActor.java:offerService(625)) - For namenode localhost/127.0.0.1:40793 using DELETEREPORT_INTERVAL of 300000 msec  BLOCKREPORT_INTERVAL of 21600000msec CACHEREPORT_INTERVAL of 10000msec Initial delay: 0msec; heartBeatInterval=3000
2016-09-12 17:14:36,723 INFO  datanode.DataNode (BPServiceActor.java:register(767)) - Block pool Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid null) service to localhost/127.0.0.1:60949 successfully registered with NN
2016-09-12 17:14:36,729 INFO  datanode.DataNode (BPServiceActor.java:offerService(625)) - For namenode localhost/127.0.0.1:60949 using DELETEREPORT_INTERVAL of 300000 msec  BLOCKREPORT_INTERVAL of 21600000msec CACHEREPORT_INTERVAL of 10000msec Initial delay: 0msec; heartBeatInterval=3000
2016-09-12 17:14:36,727 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:36,739 INFO  net.NetworkTopology (NetworkTopology.java:add(419)) - Adding a new node: /default-rack/127.0.0.1:39486
2016-09-12 17:14:36,742 INFO  datanode.DataNode (BPServiceActor.java:register(767)) - Block pool Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid fa93f85e-bb01-4346-b328-4240e783e581) service to localhost/127.0.0.1:60949 successfully registered with NN
2016-09-12 17:14:36,742 INFO  datanode.DataNode (BPServiceActor.java:offerService(625)) - For namenode localhost/127.0.0.1:60949 using DELETEREPORT_INTERVAL of 300000 msec  BLOCKREPORT_INTERVAL of 21600000msec CACHEREPORT_INTERVAL of 10000msec Initial delay: 0msec; heartBeatInterval=3000
2016-09-12 17:14:36,766 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:36,766 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:36,766 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-e2ddd6e2-747c-4648-9b42-5d27018560d5 for DN 127.0.0.1:39486
2016-09-12 17:14:36,766 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-9d9c8e94-e9d3-47d2-b18f-9cfffdca27e0 for DN 127.0.0.1:37818
2016-09-12 17:14:36,767 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-cf6c0412-4780-4b45-85c9-8f5f33ef5981 for DN 127.0.0.1:39486
2016-09-12 17:14:36,770 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:36,770 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-9d9c8e94-e9d3-47d2-b18f-9cfffdca27e0 for DN 127.0.0.1:37818
2016-09-12 17:14:36,771 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-0efe469b-e896-4ea3-a125-03402b1bd3fc for DN 127.0.0.1:37818
2016-09-12 17:14:36,771 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-0efe469b-e896-4ea3-a125-03402b1bd3fc for DN 127.0.0.1:37818
2016-09-12 17:14:36,771 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:36,772 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-e2ddd6e2-747c-4648-9b42-5d27018560d5 for DN 127.0.0.1:39486
2016-09-12 17:14:36,772 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-cf6c0412-4780-4b45-85c9-8f5f33ef5981 for DN 127.0.0.1:39486
2016-09-12 17:14:36,772 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:36,773 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-455a7f94-f84b-4251-b6d6-6cc324793ed9 for DN 127.0.0.1:57649
2016-09-12 17:14:36,773 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-2b2d0606-22e5-41c9-b306-25b6bc87b260 for DN 127.0.0.1:57649
2016-09-12 17:14:36,773 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:36,773 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-455a7f94-f84b-4251-b6d6-6cc324793ed9 for DN 127.0.0.1:57649
2016-09-12 17:14:36,774 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-2b2d0606-22e5-41c9-b306-25b6bc87b260 for DN 127.0.0.1:57649
2016-09-12 17:14:36,800 INFO  datanode.DataNode (BPOfferService.java:updateActorStatesFromHeartbeat(507)) - Namenode Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid f98553a7-ea28-4269-9d05-be2fd64d4b23) service to localhost/127.0.0.1:60949 trying to claim ACTIVE state with txid=3
2016-09-12 17:14:36,800 INFO  datanode.DataNode (BPOfferService.java:updateActorStatesFromHeartbeat(507)) - Namenode Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid e85fe368-860e-4014-b010-98bb5b9311b3) service to localhost/127.0.0.1:60949 trying to claim ACTIVE state with txid=3
2016-09-12 17:14:36,800 INFO  datanode.DataNode (BPOfferService.java:updateActorStatesFromHeartbeat(519)) - Acknowledging ACTIVE Namenode Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid e85fe368-860e-4014-b010-98bb5b9311b3) service to localhost/127.0.0.1:60949
2016-09-12 17:14:36,800 INFO  datanode.DataNode (BPOfferService.java:updateActorStatesFromHeartbeat(519)) - Acknowledging ACTIVE Namenode Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid f98553a7-ea28-4269-9d05-be2fd64d4b23) service to localhost/127.0.0.1:60949
2016-09-12 17:14:36,808 INFO  datanode.DataNode (BPOfferService.java:updateActorStatesFromHeartbeat(507)) - Namenode Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid fa93f85e-bb01-4346-b328-4240e783e581) service to localhost/127.0.0.1:60949 trying to claim ACTIVE state with txid=3
2016-09-12 17:14:36,808 INFO  datanode.DataNode (BPOfferService.java:updateActorStatesFromHeartbeat(519)) - Acknowledging ACTIVE Namenode Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid fa93f85e-bb01-4346-b328-4240e783e581) service to localhost/127.0.0.1:60949
2016-09-12 17:14:36,818 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2286)) - Cluster is active
2016-09-12 17:14:36,838 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-455a7f94-f84b-4251-b6d6-6cc324793ed9 node DatanodeRegistration(127.0.0.1:57649, datanodeUuid=e85fe368-860e-4014-b010-98bb5b9311b3, infoPort=39959, infoSecurePort=0, ipcPort=56487, storageInfo=lv=-56;cid=testClusterID;nsid=1058246572;c=0), blocks: 0, hasStaleStorage: true, processing time: 4 msecs
2016-09-12 17:14:36,839 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-2b2d0606-22e5-41c9-b306-25b6bc87b260 node DatanodeRegistration(127.0.0.1:57649, datanodeUuid=e85fe368-860e-4014-b010-98bb5b9311b3, infoPort=39959, infoSecurePort=0, ipcPort=56487, storageInfo=lv=-56;cid=testClusterID;nsid=1058246572;c=0), blocks: 0, hasStaleStorage: false, processing time: 0 msecs
2016-09-12 17:14:36,842 INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(395)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4, DS-cf6c0412-4780-4b45-85c9-8f5f33ef5981): no suitable block pools found to scan.  Waiting 1814399827 ms.
2016-09-12 17:14:36,843 INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(395)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2, DS-0efe469b-e896-4ea3-a125-03402b1bd3fc): no suitable block pools found to scan.  Waiting 1814399826 ms.
2016-09-12 17:14:36,843 INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(395)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6, DS-2b2d0606-22e5-41c9-b306-25b6bc87b260): no suitable block pools found to scan.  Waiting 1814399826 ms.
2016-09-12 17:14:36,844 INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(395)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5, DS-455a7f94-f84b-4251-b6d6-6cc324793ed9): no suitable block pools found to scan.  Waiting 1814399826 ms.
2016-09-12 17:14:36,845 INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(395)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1, DS-9d9c8e94-e9d3-47d2-b18f-9cfffdca27e0): no suitable block pools found to scan.  Waiting 1814399825 ms.
2016-09-12 17:14:36,847 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-455a7f94-f84b-4251-b6d6-6cc324793ed9 node DatanodeRegistration(127.0.0.1:57649, datanodeUuid=e85fe368-860e-4014-b010-98bb5b9311b3, infoPort=39959, infoSecurePort=0, ipcPort=56487, storageInfo=lv=-56;cid=testClusterID;nsid=1058246572;c=0), blocks: 0, hasStaleStorage: true, processing time: 6 msecs
2016-09-12 17:14:36,847 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-2b2d0606-22e5-41c9-b306-25b6bc87b260 node DatanodeRegistration(127.0.0.1:57649, datanodeUuid=e85fe368-860e-4014-b010-98bb5b9311b3, infoPort=39959, infoSecurePort=0, ipcPort=56487, storageInfo=lv=-56;cid=testClusterID;nsid=1058246572;c=0), blocks: 0, hasStaleStorage: false, processing time: 0 msecs
2016-09-12 17:14:36,850 INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(395)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3, DS-e2ddd6e2-747c-4648-9b42-5d27018560d5): no suitable block pools found to scan.  Waiting 1814399821 ms.
2016-09-12 17:14:36,854 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-e2ddd6e2-747c-4648-9b42-5d27018560d5 node DatanodeRegistration(127.0.0.1:39486, datanodeUuid=fa93f85e-bb01-4346-b328-4240e783e581, infoPort=35750, infoSecurePort=0, ipcPort=49661, storageInfo=lv=-56;cid=testClusterID;nsid=1058246572;c=0), blocks: 0, hasStaleStorage: true, processing time: 0 msecs
2016-09-12 17:14:36,856 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-9d9c8e94-e9d3-47d2-b18f-9cfffdca27e0 node DatanodeRegistration(127.0.0.1:37818, datanodeUuid=f98553a7-ea28-4269-9d05-be2fd64d4b23, infoPort=55208, infoSecurePort=0, ipcPort=44394, storageInfo=lv=-56;cid=testClusterID;nsid=1058246572;c=0), blocks: 0, hasStaleStorage: true, processing time: 2 msecs
2016-09-12 17:14:36,856 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-cf6c0412-4780-4b45-85c9-8f5f33ef5981 node DatanodeRegistration(127.0.0.1:39486, datanodeUuid=fa93f85e-bb01-4346-b328-4240e783e581, infoPort=35750, infoSecurePort=0, ipcPort=49661, storageInfo=lv=-56;cid=testClusterID;nsid=1058246572;c=0), blocks: 0, hasStaleStorage: false, processing time: 0 msecs
2016-09-12 17:14:36,856 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-0efe469b-e896-4ea3-a125-03402b1bd3fc node DatanodeRegistration(127.0.0.1:37818, datanodeUuid=f98553a7-ea28-4269-9d05-be2fd64d4b23, infoPort=55208, infoSecurePort=0, ipcPort=44394, storageInfo=lv=-56;cid=testClusterID;nsid=1058246572;c=0), blocks: 0, hasStaleStorage: false, processing time: 0 msecs
2016-09-12 17:14:36,857 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:36,858 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-9d9c8e94-e9d3-47d2-b18f-9cfffdca27e0 node DatanodeRegistration(127.0.0.1:37818, datanodeUuid=f98553a7-ea28-4269-9d05-be2fd64d4b23, infoPort=55208, infoSecurePort=0, ipcPort=44394, storageInfo=lv=-56;cid=testClusterID;nsid=1058246572;c=0), blocks: 0, hasStaleStorage: true, processing time: 1 msecs
2016-09-12 17:14:36,858 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-0efe469b-e896-4ea3-a125-03402b1bd3fc node DatanodeRegistration(127.0.0.1:37818, datanodeUuid=f98553a7-ea28-4269-9d05-be2fd64d4b23, infoPort=55208, infoSecurePort=0, ipcPort=44394, storageInfo=lv=-56;cid=testClusterID;nsid=1058246572;c=0), blocks: 0, hasStaleStorage: false, processing time: 0 msecs
2016-09-12 17:14:36,860 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-e2ddd6e2-747c-4648-9b42-5d27018560d5 node DatanodeRegistration(127.0.0.1:39486, datanodeUuid=fa93f85e-bb01-4346-b328-4240e783e581, infoPort=35750, infoSecurePort=0, ipcPort=49661, storageInfo=lv=-56;cid=testClusterID;nsid=1058246572;c=0), blocks: 0, hasStaleStorage: true, processing time: 1 msecs
2016-09-12 17:14:36,861 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-cf6c0412-4780-4b45-85c9-8f5f33ef5981 node DatanodeRegistration(127.0.0.1:39486, datanodeUuid=fa93f85e-bb01-4346-b328-4240e783e581, infoPort=35750, infoSecurePort=0, ipcPort=49661, storageInfo=lv=-56;cid=testClusterID;nsid=1058246572;c=0), blocks: 0, hasStaleStorage: false, processing time: 0 msecs
2016-09-12 17:14:36,881 INFO  datanode.DataNode (BPServiceActor.java:blockReport(492)) - Successfully sent block report 0x3745d7c9a5d03,  containing 2 storage report(s), of which we sent 2. The reports had 0 total blocks and used 1 RPC(s). This took 0 msec to generate and 79 msecs for RPC and NN processing. Got back no commands.
2016-09-12 17:14:36,881 INFO  datanode.DataNode (BPServiceActor.java:blockReport(492)) - Successfully sent block report 0x3745d7c47d22d,  containing 2 storage report(s), of which we sent 2. The reports had 0 total blocks and used 1 RPC(s). This took 5 msec to generate and 85 msecs for RPC and NN processing. Got back no commands.
2016-09-12 17:14:36,881 INFO  datanode.DataNode (BPServiceActor.java:blockReport(492)) - Successfully sent block report 0x3745d7c9e0b7c,  containing 2 storage report(s), of which we sent 2. The reports had 0 total blocks and used 1 RPC(s). This took 0 msec to generate and 79 msecs for RPC and NN processing. Got back no commands.
2016-09-12 17:14:36,888 INFO  datanode.DataNode (BPServiceActor.java:blockReport(492)) - Successfully sent block report 0x3745d7cbda475,  containing 2 storage report(s), of which we sent 2. The reports had 0 total blocks and used 1 RPC(s). This took 0 msec to generate and 84 msecs for RPC and NN processing. Got back one command: FinalizeCommand/5.
2016-09-12 17:14:36,888 INFO  datanode.DataNode (BPOfferService.java:processCommandFromActive(690)) - Got finalize command for block pool BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:36,890 INFO  datanode.DataNode (BPServiceActor.java:blockReport(492)) - Successfully sent block report 0x3745d7c9b9f51,  containing 2 storage report(s), of which we sent 2. The reports had 0 total blocks and used 1 RPC(s). This took 0 msec to generate and 88 msecs for RPC and NN processing. Got back one command: FinalizeCommand/5.
2016-09-12 17:14:36,890 INFO  datanode.DataNode (BPServiceActor.java:blockReport(492)) - Successfully sent block report 0x3745d7d0fa6a0,  containing 2 storage report(s), of which we sent 2. The reports had 0 total blocks and used 1 RPC(s). This took 1 msec to generate and 81 msecs for RPC and NN processing. Got back one command: FinalizeCommand/5.
2016-09-12 17:14:36,890 INFO  datanode.DataNode (BPOfferService.java:processCommandFromActive(690)) - Got finalize command for block pool BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:36,891 INFO  datanode.DataNode (BPOfferService.java:processCommandFromActive(690)) - Got finalize command for block pool BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:36,925 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 4; numTxns = 1
2016-09-12 17:14:36,938 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:000000009800000000000000040000000000000000000f2f66696c65546f526561642e64617400030000000000000000000001571dad43dd00000000080000000000000004726f6f740001a400000000000023444653436c69656e745f4e4f4e4d41505245445543455f313739303039383337385f3100093132372e302e302e3101000010d2d611c6a86c409fb5e1c603e3d137500000002aedc78818
2016-09-12 17:14:36,941 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
2016-09-12 17:14:36,943 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/fileToRead.dat	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:37,115 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1790098378_1 to complete inode 688133(/fileToRead.dat) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:37,118 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 5; numTxns = 1
2016-09-12 17:14:37,125 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:090000004700000000000000050000000000000000000f2f66696c65546f526561642e646174000100000000000000000000000000000000000000000000000100000000000001a43b993c95
2016-09-12 17:14:37,127 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_CLOSE=1
2016-09-12 17:14:37,129 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /fileToRead.dat is closed by DFSClient_NONMAPREDUCE_1790098378_1
2016-09-12 17:14:37,151 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/fileToRead.dat	dst=null	perm=null	proto=rpc
2016-09-12 17:14:37,201 WARN  hdfs.DFSClient (DFSInputStream.java:close(669)) - DFSInputStream has been closed already
2016-09-12 17:14:37,219 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/fileToRead.dat	dst=null	perm=null	proto=rpc
2016-09-12 17:14:37,230 WARN  hdfs.DFSClient (DFSInputStream.java:close(669)) - DFSInputStream has been closed already
2016-09-12 17:14:37,246 INFO  namenode.NameNode (NameNodeRpcServer.java:errorReport(501)) - Error report from NamenodeRegistration(localhost:40793, role=Backup Node): Shutting down.
2016-09-12 17:14:37,246 INFO  namenode.FSEditLog (FSEditLog.java:releaseBackupStream(1393)) - Removing backup journal BackupJournalManager
SEEEEEEEEEEEEEEEEEEEEETcheckpointManager null
2016-09-12 17:14:37,249 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:37,250 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5269)) - LazyPersistFileScrubber was interrupted, exiting
2016-09-12 17:14:37,250 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5196)) - NameNodeEditLogRoller was interrupted, exiting
2016-09-12 17:14:37,259 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 40793
2016-09-12 17:14:37,264 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 40793
2016-09-12 17:14:37,264 INFO  blockmanagement.BlockManager (BlockManager.java:run(3636)) - Stopping ReplicationMonitor.
2016-09-12 17:14:37,265 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:37,284 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:37,284 INFO  namenode.FSNamesystem (FSNamesystem.java:stopStandbyServices(1317)) - Stopping services started for standby state
2016-09-12 17:14:37,291 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:37,397 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdown(1712)) - Shutting down the Mini HDFS Cluster
2016-09-12 17:14:37,398 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdownDataNodes(1744)) - Shutting down DataNode 2
2016-09-12 17:14:37,399 WARN  datanode.DirectoryScanner (DirectoryScanner.java:shutdown(378)) - DirectoryScanner: shutdown has been called
2016-09-12 17:14:37,401 INFO  datanode.VolumeScanner (VolumeScanner.java:run(628)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6, DS-2b2d0606-22e5-41c9-b306-25b6bc87b260) exiting.
2016-09-12 17:14:37,402 INFO  datanode.VolumeScanner (VolumeScanner.java:run(628)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5, DS-455a7f94-f84b-4251-b6d6-6cc324793ed9) exiting.
2016-09-12 17:14:37,426 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:37,528 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 56487
2016-09-12 17:14:37,530 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 56487
2016-09-12 17:14:37,530 WARN  datanode.DataNode (BPServiceActor.java:offerService(704)) - BPOfferService for Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid e85fe368-860e-4014-b010-98bb5b9311b3) service to localhost/127.0.0.1:60949 interrupted
2016-09-12 17:14:37,531 WARN  datanode.DataNode (BPServiceActor.java:run(834)) - Ending block pool service for: Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid e85fe368-860e-4014-b010-98bb5b9311b3) service to localhost/127.0.0.1:60949
2016-09-12 17:14:37,531 WARN  datanode.DataNode (BPServiceActor.java:offerService(704)) - BPOfferService for Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid e85fe368-860e-4014-b010-98bb5b9311b3) service to localhost/127.0.0.1:40793 interrupted
2016-09-12 17:14:37,531 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:37,531 WARN  datanode.DataNode (BPServiceActor.java:run(834)) - Ending block pool service for: Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid e85fe368-860e-4014-b010-98bb5b9311b3) service to localhost/127.0.0.1:40793
2016-09-12 17:14:37,533 INFO  datanode.DataNode (BlockPoolManager.java:remove(103)) - Removed Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid e85fe368-860e-4014-b010-98bb5b9311b3)
2016-09-12 17:14:37,535 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:shutdownBlockPool(2484)) - Removing block pool BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:37,539 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:run(2955)) - LazyWriter was interrupted, exiting
2016-09-12 17:14:37,539 INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(184)) - Shutting down all async disk service threads
2016-09-12 17:14:37,540 INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(192)) - All async disk service threads have been shut down
2016-09-12 17:14:37,540 INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(162)) - Shutting down all async lazy persist service threads
2016-09-12 17:14:37,541 INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(169)) - All async lazy persist service threads have been shut down
2016-09-12 17:14:37,542 INFO  datanode.DataNode (DataNode.java:shutdown(1827)) - Shutdown complete.
2016-09-12 17:14:37,542 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdownDataNodes(1744)) - Shutting down DataNode 1
2016-09-12 17:14:37,543 WARN  datanode.DirectoryScanner (DirectoryScanner.java:shutdown(378)) - DirectoryScanner: shutdown has been called
2016-09-12 17:14:37,544 INFO  datanode.VolumeScanner (VolumeScanner.java:run(628)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4, DS-cf6c0412-4780-4b45-85c9-8f5f33ef5981) exiting.
2016-09-12 17:14:37,544 INFO  datanode.VolumeScanner (VolumeScanner.java:run(628)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3, DS-e2ddd6e2-747c-4648-9b42-5d27018560d5) exiting.
2016-09-12 17:14:37,557 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:37,658 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 49661
2016-09-12 17:14:37,660 WARN  datanode.DataNode (BPServiceActor.java:offerService(704)) - BPOfferService for Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid fa93f85e-bb01-4346-b328-4240e783e581) service to localhost/127.0.0.1:40793 interrupted
2016-09-12 17:14:37,660 WARN  datanode.DataNode (BPServiceActor.java:offerService(704)) - BPOfferService for Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid fa93f85e-bb01-4346-b328-4240e783e581) service to localhost/127.0.0.1:60949 interrupted
2016-09-12 17:14:37,661 WARN  datanode.DataNode (BPServiceActor.java:run(834)) - Ending block pool service for: Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid fa93f85e-bb01-4346-b328-4240e783e581) service to localhost/127.0.0.1:60949
2016-09-12 17:14:37,660 WARN  datanode.DataNode (BPServiceActor.java:run(834)) - Ending block pool service for: Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid fa93f85e-bb01-4346-b328-4240e783e581) service to localhost/127.0.0.1:40793
2016-09-12 17:14:37,660 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 49661
2016-09-12 17:14:37,660 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:37,662 INFO  datanode.DataNode (BlockPoolManager.java:remove(103)) - Removed Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid fa93f85e-bb01-4346-b328-4240e783e581)
2016-09-12 17:14:37,663 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:shutdownBlockPool(2484)) - Removing block pool BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:37,665 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:run(2955)) - LazyWriter was interrupted, exiting
2016-09-12 17:14:37,666 INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(184)) - Shutting down all async disk service threads
2016-09-12 17:14:37,666 INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(192)) - All async disk service threads have been shut down
2016-09-12 17:14:37,667 INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(162)) - Shutting down all async lazy persist service threads
2016-09-12 17:14:37,667 INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(169)) - All async lazy persist service threads have been shut down
2016-09-12 17:14:37,668 INFO  datanode.DataNode (DataNode.java:shutdown(1827)) - Shutdown complete.
2016-09-12 17:14:37,668 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdownDataNodes(1744)) - Shutting down DataNode 0
2016-09-12 17:14:37,668 WARN  datanode.DirectoryScanner (DirectoryScanner.java:shutdown(378)) - DirectoryScanner: shutdown has been called
2016-09-12 17:14:37,673 INFO  datanode.VolumeScanner (VolumeScanner.java:run(628)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1, DS-9d9c8e94-e9d3-47d2-b18f-9cfffdca27e0) exiting.
2016-09-12 17:14:37,673 INFO  datanode.VolumeScanner (VolumeScanner.java:run(628)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2, DS-0efe469b-e896-4ea3-a125-03402b1bd3fc) exiting.
2016-09-12 17:14:37,936 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:37,944 WARN  http.HttpServer2 (HttpServer2.java:isRunning(483)) - HttpServer Acceptor: isRunning is false. Rechecking.
2016-09-12 17:14:37,945 WARN  http.HttpServer2 (HttpServer2.java:isRunning(492)) - HttpServer Acceptor: isRunning is false
2016-09-12 17:14:38,047 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 44394
2016-09-12 17:14:38,048 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:38,048 WARN  datanode.DataNode (BPServiceActor.java:offerService(704)) - BPOfferService for Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid f98553a7-ea28-4269-9d05-be2fd64d4b23) service to localhost/127.0.0.1:60949 interrupted
2016-09-12 17:14:38,048 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 44394
2016-09-12 17:14:38,049 WARN  datanode.DataNode (BPServiceActor.java:run(834)) - Ending block pool service for: Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid f98553a7-ea28-4269-9d05-be2fd64d4b23) service to localhost/127.0.0.1:60949
2016-09-12 17:14:38,049 WARN  datanode.DataNode (BPServiceActor.java:offerService(704)) - BPOfferService for Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid f98553a7-ea28-4269-9d05-be2fd64d4b23) service to localhost/127.0.0.1:40793 interrupted
2016-09-12 17:14:38,051 WARN  datanode.DataNode (BPServiceActor.java:run(834)) - Ending block pool service for: Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid f98553a7-ea28-4269-9d05-be2fd64d4b23) service to localhost/127.0.0.1:40793
2016-09-12 17:14:38,051 INFO  datanode.DataNode (BlockPoolManager.java:remove(103)) - Removed Block pool BP-1380221086-192.168.9.78-1473671668891 (Datanode Uuid f98553a7-ea28-4269-9d05-be2fd64d4b23)
2016-09-12 17:14:38,052 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:shutdownBlockPool(2484)) - Removing block pool BP-1380221086-192.168.9.78-1473671668891
2016-09-12 17:14:38,055 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:run(2955)) - LazyWriter was interrupted, exiting
2016-09-12 17:14:38,055 INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(184)) - Shutting down all async disk service threads
2016-09-12 17:14:38,056 INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(192)) - All async disk service threads have been shut down
2016-09-12 17:14:38,056 INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(162)) - Shutting down all async lazy persist service threads
2016-09-12 17:14:38,057 INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(169)) - All async lazy persist service threads have been shut down
2016-09-12 17:14:38,057 INFO  datanode.DataNode (DataNode.java:shutdown(1827)) - Shutdown complete.
2016-09-12 17:14:38,058 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:38,058 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 3
2016-09-12 17:14:38,058 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5269)) - LazyPersistFileScrubber was interrupted, exiting
2016-09-12 17:14:38,059 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 4 Total time for transactions(ms): 28 Number of transactions batched in Syncs: 1 Number of syncs: 5 SyncTimes(ms): 2 4 
2016-09-12 17:14:38,060 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000003 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000003-0000000000000000006
2016-09-12 17:14:38,061 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5196)) - NameNodeEditLogRoller was interrupted, exiting
2016-09-12 17:14:38,062 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000003 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000003-0000000000000000006
2016-09-12 17:14:38,074 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 60949
2016-09-12 17:14:38,075 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 60949
2016-09-12 17:14:38,078 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:38,079 INFO  blockmanagement.BlockManager (BlockManager.java:run(3636)) - Stopping ReplicationMonitor.
2016-09-12 17:14:38,089 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:38,089 INFO  namenode.FSNamesystem (FSNamesystem.java:stopStandbyServices(1317)) - Stopping services started for standby state
2016-09-12 17:14:38,095 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:38,196 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(211)) - Stopping DataNode metrics system...
2016-09-12 17:14:38,199 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(217)) - DataNode metrics system stopped.
2016-09-12 17:14:38,200 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:shutdown(606)) - DataNode metrics system shutdown complete.
2016-09-12 17:14:38,242 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:<init>(446)) - starting cluster: numNameNodes=1, numDataNodes=0
Formatting using clusterid: testClusterID
2016-09-12 17:14:38,246 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(727)) - No KeyProvider found.
2016-09-12 17:14:38,246 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(737)) - fsLock is fair:true
2016-09-12 17:14:38,248 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(242)) - dfs.block.invalidate.limit=1000
2016-09-12 17:14:38,249 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(248)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2016-09-12 17:14:38,250 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(71)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2016-09-12 17:14:38,250 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(76)) - The block deletion will start around 2016 九月 12 17:14:38
2016-09-12 17:14:38,251 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map BlocksMap
2016-09-12 17:14:38,251 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:38,252 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 2.0% max memory 3.6 GB = 72.8 MB
2016-09-12 17:14:38,252 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^23 = 8388608 entries
2016-09-12 17:14:38,261 INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(365)) - dfs.block.access.token.enable=false
2016-09-12 17:14:38,262 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(350)) - defaultReplication         = 0
2016-09-12 17:14:38,262 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(351)) - maxReplication             = 512
2016-09-12 17:14:38,262 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(352)) - minReplication             = 1
2016-09-12 17:14:38,262 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(353)) - maxReplicationStreams      = 2
2016-09-12 17:14:38,263 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(354)) - shouldCheckForEnoughRacks  = false
2016-09-12 17:14:38,263 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(355)) - replicationRecheckInterval = 3000
2016-09-12 17:14:38,263 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(356)) - encryptDataTransfer        = false
2016-09-12 17:14:38,263 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(357)) - maxNumBlocksToLog          = 1000
2016-09-12 17:14:38,264 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(757)) - fsOwner             = root (auth:SIMPLE)
2016-09-12 17:14:38,264 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(758)) - supergroup          = supergroup
2016-09-12 17:14:38,264 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(759)) - isPermissionEnabled = true
2016-09-12 17:14:38,265 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(770)) - HA Enabled: false
2016-09-12 17:14:38,266 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(809)) - Append Enabled: true
2016-09-12 17:14:38,266 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map INodeMap
2016-09-12 17:14:38,267 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:38,267 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 1.0% max memory 3.6 GB = 36.4 MB
2016-09-12 17:14:38,267 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^22 = 4194304 entries
2016-09-12 17:14:38,369 INFO  namenode.FSDirectory (FSDirectory.java:<init>(235)) - ACLs enabled? false
2016-09-12 17:14:38,370 INFO  namenode.FSDirectory (FSDirectory.java:<init>(239)) - XAttrs enabled? true
2016-09-12 17:14:38,370 INFO  namenode.FSDirectory (FSDirectory.java:<init>(247)) - Maximum size of an xattr: 16384
2016-09-12 17:14:38,370 INFO  namenode.NameNode (FSDirectory.java:<init>(295)) - Caching file names occuring more than 10 times
2016-09-12 17:14:38,371 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map cachedBlocks
2016-09-12 17:14:38,371 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:38,371 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.25% max memory 3.6 GB = 9.1 MB
2016-09-12 17:14:38,372 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^20 = 1048576 entries
2016-09-12 17:14:38,373 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5664)) - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2016-09-12 17:14:38,373 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5665)) - dfs.namenode.safemode.min.datanodes = 0
2016-09-12 17:14:38,374 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5666)) - dfs.namenode.safemode.extension     = 0
2016-09-12 17:14:38,374 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:38,375 INFO  metrics.TopMetrics (TopMetrics.java:logConf(65)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2016-09-12 17:14:38,375 INFO  metrics.TopMetrics (TopMetrics.java:logConf(67)) - NNTop conf: dfs.namenode.top.num.users = 10
2016-09-12 17:14:38,375 INFO  metrics.TopMetrics (TopMetrics.java:logConf(69)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2016-09-12 17:14:38,376 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(920)) - Retry cache on namenode is enabled
2016-09-12 17:14:38,376 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(928)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2016-09-12 17:14:38,376 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map NameNodeRetryCache
2016-09-12 17:14:38,376 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:38,377 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.029999999329447746% max memory 3.6 GB = 1.1 MB
2016-09-12 17:14:38,377 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^17 = 131072 entries
2016-09-12 17:14:38,380 INFO  namenode.FSImage (FSImage.java:format(168)) - Allocated new BlockPoolId: BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:38,456 INFO  common.Storage (NNStorage.java:format(552)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1 has been successfully formatted.
2016-09-12 17:14:38,492 INFO  common.Storage (NNStorage.java:format(552)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2 has been successfully formatted.
2016-09-12 17:14:38,545 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage.ckpt_0000000000000000000 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000
2016-09-12 17:14:38,546 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage.ckpt_0000000000000000000 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000000
2016-09-12 17:14:38,547 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 1 images with txid >= 0
2016-09-12 17:14:38,549 INFO  namenode.NameNode (NameNode.java:createNameNode(1419)) - createNameNode []
2016-09-12 17:14:38,551 WARN  impl.MetricsConfig (MetricsConfig.java:loadFirst(125)) - Cannot locate configuration: tried hadoop-metrics2-namenode.properties,hadoop-metrics2.properties
2016-09-12 17:14:38,554 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:startTimer(377)) - Scheduled snapshot period at 10 second(s).
2016-09-12 17:14:38,554 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:start(192)) - NameNode metrics system started
2016-09-12 17:14:38,555 INFO  namenode.NameNode (NameNode.java:setClientNamenodeAddress(399)) - fs.defaultFS is hdfs://127.0.0.1:0
2016-09-12 17:14:38,569 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1703)) - Starting Web-server for hdfs at: http://localhost:0
2016-09-12 17:14:38,572 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:38,572 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.namenode is not defined
2016-09-12 17:14:38,574 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:38,575 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hdfs
2016-09-12 17:14:38,576 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:38,576 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:38,578 INFO  http.HttpServer2 (NameNodeHttpServer.java:initWebHdfs(86)) - Added filter 'org.apache.hadoop.hdfs.web.AuthFilter' (class=org.apache.hadoop.hdfs.web.AuthFilter)
2016-09-12 17:14:38,579 INFO  http.HttpServer2 (HttpServer2.java:addJerseyResourcePackage(609)) - addJerseyResourcePackage: packageName=org.apache.hadoop.hdfs.server.namenode.web.resources;org.apache.hadoop.hdfs.web.resources, pathSpec=/webhdfs/v1/*
2016-09-12 17:14:38,583 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 58060
2016-09-12 17:14:38,584 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:38,604 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:58060
2016-09-12 17:14:38,606 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(727)) - No KeyProvider found.
2016-09-12 17:14:38,606 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(737)) - fsLock is fair:true
2016-09-12 17:14:38,608 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(242)) - dfs.block.invalidate.limit=1000
2016-09-12 17:14:38,608 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(248)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2016-09-12 17:14:38,609 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(71)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2016-09-12 17:14:38,610 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(76)) - The block deletion will start around 2016 九月 12 17:14:38
2016-09-12 17:14:38,610 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map BlocksMap
2016-09-12 17:14:38,610 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:38,611 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 2.0% max memory 3.6 GB = 72.8 MB
2016-09-12 17:14:38,611 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^23 = 8388608 entries
2016-09-12 17:14:38,619 INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(365)) - dfs.block.access.token.enable=false
2016-09-12 17:14:38,620 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(350)) - defaultReplication         = 0
2016-09-12 17:14:38,620 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(351)) - maxReplication             = 512
2016-09-12 17:14:38,621 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(352)) - minReplication             = 1
2016-09-12 17:14:38,621 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(353)) - maxReplicationStreams      = 2
2016-09-12 17:14:38,621 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(354)) - shouldCheckForEnoughRacks  = false
2016-09-12 17:14:38,621 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(355)) - replicationRecheckInterval = 3000
2016-09-12 17:14:38,622 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(356)) - encryptDataTransfer        = false
2016-09-12 17:14:38,622 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(357)) - maxNumBlocksToLog          = 1000
2016-09-12 17:14:38,622 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(757)) - fsOwner             = root (auth:SIMPLE)
2016-09-12 17:14:38,623 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(758)) - supergroup          = supergroup
2016-09-12 17:14:38,623 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(759)) - isPermissionEnabled = true
2016-09-12 17:14:38,623 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(770)) - HA Enabled: false
2016-09-12 17:14:38,625 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(809)) - Append Enabled: true
2016-09-12 17:14:38,625 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map INodeMap
2016-09-12 17:14:38,626 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:38,627 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 1.0% max memory 3.6 GB = 36.4 MB
2016-09-12 17:14:38,627 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^22 = 4194304 entries
2016-09-12 17:14:38,631 INFO  namenode.FSDirectory (FSDirectory.java:<init>(235)) - ACLs enabled? false
2016-09-12 17:14:38,632 INFO  namenode.FSDirectory (FSDirectory.java:<init>(239)) - XAttrs enabled? true
2016-09-12 17:14:38,632 INFO  namenode.FSDirectory (FSDirectory.java:<init>(247)) - Maximum size of an xattr: 16384
2016-09-12 17:14:38,633 INFO  namenode.NameNode (FSDirectory.java:<init>(295)) - Caching file names occuring more than 10 times
2016-09-12 17:14:38,633 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map cachedBlocks
2016-09-12 17:14:38,633 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:38,634 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.25% max memory 3.6 GB = 9.1 MB
2016-09-12 17:14:38,634 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^20 = 1048576 entries
2016-09-12 17:14:38,636 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5664)) - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2016-09-12 17:14:38,636 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5665)) - dfs.namenode.safemode.min.datanodes = 0
2016-09-12 17:14:38,636 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5666)) - dfs.namenode.safemode.extension     = 0
2016-09-12 17:14:38,636 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:38,637 INFO  metrics.TopMetrics (TopMetrics.java:logConf(65)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2016-09-12 17:14:38,637 INFO  metrics.TopMetrics (TopMetrics.java:logConf(67)) - NNTop conf: dfs.namenode.top.num.users = 10
2016-09-12 17:14:38,638 INFO  metrics.TopMetrics (TopMetrics.java:logConf(69)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2016-09-12 17:14:38,638 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(920)) - Retry cache on namenode is enabled
2016-09-12 17:14:38,638 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(928)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2016-09-12 17:14:38,639 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map NameNodeRetryCache
2016-09-12 17:14:38,639 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:38,639 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.029999999329447746% max memory 3.6 GB = 1.1 MB
2016-09-12 17:14:38,640 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^17 = 131072 entries
2016-09-12 17:14:38,660 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:38,680 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:38,680 TRACE namenode.FSImage (FSImage.java:recoverTransitionRead(228)) - Data dir states:
  Storage Directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1: NORMAL
  Storage Directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2: NORMAL
2016-09-12 17:14:38,683 INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(362)) - Recovering unfinalized segments in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current
2016-09-12 17:14:38,684 INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(362)) - Recovering unfinalized segments in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current
2016-09-12 17:14:38,685 INFO  namenode.FSImage (FSImage.java:loadFSImage(679)) - No edit log streams selected.
2016-09-12 17:14:38,685 DEBUG namenode.FSImage (FSImage.java:loadFSImageFile(740)) - Planning to load image :
FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000, cpktTxId=0000000000000000000)
2016-09-12 17:14:38,687 INFO  namenode.FSImageFormatPBINode (FSImageFormatPBINode.java:loadINodeSection(259)) - Loading 1 INodes.
2016-09-12 17:14:38,688 INFO  namenode.FSImageFormatProtobuf (FSImageFormatProtobuf.java:load(181)) - Loaded FSImage in 0 seconds.
2016-09-12 17:14:38,688 INFO  namenode.FSImage (FSImage.java:loadFSImage(982)) - Loaded image for txid 0 from /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000
2016-09-12 17:14:38,689 DEBUG namenode.FSImage (FSImage.java:loadEdits(834)) - About to load edits:
  
2016-09-12 17:14:38,689 INFO  namenode.FSNamesystem (FSNamesystem.java:loadFSImage(997)) - Need to save fs image? false (staleImage=false, haEnabled=false, isRollingUpgrade=false)
2016-09-12 17:14:38,690 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 1
2016-09-12 17:14:38,760 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2016-09-12 17:14:38,761 INFO  namenode.FSNamesystem (FSNamesystem.java:loadFromDisk(699)) - Finished loading FSImage in 119 msecs
2016-09-12 17:14:38,762 INFO  namenode.NameNode (NameNodeRpcServer.java:<init>(342)) - RPC server is binding to localhost:0
2016-09-12 17:14:38,762 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:38,763 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 60354
2016-09-12 17:14:38,770 INFO  namenode.NameNode (NameNode.java:initialize(654)) - Clients are to use localhost:60354 to access this namenode/service.
2016-09-12 17:14:38,771 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(6536)) - Registered FSNamesystemState MBean
2016-09-12 17:14:38,789 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:38,790 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:38,790 INFO  namenode.FSNamesystem (FSNamesystem.java:initializeReplQueues(1202)) - initializing replication queues
2016-09-12 17:14:38,791 INFO  hdfs.StateChange (FSNamesystem.java:leave(5739)) - STATE* Leaving safe mode after 0 secs
2016-09-12 17:14:38,791 INFO  hdfs.StateChange (FSNamesystem.java:leave(5751)) - STATE* Network topology has 0 racks and 0 datanodes
2016-09-12 17:14:38,791 INFO  hdfs.StateChange (FSNamesystem.java:leave(5754)) - STATE* UnderReplicatedBlocks has 0 blocks
2016-09-12 17:14:38,792 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:38,804 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2766)) - Total number of blocks            = 0
2016-09-12 17:14:38,804 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2767)) - Number of invalid blocks          = 0
2016-09-12 17:14:38,804 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2768)) - Number of under-replicated blocks = 0
2016-09-12 17:14:38,804 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2769)) - Number of  over-replicated blocks = 0
2016-09-12 17:14:38,805 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2771)) - Number of blocks being written    = 0
2016-09-12 17:14:38,805 INFO  hdfs.StateChange (BlockManager.java:processMisReplicatesAsync(2772)) - STATE* Replication Queue initialization scan for invalid, over- and under-replicated blocks completed in 14 msec
2016-09-12 17:14:38,830 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:38,830 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 60354: starting
2016-09-12 17:14:38,835 INFO  namenode.NameNode (NameNode.java:startCommonServices(697)) - NameNode RPC up at: localhost/127.0.0.1:60354
2016-09-12 17:14:38,835 INFO  namenode.FSNamesystem (FSNamesystem.java:startActiveServices(1123)) - Starting services required for active state
2016-09-12 17:14:38,837 INFO  blockmanagement.CacheReplicationMonitor (CacheReplicationMonitor.java:run(160)) - Starting CacheReplicationMonitor with interval 30000 milliseconds
2016-09-12 17:14:38,847 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2286)) - Cluster is active
2016-09-12 17:14:38,858 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/checkpoint.dat	dst=null	perm=null	proto=rpc
2016-09-12 17:14:38,861 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/checkpoint2.dat	dst=null	perm=null	proto=rpc
2016-09-12 17:14:38,865 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/checkpoint.dat	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:38,867 INFO  namenode.NameNode (NameNode.java:createNameNode(1419)) - createNameNode [-backup]
2016-09-12 17:14:38,867 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(159)) - BackupNode metrics system started (again)
2016-09-12 17:14:38,867 INFO  namenode.NameNode (NameNode.java:setClientNamenodeAddress(399)) - fs.defaultFS is hdfs://localhost:60354
2016-09-12 17:14:38,868 INFO  namenode.NameNode (NameNode.java:setClientNamenodeAddress(419)) - Clients are to use localhost:60354 to access this namenode/service.
2016-09-12 17:14:38,888 WARN  common.Util (Util.java:stringAsURI(56)) - Path /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/ should be specified as a URI in configuration files. Please update hdfs configuration.
2016-09-12 17:14:38,889 WARN  common.Util (Util.java:stringAsURI(56)) - Path /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/ should be specified as a URI in configuration files. Please update hdfs configuration.
2016-09-12 17:14:38,889 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(727)) - No KeyProvider found.
2016-09-12 17:14:38,890 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(737)) - fsLock is fair:true
2016-09-12 17:14:38,891 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(242)) - dfs.block.invalidate.limit=1000
2016-09-12 17:14:38,892 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(248)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2016-09-12 17:14:38,892 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(71)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2016-09-12 17:14:38,893 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(76)) - The block deletion will start around 2016 九月 12 17:14:38
2016-09-12 17:14:38,893 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map BlocksMap
2016-09-12 17:14:38,894 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:38,894 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 2.0% max memory 3.6 GB = 72.8 MB
2016-09-12 17:14:38,894 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^23 = 8388608 entries
2016-09-12 17:14:38,903 INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(365)) - dfs.block.access.token.enable=false
2016-09-12 17:14:38,903 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(350)) - defaultReplication         = 0
2016-09-12 17:14:38,904 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(351)) - maxReplication             = 512
2016-09-12 17:14:38,904 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(352)) - minReplication             = 1
2016-09-12 17:14:38,904 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(353)) - maxReplicationStreams      = 2
2016-09-12 17:14:38,905 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(354)) - shouldCheckForEnoughRacks  = false
2016-09-12 17:14:38,905 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(355)) - replicationRecheckInterval = 3000
2016-09-12 17:14:38,905 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(356)) - encryptDataTransfer        = false
2016-09-12 17:14:38,905 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(357)) - maxNumBlocksToLog          = 1000
2016-09-12 17:14:38,906 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(757)) - fsOwner             = root (auth:SIMPLE)
2016-09-12 17:14:38,906 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(758)) - supergroup          = supergroup
2016-09-12 17:14:38,906 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(759)) - isPermissionEnabled = true
2016-09-12 17:14:38,907 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(770)) - HA Enabled: false
2016-09-12 17:14:38,907 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(809)) - Append Enabled: true
2016-09-12 17:14:38,908 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map INodeMap
2016-09-12 17:14:38,908 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:38,909 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 1.0% max memory 3.6 GB = 36.4 MB
2016-09-12 17:14:38,909 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^22 = 4194304 entries
2016-09-12 17:14:38,914 INFO  namenode.FSDirectory (FSDirectory.java:<init>(235)) - ACLs enabled? false
2016-09-12 17:14:38,914 INFO  namenode.FSDirectory (FSDirectory.java:<init>(239)) - XAttrs enabled? true
2016-09-12 17:14:38,914 INFO  namenode.FSDirectory (FSDirectory.java:<init>(247)) - Maximum size of an xattr: 16384
2016-09-12 17:14:38,915 INFO  namenode.NameNode (FSDirectory.java:<init>(295)) - Caching file names occuring more than 10 times
2016-09-12 17:14:38,915 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map cachedBlocks
2016-09-12 17:14:38,915 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:38,916 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.25% max memory 3.6 GB = 9.1 MB
2016-09-12 17:14:38,916 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^20 = 1048576 entries
2016-09-12 17:14:38,918 WARN  namenode.FSNamesystem (FSNamesystem.java:<init>(5655)) - The threshold value should't be greater than 1, threshold: 1.5
2016-09-12 17:14:38,918 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5664)) - dfs.namenode.safemode.threshold-pct = 1.5
2016-09-12 17:14:38,918 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5665)) - dfs.namenode.safemode.min.datanodes = 0
2016-09-12 17:14:38,918 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5666)) - dfs.namenode.safemode.extension     = 2147483647
2016-09-12 17:14:38,919 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:38,919 INFO  metrics.TopMetrics (TopMetrics.java:logConf(65)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2016-09-12 17:14:38,920 INFO  metrics.TopMetrics (TopMetrics.java:logConf(67)) - NNTop conf: dfs.namenode.top.num.users = 10
2016-09-12 17:14:38,920 INFO  metrics.TopMetrics (TopMetrics.java:logConf(69)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2016-09-12 17:14:38,920 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(920)) - Retry cache on namenode is enabled
2016-09-12 17:14:38,921 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(928)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2016-09-12 17:14:38,921 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map NameNodeRetryCache
2016-09-12 17:14:38,921 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:38,922 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.029999999329447746% max memory 3.6 GB = 1.1 MB
2016-09-12 17:14:38,922 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^17 = 131072 entries
2016-09-12 17:14:38,940 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:38,940 INFO  namenode.FSImage (BackupImage.java:recoverCreateRead(130)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1 is not formatted.
2016-09-12 17:14:38,941 INFO  namenode.FSImage (BackupImage.java:recoverCreateRead(131)) - Formatting ...
2016-09-12 17:14:38,941 INFO  namenode.NameNode (NameNodeRpcServer.java:<init>(342)) - RPC server is binding to localhost:0
2016-09-12 17:14:38,942 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:38,943 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 43385
2016-09-12 17:14:38,950 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(6536)) - Registered FSNamesystemState MBean
2016-09-12 17:14:38,951 WARN  common.Util (Util.java:stringAsURI(56)) - Path /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/ should be specified as a URI in configuration files. Please update hdfs configuration.
2016-09-12 17:14:38,961 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:38,961 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:38,962 INFO  hdfs.StateChange (FSNamesystem.java:leave(5739)) - STATE* Leaving safe mode after 0 secs
2016-09-12 17:14:38,962 INFO  hdfs.StateChange (FSNamesystem.java:leave(5751)) - STATE* Network topology has 0 racks and 0 datanodes
2016-09-12 17:14:38,963 INFO  hdfs.StateChange (FSNamesystem.java:leave(5754)) - STATE* UnderReplicatedBlocks has 0 blocks
2016-09-12 17:14:38,963 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:38,993 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1703)) - Starting Web-server for hdfs at: http://localhost:0
2016-09-12 17:14:38,996 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:38,997 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.namenode is not defined
2016-09-12 17:14:38,999 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:39,000 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hdfs
2016-09-12 17:14:39,001 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:39,001 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:39,004 INFO  http.HttpServer2 (NameNodeHttpServer.java:initWebHdfs(86)) - Added filter 'org.apache.hadoop.hdfs.web.AuthFilter' (class=org.apache.hadoop.hdfs.web.AuthFilter)
2016-09-12 17:14:39,004 INFO  http.HttpServer2 (HttpServer2.java:addJerseyResourcePackage(609)) - addJerseyResourcePackage: packageName=org.apache.hadoop.hdfs.server.namenode.web.resources;org.apache.hadoop.hdfs.web.resources, pathSpec=/webhdfs/v1/*
2016-09-12 17:14:39,009 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 56086
2016-09-12 17:14:39,009 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:39,031 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:56086
2016-09-12 17:14:39,033 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:39,033 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 43385: starting
2016-09-12 17:14:39,041 INFO  namenode.NameNode (NameNode.java:startCommonServices(697)) - Backup Node RPC up at: localhost/127.0.0.1:43385
2016-09-12 17:14:39,042 INFO  hdfs.StateChange (FSNamesystem.java:reportStatus(6007)) - STATE* Safe mode is ON. 
It was turned on manually. Use "hdfs dfsadmin -safemode leave" to turn safe mode off.
2016-09-12 17:14:39,043 INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(362)) - Recovering unfinalized segments in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current
2016-09-12 17:14:39,046 INFO  namenode.FSEditLog (FSEditLog.java:registerBackupNode(1382)) - Registering new backup node: NamenodeRegistration(localhost:43385, role=Backup Node)
2016-09-12 17:14:39,047 INFO  namenode.Checkpointer (Checkpointer.java:initialize(108)) - Checkpoint Period : 3600 secs (60 min)
2016-09-12 17:14:39,048 INFO  namenode.Checkpointer (Checkpointer.java:initialize(111)) - Transactions count is  : 1, to trigger checkpoint
2016-09-12 17:14:39,048 INFO  namenode.FSNamesystem (FSNamesystem.java:startActiveServices(1123)) - Starting services required for active state
2016-09-12 17:14:39,051 ERROR namenode.FSNamesystem (FSNamesystem.java:run(5190)) - Swallowing exception in NameNodeEditLogRoller:
java.lang.IllegalStateException: Bad state: BETWEEN_LOG_SEGMENTS
	at com.google.common.base.Preconditions.checkState(Preconditions.java:172)
	at org.apache.hadoop.hdfs.server.namenode.FSEditLog.getCurSegmentTxId(FSEditLog.java:515)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem$NameNodeEditLogRoller.run(FSNamesystem.java:5181)
	at java.lang.Thread.run(Thread.java:745)
2016-09-12 17:14:39,051 INFO  namenode.TestBackupNode (TestBackupNode.java:waitCheckpointDone(115)) - Waiting checkpoint to complete... checkpoint txid should increase above 1
2016-09-12 17:14:39,052 INFO  namenode.FSNamesystem (FSNamesystem.java:startCheckpoint(6347)) - Start checkpoint for localhost:43385
2016-09-12 17:14:39,053 INFO  namenode.FSImage (FSImage.java:startCheckpoint(1333)) - Start checkpoint at txid 1
2016-09-12 17:14:39,053 INFO  blockmanagement.CacheReplicationMonitor (CacheReplicationMonitor.java:run(160)) - Starting CacheReplicationMonitor with interval 30000 milliseconds
2016-09-12 17:14:39,053 INFO  namenode.FSEditLog (FSEditLog.java:rollEditLog(1202)) - Rolling edit logs
2016-09-12 17:14:39,054 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 1
2016-09-12 17:14:39,057 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 2 Total time for transactions(ms): 2 Number of transactions batched in Syncs: 0 Number of syncs: 3 SyncTimes(ms): 4 3 
2016-09-12 17:14:39,059 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000001 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000001-0000000000000000002
2016-09-12 17:14:39,061 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000001 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000001-0000000000000000002
2016-09-12 17:14:39,061 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 3
2016-09-12 17:14:39,093 INFO  namenode.FSImage (BackupImage.java:namenodeStartedLogSegment(350)) - NameNode started a new log segment at txid 3
2016-09-12 17:14:39,094 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 3
2016-09-12 17:14:39,099 DEBUG namenode.FSImage (BackupImage.java:setState(338)) - State transition DROP_UNTIL_NEXT_ROLL -> JOURNAL_ONLY
2016-09-12 17:14:39,102 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 3; numTxns = 1
2016-09-12 17:14:39,213 DEBUG namenode.Checkpointer (Checkpointer.java:doCheckpoint(211)) - Doing checkpoint. Last applied: 0
2016-09-12 17:14:39,218 INFO  namenode.TransferFsImage (TransferFsImage.java:getFileClient(396)) - Opening connection to http://localhost:58060/imagetransfer?getedit=1&startTxId=1&endTxId=2&storageInfo=-63:1416892211:0:testClusterID
2016-09-12 17:14:39,252 INFO  namenode.TransferFsImage (TransferFsImage.java:receiveFile(553)) - Transfer took 0.03s at 0.00 KB/s
2016-09-12 17:14:39,252 INFO  namenode.TransferFsImage (TransferFsImage.java:downloadEditsToStorage(168)) - Downloaded file edits_tmp_0000000000000000001-0000000000000000002_0000000000972372217 size 0 bytes.
2016-09-12 17:14:39,253 INFO  namenode.Checkpointer (Checkpointer.java:rollForwardByApplyingLogs(309)) - Checkpointer about to load edits from 1 stream(s).
2016-09-12 17:14:39,254 DEBUG namenode.FSImage (FSImage.java:loadEdits(834)) - About to load edits:
  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000001-0000000000000000002
2016-09-12 17:14:39,254 INFO  namenode.FSImage (FSImage.java:loadEdits(844)) - Reading /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000001-0000000000000000002 expecting start txid #1
2016-09-12 17:14:39,254 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000001-0000000000000000002
2016-09-12 17:14:39,255 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_END_LOG_SEGMENT=1
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:39,255 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000001-0000000000000000002 of size 42 edits # 2 loaded in 0 seconds
2016-09-12 17:14:39,256 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2016-09-12 17:14:39,300 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/fsimage.ckpt_0000000000000000002 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/fsimage_0000000000000000002
2016-09-12 17:14:39,301 INFO  namenode.FSImageTransactionalStorageInspector (FSImageTransactionalStorageInspector.java:inspectDirectory(85)) - No version file in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1
2016-09-12 17:14:39,352 INFO  namenode.TransferFsImage (TransferFsImage.java:receiveFile(553)) - Transfer took 0.03s at 0.00 KB/s
2016-09-12 17:14:39,353 INFO  namenode.TransferFsImage (TransferFsImage.java:handleUploadImageRequest(134)) - Downloaded file fsimage.ckpt_0000000000000000002 size 351 bytes.
2016-09-12 17:14:39,389 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage.ckpt_0000000000000000002 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000002
2016-09-12 17:14:39,390 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage.ckpt_0000000000000000002 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000002
2016-09-12 17:14:39,393 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 0
2016-09-12 17:14:39,396 INFO  namenode.TransferFsImage (TransferFsImage.java:uploadImageFromStorage(237)) - Uploaded image with txid 2 to namenode at http://localhost:58060 in 0.076 seconds
2016-09-12 17:14:39,399 INFO  namenode.FSNamesystem (FSNamesystem.java:endCheckpoint(6375)) - End checkpoint for localhost:43385
2016-09-12 17:14:39,399 INFO  namenode.FSImage (FSImage.java:endCheckpoint(1373)) - End checkpoint at txid 3
2016-09-12 17:14:39,427 INFO  namenode.FSImage (BackupImage.java:tryConvergeJournalSpool(314)) - Going to finish converging with remaining 1 txns from in-progress stream org.apache.hadoop.hdfs.server.namenode.RedundantEditLogInputStream@8081e3e
2016-09-12 17:14:39,427 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000003
2016-09-12 17:14:39,427 INFO  namenode.EditLogInputStream (RedundantEditLogInputStream.java:nextOp(176)) - Fast-forwarding stream '/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000003' to transaction ID 3
2016-09-12 17:14:39,430 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:39,430 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000003 of size 1048576 edits # 1 loaded in 0 seconds
2016-09-12 17:14:39,431 INFO  namenode.FSImage (BackupImage.java:tryConvergeJournalSpool(326)) - Successfully synced BackupNode with NameNode at txnid 3
2016-09-12 17:14:39,431 DEBUG namenode.FSImage (BackupImage.java:setState(338)) - State transition JOURNAL_ONLY -> IN_SYNC
2016-09-12 17:14:39,433 INFO  namenode.Checkpointer (Checkpointer.java:doCheckpoint(278)) - Checkpoint completed in 0 seconds. New Image Size: 351
2016-09-12 17:14:40,054 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(462)) - examining name dir with files: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000003,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000001-0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000002.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/VERSION,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/seen_txid
2016-09-12 17:14:40,054 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(465)) - Examining storage dir /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current with contents: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000003, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000001-0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000002.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/VERSION, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/seen_txid
2016-09-12 17:14:40,055 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(462)) - examining name dir with files: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000003,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000001-0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000002.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/VERSION,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000000.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000000,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/seen_txid
2016-09-12 17:14:40,055 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(465)) - Examining storage dir /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current with contents: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000003, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000001-0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000002.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/VERSION, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000000.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000000, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/seen_txid
2016-09-12 17:14:40,058 INFO  namenode.NameNode (NameNodeRpcServer.java:errorReport(501)) - Error report from NamenodeRegistration(localhost:43385, role=Backup Node): Shutting down.
2016-09-12 17:14:40,059 INFO  namenode.FSEditLog (FSEditLog.java:releaseBackupStream(1393)) - Removing backup journal BackupJournalManager
SEEEEEEEEEEEEEEEEEEEEETcheckpointManager null
2016-09-12 17:14:40,060 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:40,061 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5269)) - LazyPersistFileScrubber was interrupted, exiting
2016-09-12 17:14:40,062 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 43385
2016-09-12 17:14:40,061 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5196)) - NameNodeEditLogRoller was interrupted, exiting
2016-09-12 17:14:40,065 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 43385
2016-09-12 17:14:40,066 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:40,066 INFO  blockmanagement.BlockManager (BlockManager.java:run(3636)) - Stopping ReplicationMonitor.
2016-09-12 17:14:40,077 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:40,078 INFO  namenode.FSNamesystem (FSNamesystem.java:stopStandbyServices(1317)) - Stopping services started for standby state
2016-09-12 17:14:40,083 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:40,190 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdown(1712)) - Shutting down the Mini HDFS Cluster
2016-09-12 17:14:40,190 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:40,191 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 3
2016-09-12 17:14:40,192 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5196)) - NameNodeEditLogRoller was interrupted, exiting
2016-09-12 17:14:40,191 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5269)) - LazyPersistFileScrubber was interrupted, exiting
2016-09-12 17:14:40,194 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 2 Total time for transactions(ms): 1 Number of transactions batched in Syncs: 1 Number of syncs: 3 SyncTimes(ms): 3 3 
2016-09-12 17:14:40,195 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000003 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000003-0000000000000000004
2016-09-12 17:14:40,197 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000003 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000003-0000000000000000004
2016-09-12 17:14:40,198 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 60354
2016-09-12 17:14:40,204 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 60354
2016-09-12 17:14:40,204 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:40,205 INFO  blockmanagement.BlockManager (BlockManager.java:run(3636)) - Stopping ReplicationMonitor.
2016-09-12 17:14:40,216 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:40,216 INFO  namenode.FSNamesystem (FSNamesystem.java:stopStandbyServices(1317)) - Stopping services started for standby state
2016-09-12 17:14:40,224 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:40,325 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(211)) - Stopping BackupNode metrics system...
2016-09-12 17:14:40,327 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(217)) - BackupNode metrics system stopped.
2016-09-12 17:14:40,328 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:shutdown(606)) - BackupNode metrics system shutdown complete.
2016-09-12 17:14:40,336 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:<init>(446)) - starting cluster: numNameNodes=1, numDataNodes=3
2016-09-12 17:14:40,338 INFO  namenode.NameNode (NameNode.java:createNameNode(1419)) - createNameNode []
2016-09-12 17:14:40,340 WARN  impl.MetricsConfig (MetricsConfig.java:loadFirst(125)) - Cannot locate configuration: tried hadoop-metrics2-namenode.properties,hadoop-metrics2.properties
2016-09-12 17:14:40,343 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:startTimer(377)) - Scheduled snapshot period at 10 second(s).
2016-09-12 17:14:40,344 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:start(192)) - NameNode metrics system started
2016-09-12 17:14:40,344 INFO  namenode.NameNode (NameNode.java:setClientNamenodeAddress(399)) - fs.defaultFS is hdfs://127.0.0.1:0
2016-09-12 17:14:40,358 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1703)) - Starting Web-server for hdfs at: http://localhost:0
2016-09-12 17:14:40,360 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:40,361 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.namenode is not defined
2016-09-12 17:14:40,363 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:40,365 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hdfs
2016-09-12 17:14:40,365 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:40,366 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:40,368 INFO  http.HttpServer2 (NameNodeHttpServer.java:initWebHdfs(86)) - Added filter 'org.apache.hadoop.hdfs.web.AuthFilter' (class=org.apache.hadoop.hdfs.web.AuthFilter)
2016-09-12 17:14:40,368 INFO  http.HttpServer2 (HttpServer2.java:addJerseyResourcePackage(609)) - addJerseyResourcePackage: packageName=org.apache.hadoop.hdfs.server.namenode.web.resources;org.apache.hadoop.hdfs.web.resources, pathSpec=/webhdfs/v1/*
2016-09-12 17:14:40,372 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 53902
2016-09-12 17:14:40,372 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:40,396 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:53902
2016-09-12 17:14:40,399 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(727)) - No KeyProvider found.
2016-09-12 17:14:40,399 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(737)) - fsLock is fair:true
2016-09-12 17:14:40,401 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(242)) - dfs.block.invalidate.limit=1000
2016-09-12 17:14:40,401 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(248)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2016-09-12 17:14:40,402 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(71)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2016-09-12 17:14:40,403 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(76)) - The block deletion will start around 2016 九月 12 17:14:40
2016-09-12 17:14:40,403 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map BlocksMap
2016-09-12 17:14:40,404 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:40,404 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 2.0% max memory 3.6 GB = 72.8 MB
2016-09-12 17:14:40,404 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^23 = 8388608 entries
2016-09-12 17:14:40,481 INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(365)) - dfs.block.access.token.enable=false
2016-09-12 17:14:40,482 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(350)) - defaultReplication         = 0
2016-09-12 17:14:40,482 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(351)) - maxReplication             = 512
2016-09-12 17:14:40,482 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(352)) - minReplication             = 1
2016-09-12 17:14:40,482 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(353)) - maxReplicationStreams      = 2
2016-09-12 17:14:40,483 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(354)) - shouldCheckForEnoughRacks  = false
2016-09-12 17:14:40,483 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(355)) - replicationRecheckInterval = 3000
2016-09-12 17:14:40,483 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(356)) - encryptDataTransfer        = false
2016-09-12 17:14:40,483 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(357)) - maxNumBlocksToLog          = 1000
2016-09-12 17:14:40,484 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(757)) - fsOwner             = root (auth:SIMPLE)
2016-09-12 17:14:40,484 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(758)) - supergroup          = supergroup
2016-09-12 17:14:40,484 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(759)) - isPermissionEnabled = true
2016-09-12 17:14:40,485 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(770)) - HA Enabled: false
2016-09-12 17:14:40,485 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(809)) - Append Enabled: true
2016-09-12 17:14:40,486 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map INodeMap
2016-09-12 17:14:40,486 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:40,487 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 1.0% max memory 3.6 GB = 36.4 MB
2016-09-12 17:14:40,487 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^22 = 4194304 entries
2016-09-12 17:14:40,492 INFO  namenode.FSDirectory (FSDirectory.java:<init>(235)) - ACLs enabled? false
2016-09-12 17:14:40,492 INFO  namenode.FSDirectory (FSDirectory.java:<init>(239)) - XAttrs enabled? true
2016-09-12 17:14:40,492 INFO  namenode.FSDirectory (FSDirectory.java:<init>(247)) - Maximum size of an xattr: 16384
2016-09-12 17:14:40,493 INFO  namenode.NameNode (FSDirectory.java:<init>(295)) - Caching file names occuring more than 10 times
2016-09-12 17:14:40,493 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map cachedBlocks
2016-09-12 17:14:40,494 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:40,494 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.25% max memory 3.6 GB = 9.1 MB
2016-09-12 17:14:40,494 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^20 = 1048576 entries
2016-09-12 17:14:40,496 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5664)) - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2016-09-12 17:14:40,496 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5665)) - dfs.namenode.safemode.min.datanodes = 0
2016-09-12 17:14:40,496 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5666)) - dfs.namenode.safemode.extension     = 0
2016-09-12 17:14:40,497 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:40,497 INFO  metrics.TopMetrics (TopMetrics.java:logConf(65)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2016-09-12 17:14:40,498 INFO  metrics.TopMetrics (TopMetrics.java:logConf(67)) - NNTop conf: dfs.namenode.top.num.users = 10
2016-09-12 17:14:40,498 INFO  metrics.TopMetrics (TopMetrics.java:logConf(69)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2016-09-12 17:14:40,499 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(920)) - Retry cache on namenode is enabled
2016-09-12 17:14:40,499 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(928)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2016-09-12 17:14:40,499 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map NameNodeRetryCache
2016-09-12 17:14:40,499 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:40,500 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.029999999329447746% max memory 3.6 GB = 1.1 MB
2016-09-12 17:14:40,500 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^17 = 131072 entries
2016-09-12 17:14:40,510 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:40,514 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:40,515 TRACE namenode.FSImage (FSImage.java:recoverTransitionRead(228)) - Data dir states:
  Storage Directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2: NORMAL
  Storage Directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1: NORMAL
2016-09-12 17:14:40,518 INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(362)) - Recovering unfinalized segments in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current
2016-09-12 17:14:40,518 INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(362)) - Recovering unfinalized segments in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current
2016-09-12 17:14:40,521 DEBUG namenode.FSImage (FSImage.java:loadFSImage(676)) - Planning to load edit log stream: org.apache.hadoop.hdfs.server.namenode.RedundantEditLogInputStream@18a38dea
2016-09-12 17:14:40,522 DEBUG namenode.FSImage (FSImage.java:loadFSImageFile(740)) - Planning to load image :
FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000002, cpktTxId=0000000000000000002)
2016-09-12 17:14:40,523 INFO  namenode.FSImageFormatPBINode (FSImageFormatPBINode.java:loadINodeSection(259)) - Loading 1 INodes.
2016-09-12 17:14:40,524 INFO  namenode.FSImageFormatProtobuf (FSImageFormatProtobuf.java:load(181)) - Loaded FSImage in 0 seconds.
2016-09-12 17:14:40,525 INFO  namenode.FSImage (FSImage.java:loadFSImage(982)) - Loaded image for txid 2 from /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000002
2016-09-12 17:14:40,525 DEBUG namenode.FSImage (FSImage.java:loadEdits(834)) - About to load edits:
  org.apache.hadoop.hdfs.server.namenode.RedundantEditLogInputStream@18a38dea
2016-09-12 17:14:40,525 INFO  namenode.FSImage (FSImage.java:loadEdits(844)) - Reading org.apache.hadoop.hdfs.server.namenode.RedundantEditLogInputStream@18a38dea expecting start txid #3
2016-09-12 17:14:40,526 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000003-0000000000000000004, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000003-0000000000000000004
2016-09-12 17:14:40,526 INFO  namenode.EditLogInputStream (RedundantEditLogInputStream.java:nextOp(176)) - Fast-forwarding stream '/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000003-0000000000000000004' to transaction ID 3
2016-09-12 17:14:40,527 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_END_LOG_SEGMENT=1
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:40,527 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000003-0000000000000000004, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000003-0000000000000000004 of size 42 edits # 2 loaded in 0 seconds
2016-09-12 17:14:40,528 INFO  namenode.FSNamesystem (FSNamesystem.java:loadFSImage(997)) - Need to save fs image? true (staleImage=true, haEnabled=false, isRollingUpgrade=false)
2016-09-12 17:14:40,528 INFO  namenode.FSImage (FSImage.java:saveNamespace(1102)) - Save namespace ...
2016-09-12 17:14:40,589 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage.ckpt_0000000000000000004 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000004
2016-09-12 17:14:40,590 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage.ckpt_0000000000000000004 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000004
2016-09-12 17:14:40,591 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 2
2016-09-12 17:14:40,592 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000, cpktTxId=0000000000000000000)
2016-09-12 17:14:40,593 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000000, cpktTxId=0000000000000000000)
2016-09-12 17:14:40,607 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 5
2016-09-12 17:14:40,700 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2016-09-12 17:14:40,701 INFO  namenode.FSNamesystem (FSNamesystem.java:loadFromDisk(699)) - Finished loading FSImage in 199 msecs
2016-09-12 17:14:40,702 INFO  namenode.NameNode (NameNodeRpcServer.java:<init>(342)) - RPC server is binding to localhost:0
2016-09-12 17:14:40,702 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:40,703 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 54649
2016-09-12 17:14:40,710 INFO  namenode.NameNode (NameNode.java:initialize(654)) - Clients are to use localhost:54649 to access this namenode/service.
2016-09-12 17:14:40,711 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(6536)) - Registered FSNamesystemState MBean
2016-09-12 17:14:40,728 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:40,729 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:40,729 INFO  namenode.FSNamesystem (FSNamesystem.java:initializeReplQueues(1202)) - initializing replication queues
2016-09-12 17:14:40,730 INFO  hdfs.StateChange (FSNamesystem.java:leave(5739)) - STATE* Leaving safe mode after 0 secs
2016-09-12 17:14:40,730 INFO  hdfs.StateChange (FSNamesystem.java:leave(5751)) - STATE* Network topology has 0 racks and 0 datanodes
2016-09-12 17:14:40,730 INFO  hdfs.StateChange (FSNamesystem.java:leave(5754)) - STATE* UnderReplicatedBlocks has 0 blocks
2016-09-12 17:14:40,731 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:40,742 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2766)) - Total number of blocks            = 0
2016-09-12 17:14:40,743 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2767)) - Number of invalid blocks          = 0
2016-09-12 17:14:40,743 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2768)) - Number of under-replicated blocks = 0
2016-09-12 17:14:40,743 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2769)) - Number of  over-replicated blocks = 0
2016-09-12 17:14:40,743 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2771)) - Number of blocks being written    = 0
2016-09-12 17:14:40,743 INFO  hdfs.StateChange (BlockManager.java:processMisReplicatesAsync(2772)) - STATE* Replication Queue initialization scan for invalid, over- and under-replicated blocks completed in 13 msec
2016-09-12 17:14:40,768 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:40,768 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 54649: starting
2016-09-12 17:14:40,771 INFO  namenode.NameNode (NameNode.java:startCommonServices(697)) - NameNode RPC up at: localhost/127.0.0.1:54649
2016-09-12 17:14:40,771 INFO  namenode.FSNamesystem (FSNamesystem.java:startActiveServices(1123)) - Starting services required for active state
2016-09-12 17:14:40,773 INFO  blockmanagement.CacheReplicationMonitor (CacheReplicationMonitor.java:run(160)) - Starting CacheReplicationMonitor with interval 30000 milliseconds
2016-09-12 17:14:40,775 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:startDataNodes(1413)) - Starting DataNode 0 with dfs.datanode.data.dir: [DISK]file:/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1,[DISK]file:/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2
2016-09-12 17:14:40,788 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(159)) - DataNode metrics system started (again)
2016-09-12 17:14:40,789 INFO  datanode.BlockScanner (BlockScanner.java:<init>(175)) - Disabled block scanner.
2016-09-12 17:14:40,789 INFO  datanode.DataNode (DataNode.java:<init>(434)) - Configured hostname is 127.0.0.1
2016-09-12 17:14:40,790 INFO  datanode.DataNode (DataNode.java:startDataNode(1147)) - Starting DataNode with maxLockedMemory = 0
2016-09-12 17:14:40,791 INFO  datanode.DataNode (DataXceiverServer.java:<init>(76)) - Balancing bandwith is 1048576 bytes/s
2016-09-12 17:14:40,791 INFO  datanode.DataNode (DataXceiverServer.java:<init>(77)) - Number threads for balancing is 5
2016-09-12 17:14:40,792 INFO  datanode.DataNode (DataNode.java:initDataXceiver(929)) - Opened streaming server at /127.0.0.1:34557
2016-09-12 17:14:40,796 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:40,797 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.datanode is not defined
2016-09-12 17:14:40,798 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:40,799 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context datanode
2016-09-12 17:14:40,800 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:40,800 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:40,802 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 36020
2016-09-12 17:14:40,803 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:40,824 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:36020
2016-09-12 17:14:40,830 INFO  web.DatanodeHttpServer (DatanodeHttpServer.java:start(186)) - Listening HTTP traffic on /127.0.0.1:39127
2016-09-12 17:14:40,830 INFO  datanode.DataNode (DataNode.java:startDataNode(1164)) - dnUserName = root
2016-09-12 17:14:40,831 INFO  datanode.DataNode (DataNode.java:startDataNode(1165)) - supergroup = supergroup
2016-09-12 17:14:40,831 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:40,833 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 52069
2016-09-12 17:14:40,839 INFO  datanode.DataNode (DataNode.java:initIpcServer(824)) - Opened IPC server at /127.0.0.1:52069
2016-09-12 17:14:40,852 INFO  datanode.DataNode (BlockPoolManager.java:refreshNamenodes(152)) - Refresh request received for nameservices: null
2016-09-12 17:14:40,852 INFO  datanode.DataNode (BlockPoolManager.java:doRefreshNamenodes(197)) - Starting BPOfferServices for nameservices: <default>
2016-09-12 17:14:40,854 INFO  datanode.DataNode (BPServiceActor.java:run(794)) - Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:54649 starting to offer service
2016-09-12 17:14:40,855 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:40,857 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 52069: starting
2016-09-12 17:14:40,864 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:startDataNodes(1413)) - Starting DataNode 1 with dfs.datanode.data.dir: [DISK]file:/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3,[DISK]file:/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4
2016-09-12 17:14:40,880 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(159)) - DataNode metrics system started (again)
2016-09-12 17:14:40,880 INFO  datanode.BlockScanner (BlockScanner.java:<init>(175)) - Disabled block scanner.
2016-09-12 17:14:40,880 INFO  datanode.DataNode (DataNode.java:<init>(434)) - Configured hostname is 127.0.0.1
2016-09-12 17:14:40,881 INFO  datanode.DataNode (DataNode.java:startDataNode(1147)) - Starting DataNode with maxLockedMemory = 0
2016-09-12 17:14:40,882 INFO  datanode.DataNode (DataXceiverServer.java:<init>(76)) - Balancing bandwith is 1048576 bytes/s
2016-09-12 17:14:40,882 INFO  datanode.DataNode (DataXceiverServer.java:<init>(77)) - Number threads for balancing is 5
2016-09-12 17:14:40,883 INFO  datanode.DataNode (DataNode.java:initDataXceiver(929)) - Opened streaming server at /127.0.0.1:37366
2016-09-12 17:14:40,887 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:40,888 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.datanode is not defined
2016-09-12 17:14:40,889 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:40,893 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context datanode
2016-09-12 17:14:40,893 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:40,894 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:40,896 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 34724
2016-09-12 17:14:40,897 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:40,900 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:40,900 INFO  common.Storage (DataStorage.java:loadStorageDirectory(273)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1 is not formatted for BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:40,900 INFO  common.Storage (DataStorage.java:loadStorageDirectory(275)) - Formatting ...
2016-09-12 17:14:40,918 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:34724
2016-09-12 17:14:40,924 INFO  web.DatanodeHttpServer (DatanodeHttpServer.java:start(186)) - Listening HTTP traffic on /127.0.0.1:51478
2016-09-12 17:14:40,925 INFO  datanode.DataNode (DataNode.java:startDataNode(1164)) - dnUserName = root
2016-09-12 17:14:40,925 INFO  datanode.DataNode (DataNode.java:startDataNode(1165)) - supergroup = supergroup
2016-09-12 17:14:40,926 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:40,927 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 32945
2016-09-12 17:14:40,943 INFO  datanode.DataNode (DataNode.java:initIpcServer(824)) - Opened IPC server at /127.0.0.1:32945
2016-09-12 17:14:40,958 INFO  datanode.DataNode (BlockPoolManager.java:refreshNamenodes(152)) - Refresh request received for nameservices: null
2016-09-12 17:14:40,959 INFO  datanode.DataNode (BlockPoolManager.java:doRefreshNamenodes(197)) - Starting BPOfferServices for nameservices: <default>
2016-09-12 17:14:40,961 INFO  datanode.DataNode (BPServiceActor.java:run(794)) - Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:54649 starting to offer service
2016-09-12 17:14:40,962 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:40,970 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 32945: starting
2016-09-12 17:14:40,975 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:startDataNodes(1413)) - Starting DataNode 2 with dfs.datanode.data.dir: [DISK]file:/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5,[DISK]file:/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6
2016-09-12 17:14:40,987 INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(241)) - Analyzing storage directories for bpid BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:40,988 INFO  common.Storage (Storage.java:lock(675)) - Locking is disabled for /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current/BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:40,989 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(158)) - Block pool storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current/BP-711728946-192.168.9.78-1473671678380 is not formatted for BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:40,989 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(160)) - Formatting ...
2016-09-12 17:14:40,989 INFO  common.Storage (BlockPoolSliceStorage.java:format(267)) - Formatting block pool BP-711728946-192.168.9.78-1473671678380 directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current/BP-711728946-192.168.9.78-1473671678380/current
2016-09-12 17:14:40,993 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(159)) - DataNode metrics system started (again)
2016-09-12 17:14:40,994 INFO  datanode.BlockScanner (BlockScanner.java:<init>(175)) - Disabled block scanner.
2016-09-12 17:14:40,994 INFO  datanode.DataNode (DataNode.java:<init>(434)) - Configured hostname is 127.0.0.1
2016-09-12 17:14:40,995 INFO  datanode.DataNode (DataNode.java:startDataNode(1147)) - Starting DataNode with maxLockedMemory = 0
2016-09-12 17:14:40,996 INFO  datanode.DataNode (DataXceiverServer.java:<init>(76)) - Balancing bandwith is 1048576 bytes/s
2016-09-12 17:14:40,996 INFO  datanode.DataNode (DataXceiverServer.java:<init>(77)) - Number threads for balancing is 5
2016-09-12 17:14:40,997 INFO  datanode.DataNode (DataNode.java:initDataXceiver(929)) - Opened streaming server at /127.0.0.1:44134
2016-09-12 17:14:41,001 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:41,002 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.datanode is not defined
2016-09-12 17:14:41,004 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:41,005 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context datanode
2016-09-12 17:14:41,006 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:41,007 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:41,009 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:41,009 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 59849
2016-09-12 17:14:41,010 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:41,010 INFO  common.Storage (DataStorage.java:loadStorageDirectory(273)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3 is not formatted for BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,011 INFO  common.Storage (DataStorage.java:loadStorageDirectory(275)) - Formatting ...
2016-09-12 17:14:41,029 INFO  common.Storage (BlockPoolSliceStorage.java:doTransition(359)) - Restored 0 block files from trash.
2016-09-12 17:14:41,032 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:59849
2016-09-12 17:14:41,038 INFO  web.DatanodeHttpServer (DatanodeHttpServer.java:start(186)) - Listening HTTP traffic on /127.0.0.1:52489
2016-09-12 17:14:41,039 INFO  datanode.DataNode (DataNode.java:startDataNode(1164)) - dnUserName = root
2016-09-12 17:14:41,040 INFO  datanode.DataNode (DataNode.java:startDataNode(1165)) - supergroup = supergroup
2016-09-12 17:14:41,040 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:41,042 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 57523
2016-09-12 17:14:41,048 INFO  datanode.DataNode (DataNode.java:initIpcServer(824)) - Opened IPC server at /127.0.0.1:57523
2016-09-12 17:14:41,062 INFO  datanode.DataNode (BlockPoolManager.java:refreshNamenodes(152)) - Refresh request received for nameservices: null
2016-09-12 17:14:41,063 INFO  datanode.DataNode (BlockPoolManager.java:doRefreshNamenodes(197)) - Starting BPOfferServices for nameservices: <default>
2016-09-12 17:14:41,065 INFO  datanode.DataNode (BPServiceActor.java:run(794)) - Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:54649 starting to offer service
2016-09-12 17:14:41,069 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:41,070 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 57523: starting
2016-09-12 17:14:41,070 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:41,072 INFO  common.Storage (DataStorage.java:loadStorageDirectory(273)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2 is not formatted for BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,077 INFO  common.Storage (DataStorage.java:loadStorageDirectory(275)) - Formatting ...
2016-09-12 17:14:41,106 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2303)) - dnInfo.length != numDataNodes
2016-09-12 17:14:41,106 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2255)) - Waiting for cluster to become active
2016-09-12 17:14:41,114 INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(241)) - Analyzing storage directories for bpid BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,115 INFO  common.Storage (Storage.java:lock(675)) - Locking is disabled for /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current/BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,115 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(158)) - Block pool storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current/BP-711728946-192.168.9.78-1473671678380 is not formatted for BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,116 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(160)) - Formatting ...
2016-09-12 17:14:41,116 INFO  common.Storage (BlockPoolSliceStorage.java:format(267)) - Formatting block pool BP-711728946-192.168.9.78-1473671678380 directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current/BP-711728946-192.168.9.78-1473671678380/current
2016-09-12 17:14:41,141 INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(241)) - Analyzing storage directories for bpid BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,142 INFO  common.Storage (Storage.java:lock(675)) - Locking is disabled for /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current/BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,142 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(158)) - Block pool storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current/BP-711728946-192.168.9.78-1473671678380 is not formatted for BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,143 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(160)) - Formatting ...
2016-09-12 17:14:41,143 INFO  common.Storage (BlockPoolSliceStorage.java:format(267)) - Formatting block pool BP-711728946-192.168.9.78-1473671678380 directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current/BP-711728946-192.168.9.78-1473671678380/current
2016-09-12 17:14:41,145 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:41,145 INFO  common.Storage (DataStorage.java:loadStorageDirectory(273)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5 is not formatted for BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,146 INFO  common.Storage (DataStorage.java:loadStorageDirectory(275)) - Formatting ...
2016-09-12 17:14:41,146 INFO  common.Storage (BlockPoolSliceStorage.java:doTransition(359)) - Restored 0 block files from trash.
2016-09-12 17:14:41,181 INFO  common.Storage (BlockPoolSliceStorage.java:doTransition(359)) - Restored 0 block files from trash.
2016-09-12 17:14:41,185 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:41,186 INFO  common.Storage (DataStorage.java:loadStorageDirectory(273)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4 is not formatted for BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,186 INFO  common.Storage (DataStorage.java:loadStorageDirectory(275)) - Formatting ...
2016-09-12 17:14:41,196 INFO  datanode.DataNode (DataNode.java:initStorage(1411)) - Setting up storage: nsid=1416892211;bpid=BP-711728946-192.168.9.78-1473671678380;lv=-56;nsInfo=lv=-63;cid=testClusterID;nsid=1416892211;c=0;bpid=BP-711728946-192.168.9.78-1473671678380;dnuuid=null
2016-09-12 17:14:41,210 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2303)) - dnInfo.length != numDataNodes
2016-09-12 17:14:41,210 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2255)) - Waiting for cluster to become active
2016-09-12 17:14:41,225 INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(241)) - Analyzing storage directories for bpid BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,225 INFO  common.Storage (Storage.java:lock(675)) - Locking is disabled for /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current/BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,226 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(158)) - Block pool storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current/BP-711728946-192.168.9.78-1473671678380 is not formatted for BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,226 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(160)) - Formatting ...
2016-09-12 17:14:41,227 INFO  common.Storage (BlockPoolSliceStorage.java:format(267)) - Formatting block pool BP-711728946-192.168.9.78-1473671678380 directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current/BP-711728946-192.168.9.78-1473671678380/current
2016-09-12 17:14:41,248 INFO  datanode.DataNode (DataNode.java:checkDatanodeUuid(1240)) - Generated and persisted new Datanode UUID 129095f6-8c4c-4b93-b7b3-2c988ea50f76
2016-09-12 17:14:41,250 INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(303)) - Added new volume: DS-10ffbd4d-42e6-4115-a179-6b40810124e8
2016-09-12 17:14:41,250 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(380)) - Added volume - /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current, StorageType: DISK
2016-09-12 17:14:41,251 INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(303)) - Added new volume: DS-eacf4ec1-26ed-4392-b8f9-46b58465e36a
2016-09-12 17:14:41,251 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(380)) - Added volume - /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current, StorageType: DISK
2016-09-12 17:14:41,253 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:registerMBean(2028)) - Registered FSDatasetState MBean
2016-09-12 17:14:41,254 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addBlockPool(2474)) - Adding block pool BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,255 INFO  common.Storage (BlockPoolSliceStorage.java:doTransition(359)) - Restored 0 block files from trash.
2016-09-12 17:14:41,256 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(402)) - Scanning block pool BP-711728946-192.168.9.78-1473671678380 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current...
2016-09-12 17:14:41,259 INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(241)) - Analyzing storage directories for bpid BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,260 INFO  common.Storage (Storage.java:lock(675)) - Locking is disabled for /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current/BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,260 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(158)) - Block pool storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current/BP-711728946-192.168.9.78-1473671678380 is not formatted for BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,260 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(160)) - Formatting ...
2016-09-12 17:14:41,261 INFO  common.Storage (BlockPoolSliceStorage.java:format(267)) - Formatting block pool BP-711728946-192.168.9.78-1473671678380 directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current/BP-711728946-192.168.9.78-1473671678380/current
2016-09-12 17:14:41,262 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(402)) - Scanning block pool BP-711728946-192.168.9.78-1473671678380 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current...
2016-09-12 17:14:41,264 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(407)) - Time taken to scan block pool BP-711728946-192.168.9.78-1473671678380 on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current: 7ms
2016-09-12 17:14:41,275 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(407)) - Time taken to scan block pool BP-711728946-192.168.9.78-1473671678380 on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current: 12ms
2016-09-12 17:14:41,277 INFO  impl.FsDatasetImpl (FsVolumeList.java:addBlockPool(433)) - Total time to scan all replicas for block pool BP-711728946-192.168.9.78-1473671678380: 23ms
2016-09-12 17:14:41,278 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(189)) - Adding replicas to map for block pool BP-711728946-192.168.9.78-1473671678380 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current...
2016-09-12 17:14:41,278 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(189)) - Adding replicas to map for block pool BP-711728946-192.168.9.78-1473671678380 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current...
2016-09-12 17:14:41,278 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(194)) - Time to add replicas to map for block pool BP-711728946-192.168.9.78-1473671678380 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current: 0ms
2016-09-12 17:14:41,279 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(194)) - Time to add replicas to map for block pool BP-711728946-192.168.9.78-1473671678380 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current: 1ms
2016-09-12 17:14:41,279 INFO  impl.FsDatasetImpl (FsVolumeList.java:getAllVolumesMap(220)) - Total time to add all replicas to map: 2ms
2016-09-12 17:14:41,280 INFO  datanode.DirectoryScanner (DirectoryScanner.java:start(332)) - Periodic Directory Tree Verification scan starting at 1473675929280 with interval 21600000
2016-09-12 17:14:41,286 INFO  datanode.DataNode (BPServiceActor.java:register(749)) - Block pool BP-711728946-192.168.9.78-1473671678380 (Datanode Uuid null) service to localhost/127.0.0.1:54649 beginning handshake with NN
2016-09-12 17:14:41,287 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:41,287 INFO  common.Storage (BlockPoolSliceStorage.java:doTransition(359)) - Restored 0 block files from trash.
2016-09-12 17:14:41,287 INFO  common.Storage (DataStorage.java:loadStorageDirectory(273)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6 is not formatted for BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,288 INFO  common.Storage (DataStorage.java:loadStorageDirectory(275)) - Formatting ...
2016-09-12 17:14:41,289 INFO  hdfs.StateChange (DatanodeManager.java:registerDatanode(891)) - BLOCK* registerDatanode: from DatanodeRegistration(127.0.0.1:34557, datanodeUuid=129095f6-8c4c-4b93-b7b3-2c988ea50f76, infoPort=39127, infoSecurePort=0, ipcPort=52069, storageInfo=lv=-56;cid=testClusterID;nsid=1416892211;c=0) storage 129095f6-8c4c-4b93-b7b3-2c988ea50f76
2016-09-12 17:14:41,289 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:41,289 INFO  net.NetworkTopology (NetworkTopology.java:add(419)) - Adding a new node: /default-rack/127.0.0.1:34557
2016-09-12 17:14:41,291 INFO  datanode.DataNode (DataNode.java:initStorage(1411)) - Setting up storage: nsid=1416892211;bpid=BP-711728946-192.168.9.78-1473671678380;lv=-56;nsInfo=lv=-63;cid=testClusterID;nsid=1416892211;c=0;bpid=BP-711728946-192.168.9.78-1473671678380;dnuuid=null
2016-09-12 17:14:41,291 INFO  datanode.DataNode (BPServiceActor.java:register(767)) - Block pool Block pool BP-711728946-192.168.9.78-1473671678380 (Datanode Uuid null) service to localhost/127.0.0.1:54649 successfully registered with NN
2016-09-12 17:14:41,292 INFO  datanode.DataNode (BPServiceActor.java:offerService(625)) - For namenode localhost/127.0.0.1:54649 using DELETEREPORT_INTERVAL of 300000 msec  BLOCKREPORT_INTERVAL of 21600000msec CACHEREPORT_INTERVAL of 10000msec Initial delay: 0msec; heartBeatInterval=3000
2016-09-12 17:14:41,296 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:41,296 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-10ffbd4d-42e6-4115-a179-6b40810124e8 for DN 127.0.0.1:34557
2016-09-12 17:14:41,296 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-eacf4ec1-26ed-4392-b8f9-46b58465e36a for DN 127.0.0.1:34557
2016-09-12 17:14:41,297 INFO  datanode.DataNode (BPOfferService.java:updateActorStatesFromHeartbeat(507)) - Namenode Block pool BP-711728946-192.168.9.78-1473671678380 (Datanode Uuid 129095f6-8c4c-4b93-b7b3-2c988ea50f76) service to localhost/127.0.0.1:54649 trying to claim ACTIVE state with txid=5
2016-09-12 17:14:41,298 INFO  datanode.DataNode (BPOfferService.java:updateActorStatesFromHeartbeat(519)) - Acknowledging ACTIVE Namenode Block pool BP-711728946-192.168.9.78-1473671678380 (Datanode Uuid 129095f6-8c4c-4b93-b7b3-2c988ea50f76) service to localhost/127.0.0.1:54649
2016-09-12 17:14:41,301 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-10ffbd4d-42e6-4115-a179-6b40810124e8 node DatanodeRegistration(127.0.0.1:34557, datanodeUuid=129095f6-8c4c-4b93-b7b3-2c988ea50f76, infoPort=39127, infoSecurePort=0, ipcPort=52069, storageInfo=lv=-56;cid=testClusterID;nsid=1416892211;c=0), blocks: 0, hasStaleStorage: true, processing time: 1 msecs
2016-09-12 17:14:41,301 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-eacf4ec1-26ed-4392-b8f9-46b58465e36a node DatanodeRegistration(127.0.0.1:34557, datanodeUuid=129095f6-8c4c-4b93-b7b3-2c988ea50f76, infoPort=39127, infoSecurePort=0, ipcPort=52069, storageInfo=lv=-56;cid=testClusterID;nsid=1416892211;c=0), blocks: 0, hasStaleStorage: false, processing time: 0 msecs
2016-09-12 17:14:41,302 INFO  datanode.DataNode (BPServiceActor.java:blockReport(492)) - Successfully sent block report 0x3745e88a8e4ac,  containing 2 storage report(s), of which we sent 2. The reports had 0 total blocks and used 1 RPC(s). This took 0 msec to generate and 4 msecs for RPC and NN processing. Got back one command: FinalizeCommand/5.
2016-09-12 17:14:41,302 INFO  datanode.DataNode (BPOfferService.java:processCommandFromActive(690)) - Got finalize command for block pool BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,314 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2303)) - dnInfo.length != numDataNodes
2016-09-12 17:14:41,314 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2255)) - Waiting for cluster to become active
2016-09-12 17:14:41,335 INFO  datanode.DataNode (DataNode.java:checkDatanodeUuid(1240)) - Generated and persisted new Datanode UUID 88b6b7ce-9646-4f1c-9ebe-502065661187
2016-09-12 17:14:41,337 INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(303)) - Added new volume: DS-1d889c32-bb05-4316-9068-b552ad03a4e3
2016-09-12 17:14:41,337 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(380)) - Added volume - /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current, StorageType: DISK
2016-09-12 17:14:41,337 INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(303)) - Added new volume: DS-7d65c063-c2f6-4ece-84cd-54f287425d05
2016-09-12 17:14:41,338 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(380)) - Added volume - /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current, StorageType: DISK
2016-09-12 17:14:41,339 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:registerMBean(2028)) - Registered FSDatasetState MBean
2016-09-12 17:14:41,340 INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(241)) - Analyzing storage directories for bpid BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,340 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addBlockPool(2474)) - Adding block pool BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,340 INFO  common.Storage (Storage.java:lock(675)) - Locking is disabled for /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current/BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,340 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(158)) - Block pool storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current/BP-711728946-192.168.9.78-1473671678380 is not formatted for BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,341 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(160)) - Formatting ...
2016-09-12 17:14:41,341 INFO  common.Storage (BlockPoolSliceStorage.java:format(267)) - Formatting block pool BP-711728946-192.168.9.78-1473671678380 directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current/BP-711728946-192.168.9.78-1473671678380/current
2016-09-12 17:14:41,342 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(402)) - Scanning block pool BP-711728946-192.168.9.78-1473671678380 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current...
2016-09-12 17:14:41,342 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(402)) - Scanning block pool BP-711728946-192.168.9.78-1473671678380 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current...
2016-09-12 17:14:41,349 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(407)) - Time taken to scan block pool BP-711728946-192.168.9.78-1473671678380 on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current: 7ms
2016-09-12 17:14:41,349 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(407)) - Time taken to scan block pool BP-711728946-192.168.9.78-1473671678380 on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current: 6ms
2016-09-12 17:14:41,350 INFO  impl.FsDatasetImpl (FsVolumeList.java:addBlockPool(433)) - Total time to scan all replicas for block pool BP-711728946-192.168.9.78-1473671678380: 10ms
2016-09-12 17:14:41,351 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(189)) - Adding replicas to map for block pool BP-711728946-192.168.9.78-1473671678380 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current...
2016-09-12 17:14:41,351 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(189)) - Adding replicas to map for block pool BP-711728946-192.168.9.78-1473671678380 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current...
2016-09-12 17:14:41,351 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(194)) - Time to add replicas to map for block pool BP-711728946-192.168.9.78-1473671678380 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current: 0ms
2016-09-12 17:14:41,352 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(194)) - Time to add replicas to map for block pool BP-711728946-192.168.9.78-1473671678380 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current: 0ms
2016-09-12 17:14:41,352 INFO  impl.FsDatasetImpl (FsVolumeList.java:getAllVolumesMap(220)) - Total time to add all replicas to map: 1ms
2016-09-12 17:14:41,353 INFO  datanode.DirectoryScanner (DirectoryScanner.java:start(332)) - Periodic Directory Tree Verification scan starting at 1473687740353 with interval 21600000
2016-09-12 17:14:41,354 INFO  datanode.DataNode (BPServiceActor.java:register(749)) - Block pool BP-711728946-192.168.9.78-1473671678380 (Datanode Uuid null) service to localhost/127.0.0.1:54649 beginning handshake with NN
2016-09-12 17:14:41,356 INFO  hdfs.StateChange (DatanodeManager.java:registerDatanode(891)) - BLOCK* registerDatanode: from DatanodeRegistration(127.0.0.1:37366, datanodeUuid=88b6b7ce-9646-4f1c-9ebe-502065661187, infoPort=51478, infoSecurePort=0, ipcPort=32945, storageInfo=lv=-56;cid=testClusterID;nsid=1416892211;c=0) storage 88b6b7ce-9646-4f1c-9ebe-502065661187
2016-09-12 17:14:41,357 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:41,357 INFO  net.NetworkTopology (NetworkTopology.java:add(419)) - Adding a new node: /default-rack/127.0.0.1:37366
2016-09-12 17:14:41,359 INFO  datanode.DataNode (BPServiceActor.java:register(767)) - Block pool Block pool BP-711728946-192.168.9.78-1473671678380 (Datanode Uuid null) service to localhost/127.0.0.1:54649 successfully registered with NN
2016-09-12 17:14:41,359 INFO  datanode.DataNode (BPServiceActor.java:offerService(625)) - For namenode localhost/127.0.0.1:54649 using DELETEREPORT_INTERVAL of 300000 msec  BLOCKREPORT_INTERVAL of 21600000msec CACHEREPORT_INTERVAL of 10000msec Initial delay: 0msec; heartBeatInterval=3000
2016-09-12 17:14:41,363 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:41,363 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-1d889c32-bb05-4316-9068-b552ad03a4e3 for DN 127.0.0.1:37366
2016-09-12 17:14:41,363 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-7d65c063-c2f6-4ece-84cd-54f287425d05 for DN 127.0.0.1:37366
2016-09-12 17:14:41,364 INFO  datanode.DataNode (BPOfferService.java:updateActorStatesFromHeartbeat(507)) - Namenode Block pool BP-711728946-192.168.9.78-1473671678380 (Datanode Uuid 88b6b7ce-9646-4f1c-9ebe-502065661187) service to localhost/127.0.0.1:54649 trying to claim ACTIVE state with txid=5
2016-09-12 17:14:41,365 INFO  datanode.DataNode (BPOfferService.java:updateActorStatesFromHeartbeat(519)) - Acknowledging ACTIVE Namenode Block pool BP-711728946-192.168.9.78-1473671678380 (Datanode Uuid 88b6b7ce-9646-4f1c-9ebe-502065661187) service to localhost/127.0.0.1:54649
2016-09-12 17:14:41,367 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-1d889c32-bb05-4316-9068-b552ad03a4e3 node DatanodeRegistration(127.0.0.1:37366, datanodeUuid=88b6b7ce-9646-4f1c-9ebe-502065661187, infoPort=51478, infoSecurePort=0, ipcPort=32945, storageInfo=lv=-56;cid=testClusterID;nsid=1416892211;c=0), blocks: 0, hasStaleStorage: true, processing time: 0 msecs
2016-09-12 17:14:41,367 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-7d65c063-c2f6-4ece-84cd-54f287425d05 node DatanodeRegistration(127.0.0.1:37366, datanodeUuid=88b6b7ce-9646-4f1c-9ebe-502065661187, infoPort=51478, infoSecurePort=0, ipcPort=32945, storageInfo=lv=-56;cid=testClusterID;nsid=1416892211;c=0), blocks: 0, hasStaleStorage: false, processing time: 0 msecs
2016-09-12 17:14:41,368 INFO  common.Storage (BlockPoolSliceStorage.java:doTransition(359)) - Restored 0 block files from trash.
2016-09-12 17:14:41,368 INFO  datanode.DataNode (BPServiceActor.java:blockReport(492)) - Successfully sent block report 0x3745e8ca4971e,  containing 2 storage report(s), of which we sent 2. The reports had 0 total blocks and used 1 RPC(s). This took 0 msec to generate and 3 msecs for RPC and NN processing. Got back one command: FinalizeCommand/5.
2016-09-12 17:14:41,369 INFO  datanode.DataNode (BPOfferService.java:processCommandFromActive(690)) - Got finalize command for block pool BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,374 INFO  datanode.DataNode (DataNode.java:initStorage(1411)) - Setting up storage: nsid=1416892211;bpid=BP-711728946-192.168.9.78-1473671678380;lv=-56;nsInfo=lv=-63;cid=testClusterID;nsid=1416892211;c=0;bpid=BP-711728946-192.168.9.78-1473671678380;dnuuid=null
2016-09-12 17:14:41,408 INFO  datanode.DataNode (DataNode.java:checkDatanodeUuid(1240)) - Generated and persisted new Datanode UUID 5c52fd0c-958e-484f-a303-2baee049e83d
2016-09-12 17:14:41,409 INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(303)) - Added new volume: DS-03f0b071-e149-4371-b9e5-0864a9678930
2016-09-12 17:14:41,409 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(380)) - Added volume - /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current, StorageType: DISK
2016-09-12 17:14:41,410 INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(303)) - Added new volume: DS-e1c30477-0e1b-47e8-a1ae-a66aca25971c
2016-09-12 17:14:41,410 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(380)) - Added volume - /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current, StorageType: DISK
2016-09-12 17:14:41,412 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:registerMBean(2028)) - Registered FSDatasetState MBean
2016-09-12 17:14:41,412 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addBlockPool(2474)) - Adding block pool BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,413 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(402)) - Scanning block pool BP-711728946-192.168.9.78-1473671678380 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current...
2016-09-12 17:14:41,413 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(402)) - Scanning block pool BP-711728946-192.168.9.78-1473671678380 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current...
2016-09-12 17:14:41,419 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(407)) - Time taken to scan block pool BP-711728946-192.168.9.78-1473671678380 on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current: 6ms
2016-09-12 17:14:41,419 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(407)) - Time taken to scan block pool BP-711728946-192.168.9.78-1473671678380 on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current: 6ms
2016-09-12 17:14:41,419 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2303)) - dnInfo.length != numDataNodes
2016-09-12 17:14:41,420 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2255)) - Waiting for cluster to become active
2016-09-12 17:14:41,420 INFO  impl.FsDatasetImpl (FsVolumeList.java:addBlockPool(433)) - Total time to scan all replicas for block pool BP-711728946-192.168.9.78-1473671678380: 8ms
2016-09-12 17:14:41,421 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(189)) - Adding replicas to map for block pool BP-711728946-192.168.9.78-1473671678380 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current...
2016-09-12 17:14:41,421 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(189)) - Adding replicas to map for block pool BP-711728946-192.168.9.78-1473671678380 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current...
2016-09-12 17:14:41,421 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(194)) - Time to add replicas to map for block pool BP-711728946-192.168.9.78-1473671678380 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current: 0ms
2016-09-12 17:14:41,421 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(194)) - Time to add replicas to map for block pool BP-711728946-192.168.9.78-1473671678380 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current: 0ms
2016-09-12 17:14:41,422 INFO  impl.FsDatasetImpl (FsVolumeList.java:getAllVolumesMap(220)) - Total time to add all replicas to map: 2ms
2016-09-12 17:14:41,422 INFO  datanode.DirectoryScanner (DirectoryScanner.java:start(332)) - Periodic Directory Tree Verification scan starting at 1473685575422 with interval 21600000
2016-09-12 17:14:41,423 INFO  datanode.DataNode (BPServiceActor.java:register(749)) - Block pool BP-711728946-192.168.9.78-1473671678380 (Datanode Uuid null) service to localhost/127.0.0.1:54649 beginning handshake with NN
2016-09-12 17:14:41,425 INFO  hdfs.StateChange (DatanodeManager.java:registerDatanode(891)) - BLOCK* registerDatanode: from DatanodeRegistration(127.0.0.1:44134, datanodeUuid=5c52fd0c-958e-484f-a303-2baee049e83d, infoPort=52489, infoSecurePort=0, ipcPort=57523, storageInfo=lv=-56;cid=testClusterID;nsid=1416892211;c=0) storage 5c52fd0c-958e-484f-a303-2baee049e83d
2016-09-12 17:14:41,426 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:41,426 INFO  net.NetworkTopology (NetworkTopology.java:add(419)) - Adding a new node: /default-rack/127.0.0.1:44134
2016-09-12 17:14:41,428 INFO  datanode.DataNode (BPServiceActor.java:register(767)) - Block pool Block pool BP-711728946-192.168.9.78-1473671678380 (Datanode Uuid null) service to localhost/127.0.0.1:54649 successfully registered with NN
2016-09-12 17:14:41,428 INFO  datanode.DataNode (BPServiceActor.java:offerService(625)) - For namenode localhost/127.0.0.1:54649 using DELETEREPORT_INTERVAL of 300000 msec  BLOCKREPORT_INTERVAL of 21600000msec CACHEREPORT_INTERVAL of 10000msec Initial delay: 0msec; heartBeatInterval=3000
2016-09-12 17:14:41,431 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:41,432 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-03f0b071-e149-4371-b9e5-0864a9678930 for DN 127.0.0.1:44134
2016-09-12 17:14:41,432 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-e1c30477-0e1b-47e8-a1ae-a66aca25971c for DN 127.0.0.1:44134
2016-09-12 17:14:41,433 INFO  datanode.DataNode (BPOfferService.java:updateActorStatesFromHeartbeat(507)) - Namenode Block pool BP-711728946-192.168.9.78-1473671678380 (Datanode Uuid 5c52fd0c-958e-484f-a303-2baee049e83d) service to localhost/127.0.0.1:54649 trying to claim ACTIVE state with txid=5
2016-09-12 17:14:41,433 INFO  datanode.DataNode (BPOfferService.java:updateActorStatesFromHeartbeat(519)) - Acknowledging ACTIVE Namenode Block pool BP-711728946-192.168.9.78-1473671678380 (Datanode Uuid 5c52fd0c-958e-484f-a303-2baee049e83d) service to localhost/127.0.0.1:54649
2016-09-12 17:14:41,436 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-03f0b071-e149-4371-b9e5-0864a9678930 node DatanodeRegistration(127.0.0.1:44134, datanodeUuid=5c52fd0c-958e-484f-a303-2baee049e83d, infoPort=52489, infoSecurePort=0, ipcPort=57523, storageInfo=lv=-56;cid=testClusterID;nsid=1416892211;c=0), blocks: 0, hasStaleStorage: true, processing time: 0 msecs
2016-09-12 17:14:41,436 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-e1c30477-0e1b-47e8-a1ae-a66aca25971c node DatanodeRegistration(127.0.0.1:44134, datanodeUuid=5c52fd0c-958e-484f-a303-2baee049e83d, infoPort=52489, infoSecurePort=0, ipcPort=57523, storageInfo=lv=-56;cid=testClusterID;nsid=1416892211;c=0), blocks: 0, hasStaleStorage: false, processing time: 0 msecs
2016-09-12 17:14:41,437 INFO  datanode.DataNode (BPServiceActor.java:blockReport(492)) - Successfully sent block report 0x3745e90b9e353,  containing 2 storage report(s), of which we sent 2. The reports had 0 total blocks and used 1 RPC(s). This took 0 msec to generate and 4 msecs for RPC and NN processing. Got back one command: FinalizeCommand/5.
2016-09-12 17:14:41,437 INFO  datanode.DataNode (BPOfferService.java:processCommandFromActive(690)) - Got finalize command for block pool BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:41,525 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2286)) - Cluster is active
2016-09-12 17:14:41,538 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/checkpoint.dat	dst=null	perm=null	proto=rpc
2016-09-12 17:14:41,553 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=delete	src=/checkpoint.dat	dst=null	perm=null	proto=rpc
2016-09-12 17:14:41,560 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/checkpoint2.dat	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:41,561 INFO  namenode.NameNode (NameNode.java:createNameNode(1419)) - createNameNode [-backup]
2016-09-12 17:14:41,562 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(159)) - BackupNode metrics system started (again)
2016-09-12 17:14:41,562 INFO  namenode.NameNode (NameNode.java:setClientNamenodeAddress(399)) - fs.defaultFS is hdfs://localhost:54649
2016-09-12 17:14:41,562 INFO  namenode.NameNode (NameNode.java:setClientNamenodeAddress(419)) - Clients are to use localhost:54649 to access this namenode/service.
2016-09-12 17:14:41,582 WARN  common.Util (Util.java:stringAsURI(56)) - Path /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/ should be specified as a URI in configuration files. Please update hdfs configuration.
2016-09-12 17:14:41,583 WARN  common.Util (Util.java:stringAsURI(56)) - Path /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/ should be specified as a URI in configuration files. Please update hdfs configuration.
2016-09-12 17:14:41,584 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(727)) - No KeyProvider found.
2016-09-12 17:14:41,584 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(737)) - fsLock is fair:true
2016-09-12 17:14:41,586 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(242)) - dfs.block.invalidate.limit=1000
2016-09-12 17:14:41,586 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(248)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2016-09-12 17:14:41,587 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(71)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2016-09-12 17:14:41,587 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(76)) - The block deletion will start around 2016 九月 12 17:14:41
2016-09-12 17:14:41,588 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map BlocksMap
2016-09-12 17:14:41,588 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:41,588 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 2.0% max memory 3.6 GB = 72.8 MB
2016-09-12 17:14:41,589 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^23 = 8388608 entries
2016-09-12 17:14:41,597 INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(365)) - dfs.block.access.token.enable=false
2016-09-12 17:14:41,598 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(350)) - defaultReplication         = 0
2016-09-12 17:14:41,598 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(351)) - maxReplication             = 512
2016-09-12 17:14:41,598 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(352)) - minReplication             = 1
2016-09-12 17:14:41,598 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(353)) - maxReplicationStreams      = 2
2016-09-12 17:14:41,599 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(354)) - shouldCheckForEnoughRacks  = false
2016-09-12 17:14:41,599 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(355)) - replicationRecheckInterval = 3000
2016-09-12 17:14:41,599 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(356)) - encryptDataTransfer        = false
2016-09-12 17:14:41,599 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(357)) - maxNumBlocksToLog          = 1000
2016-09-12 17:14:41,600 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(757)) - fsOwner             = root (auth:SIMPLE)
2016-09-12 17:14:41,600 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(758)) - supergroup          = supergroup
2016-09-12 17:14:41,600 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(759)) - isPermissionEnabled = true
2016-09-12 17:14:41,601 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(770)) - HA Enabled: false
2016-09-12 17:14:41,601 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(809)) - Append Enabled: true
2016-09-12 17:14:41,602 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map INodeMap
2016-09-12 17:14:41,603 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:41,603 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 1.0% max memory 3.6 GB = 36.4 MB
2016-09-12 17:14:41,604 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^22 = 4194304 entries
2016-09-12 17:14:41,608 INFO  namenode.FSDirectory (FSDirectory.java:<init>(235)) - ACLs enabled? false
2016-09-12 17:14:41,609 INFO  namenode.FSDirectory (FSDirectory.java:<init>(239)) - XAttrs enabled? true
2016-09-12 17:14:41,609 INFO  namenode.FSDirectory (FSDirectory.java:<init>(247)) - Maximum size of an xattr: 16384
2016-09-12 17:14:41,609 INFO  namenode.NameNode (FSDirectory.java:<init>(295)) - Caching file names occuring more than 10 times
2016-09-12 17:14:41,610 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map cachedBlocks
2016-09-12 17:14:41,610 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:41,611 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.25% max memory 3.6 GB = 9.1 MB
2016-09-12 17:14:41,611 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^20 = 1048576 entries
2016-09-12 17:14:41,612 WARN  namenode.FSNamesystem (FSNamesystem.java:<init>(5655)) - The threshold value should't be greater than 1, threshold: 1.5
2016-09-12 17:14:41,612 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5664)) - dfs.namenode.safemode.threshold-pct = 1.5
2016-09-12 17:14:41,612 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5665)) - dfs.namenode.safemode.min.datanodes = 0
2016-09-12 17:14:41,613 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5666)) - dfs.namenode.safemode.extension     = 2147483647
2016-09-12 17:14:41,613 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:41,614 INFO  metrics.TopMetrics (TopMetrics.java:logConf(65)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2016-09-12 17:14:41,614 INFO  metrics.TopMetrics (TopMetrics.java:logConf(67)) - NNTop conf: dfs.namenode.top.num.users = 10
2016-09-12 17:14:41,614 INFO  metrics.TopMetrics (TopMetrics.java:logConf(69)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2016-09-12 17:14:41,615 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(920)) - Retry cache on namenode is enabled
2016-09-12 17:14:41,615 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(928)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2016-09-12 17:14:41,615 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map NameNodeRetryCache
2016-09-12 17:14:41,615 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:41,616 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.029999999329447746% max memory 3.6 GB = 1.1 MB
2016-09-12 17:14:41,616 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^17 = 131072 entries
2016-09-12 17:14:41,640 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:41,642 INFO  namenode.NameNode (NameNodeRpcServer.java:<init>(342)) - RPC server is binding to localhost:0
2016-09-12 17:14:41,642 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:41,644 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 48651
2016-09-12 17:14:41,651 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(6536)) - Registered FSNamesystemState MBean
2016-09-12 17:14:41,651 WARN  common.Util (Util.java:stringAsURI(56)) - Path /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/ should be specified as a URI in configuration files. Please update hdfs configuration.
2016-09-12 17:14:41,661 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:41,661 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:41,662 INFO  hdfs.StateChange (FSNamesystem.java:leave(5739)) - STATE* Leaving safe mode after 0 secs
2016-09-12 17:14:41,662 INFO  hdfs.StateChange (FSNamesystem.java:leave(5751)) - STATE* Network topology has 0 racks and 0 datanodes
2016-09-12 17:14:41,663 INFO  hdfs.StateChange (FSNamesystem.java:leave(5754)) - STATE* UnderReplicatedBlocks has 0 blocks
2016-09-12 17:14:41,664 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:41,689 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1703)) - Starting Web-server for hdfs at: http://localhost:0
2016-09-12 17:14:41,692 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:41,693 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.namenode is not defined
2016-09-12 17:14:41,694 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:41,695 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hdfs
2016-09-12 17:14:41,696 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:41,696 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:41,698 INFO  http.HttpServer2 (NameNodeHttpServer.java:initWebHdfs(86)) - Added filter 'org.apache.hadoop.hdfs.web.AuthFilter' (class=org.apache.hadoop.hdfs.web.AuthFilter)
2016-09-12 17:14:41,698 INFO  http.HttpServer2 (HttpServer2.java:addJerseyResourcePackage(609)) - addJerseyResourcePackage: packageName=org.apache.hadoop.hdfs.server.namenode.web.resources;org.apache.hadoop.hdfs.web.resources, pathSpec=/webhdfs/v1/*
2016-09-12 17:14:41,701 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 59319
2016-09-12 17:14:41,702 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:41,721 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:59319
2016-09-12 17:14:41,722 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:41,722 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 48651: starting
2016-09-12 17:14:41,726 INFO  namenode.NameNode (NameNode.java:startCommonServices(697)) - Backup Node RPC up at: localhost/127.0.0.1:48651
2016-09-12 17:14:41,727 INFO  hdfs.StateChange (FSNamesystem.java:reportStatus(6007)) - STATE* Safe mode is ON. 
It was turned on manually. Use "hdfs dfsadmin -safemode leave" to turn safe mode off.
2016-09-12 17:14:41,728 INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(362)) - Recovering unfinalized segments in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current
2016-09-12 17:14:41,753 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000003 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000003-0000000000000000003
2016-09-12 17:14:41,756 INFO  namenode.FSEditLog (FSEditLog.java:registerBackupNode(1382)) - Registering new backup node: NamenodeRegistration(localhost:48651, role=Backup Node)
2016-09-12 17:14:41,758 INFO  namenode.Checkpointer (Checkpointer.java:initialize(108)) - Checkpoint Period : 3600 secs (60 min)
2016-09-12 17:14:41,758 INFO  namenode.Checkpointer (Checkpointer.java:initialize(111)) - Transactions count is  : 1, to trigger checkpoint
2016-09-12 17:14:41,758 INFO  namenode.FSNamesystem (FSNamesystem.java:startActiveServices(1123)) - Starting services required for active state
2016-09-12 17:14:41,761 INFO  namenode.FSNamesystem (FSNamesystem.java:startCheckpoint(6347)) - Start checkpoint for localhost:48651
2016-09-12 17:14:41,762 ERROR namenode.FSNamesystem (FSNamesystem.java:run(5190)) - Swallowing exception in NameNodeEditLogRoller:
java.lang.IllegalStateException: Bad state: BETWEEN_LOG_SEGMENTS
	at com.google.common.base.Preconditions.checkState(Preconditions.java:172)
	at org.apache.hadoop.hdfs.server.namenode.FSEditLog.getCurSegmentTxId(FSEditLog.java:515)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem$NameNodeEditLogRoller.run(FSNamesystem.java:5181)
	at java.lang.Thread.run(Thread.java:745)
2016-09-12 17:14:41,761 INFO  namenode.TestBackupNode (TestBackupNode.java:waitCheckpointDone(115)) - Waiting checkpoint to complete... checkpoint txid should increase above 6
2016-09-12 17:14:41,762 INFO  namenode.FSImage (FSImage.java:startCheckpoint(1333)) - Start checkpoint at txid 6
2016-09-12 17:14:41,763 INFO  namenode.FSEditLog (FSEditLog.java:rollEditLog(1202)) - Rolling edit logs
2016-09-12 17:14:41,763 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 5
2016-09-12 17:14:41,766 INFO  blockmanagement.CacheReplicationMonitor (CacheReplicationMonitor.java:run(160)) - Starting CacheReplicationMonitor with interval 30000 milliseconds
2016-09-12 17:14:41,769 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 3 Total time for transactions(ms): 3 Number of transactions batched in Syncs: 0 Number of syncs: 4 SyncTimes(ms): 5 3 
2016-09-12 17:14:41,771 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000005 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:41,772 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000005 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:41,773 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 8
2016-09-12 17:14:41,803 INFO  namenode.FSImage (BackupImage.java:namenodeStartedLogSegment(350)) - NameNode started a new log segment at txid 8
2016-09-12 17:14:41,804 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 8
2016-09-12 17:14:41,808 DEBUG namenode.FSImage (BackupImage.java:setState(338)) - State transition DROP_UNTIL_NEXT_ROLL -> JOURNAL_ONLY
2016-09-12 17:14:41,811 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 8; numTxns = 1
2016-09-12 17:14:41,901 DEBUG namenode.Checkpointer (Checkpointer.java:doCheckpoint(211)) - Doing checkpoint. Last applied: 0
2016-09-12 17:14:41,907 INFO  namenode.TransferFsImage (TransferFsImage.java:downloadEditsToStorage(154)) - Skipping download of remote edit log [1,2] since it already is stored locally at /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000001-0000000000000000002
2016-09-12 17:14:41,908 INFO  namenode.TransferFsImage (TransferFsImage.java:getFileClient(396)) - Opening connection to http://localhost:53902/imagetransfer?getedit=1&startTxId=3&endTxId=4&storageInfo=-63:1416892211:0:testClusterID
2016-09-12 17:14:41,948 INFO  namenode.TransferFsImage (TransferFsImage.java:receiveFile(553)) - Transfer took 0.03s at 0.00 KB/s
2016-09-12 17:14:41,948 INFO  namenode.TransferFsImage (TransferFsImage.java:downloadEditsToStorage(168)) - Downloaded file edits_tmp_0000000000000000003-0000000000000000004_0000000000972374908 size 0 bytes.
2016-09-12 17:14:41,949 INFO  namenode.TransferFsImage (TransferFsImage.java:getFileClient(396)) - Opening connection to http://localhost:53902/imagetransfer?getedit=1&startTxId=5&endTxId=7&storageInfo=-63:1416892211:0:testClusterID
2016-09-12 17:14:41,972 INFO  namenode.TransferFsImage (TransferFsImage.java:receiveFile(553)) - Transfer took 0.02s at 0.00 KB/s
2016-09-12 17:14:41,972 INFO  namenode.TransferFsImage (TransferFsImage.java:downloadEditsToStorage(168)) - Downloaded file edits_tmp_0000000000000000005-0000000000000000007_0000000000972374949 size 0 bytes.
2016-09-12 17:14:41,973 INFO  namenode.Checkpointer (Checkpointer.java:rollForwardByApplyingLogs(309)) - Checkpointer about to load edits from 3 stream(s).
2016-09-12 17:14:41,974 DEBUG namenode.FSImage (FSImage.java:loadEdits(834)) - About to load edits:
  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000001-0000000000000000002
  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000003-0000000000000000004
  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:41,974 INFO  namenode.FSImage (FSImage.java:loadEdits(844)) - Reading /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000001-0000000000000000002 expecting start txid #1
2016-09-12 17:14:41,974 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000001-0000000000000000002
2016-09-12 17:14:41,975 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_END_LOG_SEGMENT=1
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:41,975 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000001-0000000000000000002 of size 42 edits # 2 loaded in 0 seconds
2016-09-12 17:14:41,975 INFO  namenode.FSImage (FSImage.java:loadEdits(844)) - Reading /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000003-0000000000000000004 expecting start txid #3
2016-09-12 17:14:41,976 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000003-0000000000000000004
2016-09-12 17:14:41,976 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_END_LOG_SEGMENT=1
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:41,977 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000003-0000000000000000004 of size 42 edits # 2 loaded in 0 seconds
2016-09-12 17:14:41,977 INFO  namenode.FSImage (FSImage.java:loadEdits(844)) - Reading /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000005-0000000000000000007 expecting start txid #5
2016-09-12 17:14:41,977 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:41,979 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_DELETE=1
  OP_END_LOG_SEGMENT=1
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:41,979 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000005-0000000000000000007 of size 106 edits # 3 loaded in 0 seconds
2016-09-12 17:14:41,980 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2016-09-12 17:14:42,024 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/fsimage.ckpt_0000000000000000007 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/fsimage_0000000000000000007
2016-09-12 17:14:42,025 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 2
2016-09-12 17:14:42,060 INFO  namenode.TransferFsImage (TransferFsImage.java:receiveFile(553)) - Transfer took 0.02s at 0.00 KB/s
2016-09-12 17:14:42,061 INFO  namenode.TransferFsImage (TransferFsImage.java:handleUploadImageRequest(134)) - Downloaded file fsimage.ckpt_0000000000000000007 size 351 bytes.
2016-09-12 17:14:42,096 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage.ckpt_0000000000000000007 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000007
2016-09-12 17:14:42,097 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage.ckpt_0000000000000000007 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000007
2016-09-12 17:14:42,098 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 4
2016-09-12 17:14:42,099 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000002, cpktTxId=0000000000000000002)
2016-09-12 17:14:42,099 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000002, cpktTxId=0000000000000000002)
2016-09-12 17:14:42,104 INFO  namenode.TransferFsImage (TransferFsImage.java:uploadImageFromStorage(237)) - Uploaded image with txid 7 to namenode at http://localhost:53902 in 0.072 seconds
2016-09-12 17:14:42,106 INFO  namenode.FSNamesystem (FSNamesystem.java:endCheckpoint(6375)) - End checkpoint for localhost:48651
2016-09-12 17:14:42,106 INFO  namenode.FSImage (FSImage.java:endCheckpoint(1373)) - End checkpoint at txid 8
2016-09-12 17:14:42,134 INFO  namenode.FSImage (BackupImage.java:tryConvergeJournalSpool(314)) - Going to finish converging with remaining 1 txns from in-progress stream org.apache.hadoop.hdfs.server.namenode.RedundantEditLogInputStream@65ef58d7
2016-09-12 17:14:42,135 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000008
2016-09-12 17:14:42,135 INFO  namenode.EditLogInputStream (RedundantEditLogInputStream.java:nextOp(176)) - Fast-forwarding stream '/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000008' to transaction ID 8
2016-09-12 17:14:42,139 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:42,139 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000008 of size 1048576 edits # 1 loaded in 0 seconds
2016-09-12 17:14:42,140 INFO  namenode.FSImage (BackupImage.java:tryConvergeJournalSpool(326)) - Successfully synced BackupNode with NameNode at txnid 8
2016-09-12 17:14:42,140 DEBUG namenode.FSImage (BackupImage.java:setState(338)) - State transition JOURNAL_ONLY -> IN_SYNC
2016-09-12 17:14:42,140 INFO  namenode.Checkpointer (Checkpointer.java:doCheckpoint(278)) - Checkpoint completed in 0 seconds. New Image Size: 351
2016-09-12 17:14:42,763 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(462)) - examining name dir with files: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000007,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000007.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000003-0000000000000000004,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000001-0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000004.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/VERSION,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000008,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000004,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/seen_txid,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:42,764 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(465)) - Examining storage dir /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current with contents: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000007, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000007.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000003-0000000000000000004, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000001-0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000004.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/VERSION, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000008, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000004, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/seen_txid, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:42,765 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(462)) - examining name dir with files: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000007,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000007.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000003-0000000000000000004,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000001-0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000004.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/VERSION,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000008,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000004,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/seen_txid,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:42,765 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(465)) - Examining storage dir /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current with contents: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000007, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000007.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000003-0000000000000000004, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000001-0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000004.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/VERSION, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000008, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000004, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/seen_txid, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:42,769 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/user/root/file_0	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:42,773 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/user/root/file_1	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:42,777 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/user/root/file_2	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:42,780 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/user/root/file_3	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:42,783 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/user/root/file_4	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:42,786 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/user/root/file_5	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:42,789 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/user/root/file_6	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:42,792 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/user/root/file_7	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:42,795 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/user/root/file_8	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:42,800 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/user/root/file_9	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:42,803 INFO  namenode.FSNamesystem (FSNamesystem.java:startCheckpoint(6347)) - Start checkpoint for localhost:48651
2016-09-12 17:14:42,803 INFO  namenode.FSImage (FSImage.java:startCheckpoint(1333)) - Start checkpoint at txid 8
2016-09-12 17:14:42,803 INFO  namenode.FSEditLog (FSEditLog.java:rollEditLog(1202)) - Rolling edit logs
2016-09-12 17:14:42,803 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 8
2016-09-12 17:14:42,805 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 9; numTxns = 1
2016-09-12 17:14:42,806 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:170000000c000000000000000959e8adb0
2016-09-12 17:14:42,807 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_END_LOG_SEGMENT=1
2016-09-12 17:14:42,808 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 2 Total time for transactions(ms): 1 Number of transactions batched in Syncs: 1 Number of syncs: 3 SyncTimes(ms): 3 3 7 
2016-09-12 17:14:42,809 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000008 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000008-0000000000000000009
2016-09-12 17:14:42,811 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000008 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000008-0000000000000000009
2016-09-12 17:14:42,811 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 10
2016-09-12 17:14:42,840 INFO  namenode.FSImage (BackupImage.java:namenodeStartedLogSegment(350)) - NameNode started a new log segment at txid 10
2016-09-12 17:14:42,841 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 8
2016-09-12 17:14:42,841 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 2 Total time for transactions(ms): 0 Number of transactions batched in Syncs: 0 Number of syncs: 3 SyncTimes(ms): 4 
2016-09-12 17:14:42,842 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000008 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000008-0000000000000000009
2016-09-12 17:14:42,842 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 10
2016-09-12 17:14:42,846 INFO  namenode.FSImage (BackupImage.java:namenodeStartedLogSegment(376)) - Stopped applying edits to prepare for checkpoint.
2016-09-12 17:14:42,846 DEBUG namenode.FSImage (BackupImage.java:setState(338)) - State transition IN_SYNC -> JOURNAL_ONLY
2016-09-12 17:14:42,849 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 10; numTxns = 1
2016-09-12 17:14:43,022 DEBUG namenode.Checkpointer (Checkpointer.java:doCheckpoint(211)) - Doing checkpoint. Last applied: 9
2016-09-12 17:14:43,073 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/fsimage.ckpt_0000000000000000009 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/fsimage_0000000000000000009
2016-09-12 17:14:43,075 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 7
2016-09-12 17:14:43,075 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/fsimage_0000000000000000002, cpktTxId=0000000000000000002)
2016-09-12 17:14:43,113 INFO  namenode.TransferFsImage (TransferFsImage.java:receiveFile(553)) - Transfer took 0.02s at 0.00 KB/s
2016-09-12 17:14:43,114 INFO  namenode.TransferFsImage (TransferFsImage.java:handleUploadImageRequest(134)) - Downloaded file fsimage.ckpt_0000000000000000009 size 351 bytes.
2016-09-12 17:14:43,158 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage.ckpt_0000000000000000009 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000009
2016-09-12 17:14:43,158 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage.ckpt_0000000000000000009 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000009
2016-09-12 17:14:43,160 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 7
2016-09-12 17:14:43,160 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000004, cpktTxId=0000000000000000004)
2016-09-12 17:14:43,161 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000004, cpktTxId=0000000000000000004)
2016-09-12 17:14:43,166 INFO  namenode.TransferFsImage (TransferFsImage.java:uploadImageFromStorage(237)) - Uploaded image with txid 9 to namenode at http://localhost:53902 in 0.083 seconds
2016-09-12 17:14:43,168 INFO  namenode.FSNamesystem (FSNamesystem.java:endCheckpoint(6375)) - End checkpoint for localhost:48651
2016-09-12 17:14:43,168 INFO  namenode.FSImage (FSImage.java:endCheckpoint(1373)) - End checkpoint at txid 10
2016-09-12 17:14:43,186 INFO  namenode.FSImage (BackupImage.java:tryConvergeJournalSpool(314)) - Going to finish converging with remaining 1 txns from in-progress stream org.apache.hadoop.hdfs.server.namenode.RedundantEditLogInputStream@e0928ee
2016-09-12 17:14:43,187 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000010
2016-09-12 17:14:43,187 INFO  namenode.EditLogInputStream (RedundantEditLogInputStream.java:nextOp(176)) - Fast-forwarding stream '/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000010' to transaction ID 10
2016-09-12 17:14:43,190 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:43,190 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000010 of size 1048576 edits # 1 loaded in 0 seconds
2016-09-12 17:14:43,190 INFO  namenode.FSImage (BackupImage.java:tryConvergeJournalSpool(326)) - Successfully synced BackupNode with NameNode at txnid 10
2016-09-12 17:14:43,191 DEBUG namenode.FSImage (BackupImage.java:setState(338)) - State transition JOURNAL_ONLY -> IN_SYNC
2016-09-12 17:14:43,191 INFO  namenode.Checkpointer (Checkpointer.java:doCheckpoint(278)) - Checkpoint completed in 0 seconds. New Image Size: 351
2016-09-12 17:14:43,191 INFO  namenode.TestBackupNode (TestBackupNode.java:waitCheckpointDone(115)) - Waiting checkpoint to complete... checkpoint txid should increase above 8
2016-09-12 17:14:44,192 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(462)) - examining name dir with files: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000007,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000009,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000007.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000003-0000000000000000004,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000001-0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/VERSION,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000009.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000008-0000000000000000009,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/seen_txid,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000010,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:44,193 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(465)) - Examining storage dir /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current with contents: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000007, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000009, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000007.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000003-0000000000000000004, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000001-0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/VERSION, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000009.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000008-0000000000000000009, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/seen_txid, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000010, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:44,194 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(462)) - examining name dir with files: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000007,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000009,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000007.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000003-0000000000000000004,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000001-0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/VERSION,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000009.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000008-0000000000000000009,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/seen_txid,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000010,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:44,194 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(465)) - Examining storage dir /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current with contents: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000007, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000009, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000007.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000003-0000000000000000004, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000001-0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/VERSION, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000009.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000008-0000000000000000009, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/seen_txid, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000010, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:44,196 INFO  namenode.FSNamesystem (FSNamesystem.java:startCheckpoint(6347)) - Start checkpoint for localhost:48651
2016-09-12 17:14:44,197 INFO  namenode.FSImage (FSImage.java:startCheckpoint(1333)) - Start checkpoint at txid 10
2016-09-12 17:14:44,198 INFO  namenode.FSEditLog (FSEditLog.java:rollEditLog(1202)) - Rolling edit logs
2016-09-12 17:14:44,198 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 10
2016-09-12 17:14:44,201 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 11; numTxns = 1
2016-09-12 17:14:44,203 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:170000000c000000000000000bb7e6cc9c
2016-09-12 17:14:44,204 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_END_LOG_SEGMENT=1
2016-09-12 17:14:44,205 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 2 Total time for transactions(ms): 2 Number of transactions batched in Syncs: 1 Number of syncs: 3 SyncTimes(ms): 2 3 10 
2016-09-12 17:14:44,207 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000010 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000010-0000000000000000011
2016-09-12 17:14:44,208 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000010 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000010-0000000000000000011
2016-09-12 17:14:44,208 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 12
2016-09-12 17:14:44,234 INFO  namenode.FSImage (BackupImage.java:namenodeStartedLogSegment(350)) - NameNode started a new log segment at txid 12
2016-09-12 17:14:44,235 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 10
2016-09-12 17:14:44,235 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 2 Total time for transactions(ms): 1 Number of transactions batched in Syncs: 0 Number of syncs: 3 SyncTimes(ms): 4 
2016-09-12 17:14:44,237 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000010 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000010-0000000000000000011
2016-09-12 17:14:44,237 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 12
2016-09-12 17:14:44,241 INFO  namenode.FSImage (BackupImage.java:namenodeStartedLogSegment(376)) - Stopped applying edits to prepare for checkpoint.
2016-09-12 17:14:44,241 DEBUG namenode.FSImage (BackupImage.java:setState(338)) - State transition IN_SYNC -> JOURNAL_ONLY
2016-09-12 17:14:44,244 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 12; numTxns = 1
2016-09-12 17:14:44,354 DEBUG namenode.Checkpointer (Checkpointer.java:doCheckpoint(211)) - Doing checkpoint. Last applied: 11
2016-09-12 17:14:44,398 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/fsimage.ckpt_0000000000000000011 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/fsimage_0000000000000000011
2016-09-12 17:14:44,399 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 9
2016-09-12 17:14:44,400 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/fsimage_0000000000000000007, cpktTxId=0000000000000000007)
2016-09-12 17:14:44,434 INFO  namenode.TransferFsImage (TransferFsImage.java:receiveFile(553)) - Transfer took 0.02s at 0.00 KB/s
2016-09-12 17:14:44,434 INFO  namenode.TransferFsImage (TransferFsImage.java:handleUploadImageRequest(134)) - Downloaded file fsimage.ckpt_0000000000000000011 size 351 bytes.
2016-09-12 17:14:44,470 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage.ckpt_0000000000000000011 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000011
2016-09-12 17:14:44,471 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage.ckpt_0000000000000000011 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000011
2016-09-12 17:14:44,472 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 9
2016-09-12 17:14:44,473 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000007, cpktTxId=0000000000000000007)
2016-09-12 17:14:44,474 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000007, cpktTxId=0000000000000000007)
2016-09-12 17:14:44,479 INFO  namenode.TransferFsImage (TransferFsImage.java:uploadImageFromStorage(237)) - Uploaded image with txid 11 to namenode at http://localhost:53902 in 0.069 seconds
2016-09-12 17:14:44,481 INFO  namenode.FSNamesystem (FSNamesystem.java:endCheckpoint(6375)) - End checkpoint for localhost:48651
2016-09-12 17:14:44,481 INFO  namenode.FSImage (FSImage.java:endCheckpoint(1373)) - End checkpoint at txid 12
2016-09-12 17:14:44,499 INFO  namenode.FSImage (BackupImage.java:tryConvergeJournalSpool(314)) - Going to finish converging with remaining 1 txns from in-progress stream org.apache.hadoop.hdfs.server.namenode.RedundantEditLogInputStream@360ea8b3
2016-09-12 17:14:44,499 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000012
2016-09-12 17:14:44,500 INFO  namenode.EditLogInputStream (RedundantEditLogInputStream.java:nextOp(176)) - Fast-forwarding stream '/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000012' to transaction ID 12
2016-09-12 17:14:44,502 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:44,503 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000012 of size 1048576 edits # 1 loaded in 0 seconds
2016-09-12 17:14:44,503 INFO  namenode.FSImage (BackupImage.java:tryConvergeJournalSpool(326)) - Successfully synced BackupNode with NameNode at txnid 12
2016-09-12 17:14:44,503 DEBUG namenode.FSImage (BackupImage.java:setState(338)) - State transition JOURNAL_ONLY -> IN_SYNC
2016-09-12 17:14:44,504 INFO  namenode.Checkpointer (Checkpointer.java:doCheckpoint(278)) - Checkpoint completed in 0 seconds. New Image Size: 351
2016-09-12 17:14:44,504 INFO  namenode.TestBackupNode (TestBackupNode.java:waitCheckpointDone(115)) - Waiting checkpoint to complete... checkpoint txid should increase above 10
2016-09-12 17:14:45,505 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(462)) - examining name dir with files: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000011.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000009,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000003-0000000000000000004,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000001-0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000011,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/VERSION,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000009.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000008-0000000000000000009,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000012,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/seen_txid,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000005-0000000000000000007,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000010-0000000000000000011
2016-09-12 17:14:45,506 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(465)) - Examining storage dir /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current with contents: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000011.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000009, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000003-0000000000000000004, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000001-0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000011, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/VERSION, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000009.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000008-0000000000000000009, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000012, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/seen_txid, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000005-0000000000000000007, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000010-0000000000000000011
2016-09-12 17:14:45,507 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(462)) - examining name dir with files: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000011.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000009,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000003-0000000000000000004,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000001-0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000011,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/VERSION,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000009.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000008-0000000000000000009,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000012,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/seen_txid,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000005-0000000000000000007,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000010-0000000000000000011
2016-09-12 17:14:45,507 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(465)) - Examining storage dir /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current with contents: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000011.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000009, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000003-0000000000000000004, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000001-0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000011, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/VERSION, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000009.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000008-0000000000000000009, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000012, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/seen_txid, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000005-0000000000000000007, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000010-0000000000000000011
2016-09-12 17:14:45,536 INFO  ipc.Server (Server.java:run(2063)) - IPC Server handler 7 on 48651, call org.apache.hadoop.hdfs.protocol.ClientProtocol.create from 127.0.0.1:39627 Call#116 Retry#0: org.apache.hadoop.ipc.StandbyException: Operation category WRITE is not supported at Backup Node
2016-09-12 17:14:45,545 INFO  namenode.TestBackupNode (TestBackupNode.java:testCheckpoint(357)) - Write to Backup Node failed as expected: 
org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.ipc.StandbyException): Operation category WRITE is not supported at Backup Node
	at org.apache.hadoop.hdfs.server.namenode.BackupNode$BNHAContext.checkOperation(BackupNode.java:442)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.checkOperation(FSNamesystem.java:1333)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.startFileInt(FSNamesystem.java:2596)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.startFile(FSNamesystem.java:2552)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.create(NameNodeRpcServer.java:623)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.create(ClientNamenodeProtocolServerSideTranslatorPB.java:397)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:616)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:969)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2049)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2045)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1657)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2043)

	at org.apache.hadoop.ipc.Client.call(Client.java:1476)
	at org.apache.hadoop.ipc.Client.call(Client.java:1407)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:229)
	at com.sun.proxy.$Proxy15.create(Unknown Source)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.create(ClientNamenodeProtocolTranslatorPB.java:296)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:187)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:102)
	at com.sun.proxy.$Proxy16.create(Unknown Source)
	at org.apache.hadoop.hdfs.DFSOutputStream.newStreamForCreate(DFSOutputStream.java:1623)
	at org.apache.hadoop.hdfs.DFSClient.create(DFSClient.java:1703)
	at org.apache.hadoop.hdfs.DFSClient.create(DFSClient.java:1638)
	at org.apache.hadoop.hdfs.DistributedFileSystem$7.doCall(DistributedFileSystem.java:448)
	at org.apache.hadoop.hdfs.DistributedFileSystem$7.doCall(DistributedFileSystem.java:444)
	at org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)
	at org.apache.hadoop.hdfs.DistributedFileSystem.create(DistributedFileSystem.java:444)
	at org.apache.hadoop.hdfs.DistributedFileSystem.create(DistributedFileSystem.java:387)
	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:909)
	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:890)
	at org.apache.hadoop.hdfs.server.namenode.TestCheckpoint.writeFile(TestCheckpoint.java:143)
	at org.apache.hadoop.hdfs.server.namenode.TestBackupNode.testCheckpoint(TestBackupNode.java:355)
	at org.apache.hadoop.hdfs.server.namenode.TestBackupNode.testBackupNode(TestBackupNode.java:259)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:264)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:153)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:200)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:153)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:103)
2016-09-12 17:14:45,549 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/checkpoint2.dat	dst=null	perm=null	proto=rpc
2016-09-12 17:14:45,557 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 13; numTxns = 1
2016-09-12 17:14:45,567 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:0000000095000000000000000d0000000000000000000b2f6261636b75702e64617400030000000000000000000001571dad65b100000000080000000000000004726f6f740001a400000000000024444653436c69656e745f4e4f4e4d41505245445543455f2d313937353134343136395f3100093132372e302e302e3101000010d2d611c6a86c409fb5e1c603e3d1375000000076f2895500
2016-09-12 17:14:45,569 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
2016-09-12 17:14:45,571 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/backup.dat	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:45,591 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_-1975144169_1 to complete inode 688171(/backup.dat) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:45,594 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 14; numTxns = 1
2016-09-12 17:14:45,599 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:0900000043000000000000000e0000000000000000000b2f6261636b75702e646174000100000000000000000000000000000000000000000000000100000000000001a4a8f8fb38
2016-09-12 17:14:45,600 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_CLOSE=1
2016-09-12 17:14:45,601 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /backup.dat is closed by DFSClient_NONMAPREDUCE_-1975144169_1
2016-09-12 17:14:45,604 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/backup.dat	dst=null	perm=null	proto=rpc
2016-09-12 17:14:45,606 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/backup.dat	dst=null	perm=null	proto=rpc
2016-09-12 17:14:45,609 INFO  namenode.NameNode (NameNodeRpcServer.java:errorReport(501)) - Error report from NamenodeRegistration(localhost:48651, role=Backup Node): Shutting down.
2016-09-12 17:14:45,609 INFO  namenode.FSEditLog (FSEditLog.java:releaseBackupStream(1393)) - Removing backup journal BackupJournalManager
SEEEEEEEEEEEEEEEEEEEEETcheckpointManager null
2016-09-12 17:14:45,611 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:45,611 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5196)) - NameNodeEditLogRoller was interrupted, exiting
2016-09-12 17:14:45,612 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5269)) - LazyPersistFileScrubber was interrupted, exiting
2016-09-12 17:14:45,612 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 48651
2016-09-12 17:14:45,615 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 48651
2016-09-12 17:14:45,615 INFO  blockmanagement.BlockManager (BlockManager.java:run(3636)) - Stopping ReplicationMonitor.
2016-09-12 17:14:45,615 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:45,626 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:45,626 INFO  namenode.FSNamesystem (FSNamesystem.java:stopStandbyServices(1317)) - Stopping services started for standby state
2016-09-12 17:14:45,631 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:45,737 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdown(1712)) - Shutting down the Mini HDFS Cluster
2016-09-12 17:14:45,738 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdownDataNodes(1744)) - Shutting down DataNode 2
2016-09-12 17:14:45,738 WARN  datanode.DirectoryScanner (DirectoryScanner.java:shutdown(378)) - DirectoryScanner: shutdown has been called
2016-09-12 17:14:45,757 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:45,858 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 57523
2016-09-12 17:14:45,860 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 57523
2016-09-12 17:14:45,860 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:45,860 WARN  datanode.DataNode (BPServiceActor.java:offerService(704)) - BPOfferService for Block pool BP-711728946-192.168.9.78-1473671678380 (Datanode Uuid 5c52fd0c-958e-484f-a303-2baee049e83d) service to localhost/127.0.0.1:54649 interrupted
2016-09-12 17:14:45,861 WARN  datanode.DataNode (BPServiceActor.java:run(834)) - Ending block pool service for: Block pool BP-711728946-192.168.9.78-1473671678380 (Datanode Uuid 5c52fd0c-958e-484f-a303-2baee049e83d) service to localhost/127.0.0.1:54649
2016-09-12 17:14:45,862 INFO  datanode.DataNode (BlockPoolManager.java:remove(103)) - Removed Block pool BP-711728946-192.168.9.78-1473671678380 (Datanode Uuid 5c52fd0c-958e-484f-a303-2baee049e83d)
2016-09-12 17:14:45,862 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:shutdownBlockPool(2484)) - Removing block pool BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:45,864 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:run(2955)) - LazyWriter was interrupted, exiting
2016-09-12 17:14:45,865 INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(184)) - Shutting down all async disk service threads
2016-09-12 17:14:45,865 INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(192)) - All async disk service threads have been shut down
2016-09-12 17:14:45,866 INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(162)) - Shutting down all async lazy persist service threads
2016-09-12 17:14:45,867 INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(169)) - All async lazy persist service threads have been shut down
2016-09-12 17:14:45,869 INFO  datanode.DataNode (DataNode.java:shutdown(1827)) - Shutdown complete.
2016-09-12 17:14:45,869 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdownDataNodes(1744)) - Shutting down DataNode 1
2016-09-12 17:14:45,869 WARN  datanode.DirectoryScanner (DirectoryScanner.java:shutdown(378)) - DirectoryScanner: shutdown has been called
2016-09-12 17:14:45,877 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:45,978 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 32945
2016-09-12 17:14:45,980 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 32945
2016-09-12 17:14:45,980 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:45,980 WARN  datanode.DataNode (BPServiceActor.java:offerService(704)) - BPOfferService for Block pool BP-711728946-192.168.9.78-1473671678380 (Datanode Uuid 88b6b7ce-9646-4f1c-9ebe-502065661187) service to localhost/127.0.0.1:54649 interrupted
2016-09-12 17:14:45,981 WARN  datanode.DataNode (BPServiceActor.java:run(834)) - Ending block pool service for: Block pool BP-711728946-192.168.9.78-1473671678380 (Datanode Uuid 88b6b7ce-9646-4f1c-9ebe-502065661187) service to localhost/127.0.0.1:54649
2016-09-12 17:14:45,981 INFO  datanode.DataNode (BlockPoolManager.java:remove(103)) - Removed Block pool BP-711728946-192.168.9.78-1473671678380 (Datanode Uuid 88b6b7ce-9646-4f1c-9ebe-502065661187)
2016-09-12 17:14:45,981 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:shutdownBlockPool(2484)) - Removing block pool BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:45,984 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:run(2955)) - LazyWriter was interrupted, exiting
2016-09-12 17:14:45,985 INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(184)) - Shutting down all async disk service threads
2016-09-12 17:14:45,985 INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(192)) - All async disk service threads have been shut down
2016-09-12 17:14:45,986 INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(162)) - Shutting down all async lazy persist service threads
2016-09-12 17:14:45,986 INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(169)) - All async lazy persist service threads have been shut down
2016-09-12 17:14:45,987 INFO  datanode.DataNode (DataNode.java:shutdown(1827)) - Shutdown complete.
2016-09-12 17:14:45,987 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdownDataNodes(1744)) - Shutting down DataNode 0
2016-09-12 17:14:45,987 WARN  datanode.DirectoryScanner (DirectoryScanner.java:shutdown(378)) - DirectoryScanner: shutdown has been called
2016-09-12 17:14:45,994 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:46,095 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 52069
2016-09-12 17:14:46,097 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:46,097 WARN  datanode.DataNode (BPServiceActor.java:offerService(704)) - BPOfferService for Block pool BP-711728946-192.168.9.78-1473671678380 (Datanode Uuid 129095f6-8c4c-4b93-b7b3-2c988ea50f76) service to localhost/127.0.0.1:54649 interrupted
2016-09-12 17:14:46,097 WARN  datanode.DataNode (BPServiceActor.java:run(834)) - Ending block pool service for: Block pool BP-711728946-192.168.9.78-1473671678380 (Datanode Uuid 129095f6-8c4c-4b93-b7b3-2c988ea50f76) service to localhost/127.0.0.1:54649
2016-09-12 17:14:46,098 INFO  datanode.DataNode (BlockPoolManager.java:remove(103)) - Removed Block pool BP-711728946-192.168.9.78-1473671678380 (Datanode Uuid 129095f6-8c4c-4b93-b7b3-2c988ea50f76)
2016-09-12 17:14:46,098 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:shutdownBlockPool(2484)) - Removing block pool BP-711728946-192.168.9.78-1473671678380
2016-09-12 17:14:46,099 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 52069
2016-09-12 17:14:46,100 INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(184)) - Shutting down all async disk service threads
2016-09-12 17:14:46,101 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:run(2955)) - LazyWriter was interrupted, exiting
2016-09-12 17:14:46,101 INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(192)) - All async disk service threads have been shut down
2016-09-12 17:14:46,102 INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(162)) - Shutting down all async lazy persist service threads
2016-09-12 17:14:46,102 INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(169)) - All async lazy persist service threads have been shut down
2016-09-12 17:14:46,102 INFO  datanode.DataNode (DataNode.java:shutdown(1827)) - Shutdown complete.
2016-09-12 17:14:46,103 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:46,103 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 12
2016-09-12 17:14:46,103 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5196)) - NameNodeEditLogRoller was interrupted, exiting
2016-09-12 17:14:46,103 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5269)) - LazyPersistFileScrubber was interrupted, exiting
2016-09-12 17:14:46,104 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 4 Total time for transactions(ms): 4 Number of transactions batched in Syncs: 1 Number of syncs: 5 SyncTimes(ms): 3 3 
2016-09-12 17:14:46,105 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000012 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000012-0000000000000000015
2016-09-12 17:14:46,107 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000012 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000012-0000000000000000015
2016-09-12 17:14:46,108 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 54649
2016-09-12 17:14:46,110 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 54649
2016-09-12 17:14:46,111 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:46,111 INFO  blockmanagement.BlockManager (BlockManager.java:run(3636)) - Stopping ReplicationMonitor.
2016-09-12 17:14:46,121 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:46,122 INFO  namenode.FSNamesystem (FSNamesystem.java:stopStandbyServices(1317)) - Stopping services started for standby state
2016-09-12 17:14:46,131 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:46,231 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(211)) - Stopping BackupNode metrics system...
2016-09-12 17:14:46,234 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(217)) - BackupNode metrics system stopped.
2016-09-12 17:14:46,235 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:shutdown(606)) - BackupNode metrics system shutdown complete.
2016-09-12 17:14:46,245 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:<init>(446)) - starting cluster: numNameNodes=1, numDataNodes=0
2016-09-12 17:14:46,247 INFO  namenode.NameNode (NameNode.java:createNameNode(1419)) - createNameNode []
2016-09-12 17:14:46,249 WARN  impl.MetricsConfig (MetricsConfig.java:loadFirst(125)) - Cannot locate configuration: tried hadoop-metrics2-namenode.properties,hadoop-metrics2.properties
2016-09-12 17:14:46,253 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:startTimer(377)) - Scheduled snapshot period at 10 second(s).
2016-09-12 17:14:46,253 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:start(192)) - NameNode metrics system started
2016-09-12 17:14:46,254 INFO  namenode.NameNode (NameNode.java:setClientNamenodeAddress(399)) - fs.defaultFS is hdfs://127.0.0.1:0
2016-09-12 17:14:46,267 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1703)) - Starting Web-server for hdfs at: http://localhost:0
2016-09-12 17:14:46,269 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:46,270 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.namenode is not defined
2016-09-12 17:14:46,272 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:46,272 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hdfs
2016-09-12 17:14:46,273 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:46,273 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:46,275 INFO  http.HttpServer2 (NameNodeHttpServer.java:initWebHdfs(86)) - Added filter 'org.apache.hadoop.hdfs.web.AuthFilter' (class=org.apache.hadoop.hdfs.web.AuthFilter)
2016-09-12 17:14:46,275 INFO  http.HttpServer2 (HttpServer2.java:addJerseyResourcePackage(609)) - addJerseyResourcePackage: packageName=org.apache.hadoop.hdfs.server.namenode.web.resources;org.apache.hadoop.hdfs.web.resources, pathSpec=/webhdfs/v1/*
2016-09-12 17:14:46,278 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 60122
2016-09-12 17:14:46,278 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:46,353 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:60122
2016-09-12 17:14:46,356 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(727)) - No KeyProvider found.
2016-09-12 17:14:46,356 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(737)) - fsLock is fair:true
2016-09-12 17:14:46,358 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(242)) - dfs.block.invalidate.limit=1000
2016-09-12 17:14:46,358 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(248)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2016-09-12 17:14:46,359 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(71)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2016-09-12 17:14:46,359 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(76)) - The block deletion will start around 2016 九月 12 17:14:46
2016-09-12 17:14:46,360 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map BlocksMap
2016-09-12 17:14:46,360 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:46,360 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 2.0% max memory 3.6 GB = 72.8 MB
2016-09-12 17:14:46,361 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^23 = 8388608 entries
2016-09-12 17:14:46,428 INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(365)) - dfs.block.access.token.enable=false
2016-09-12 17:14:46,428 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(350)) - defaultReplication         = 0
2016-09-12 17:14:46,429 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(351)) - maxReplication             = 512
2016-09-12 17:14:46,429 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(352)) - minReplication             = 1
2016-09-12 17:14:46,429 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(353)) - maxReplicationStreams      = 2
2016-09-12 17:14:46,429 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(354)) - shouldCheckForEnoughRacks  = false
2016-09-12 17:14:46,430 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(355)) - replicationRecheckInterval = 3000
2016-09-12 17:14:46,430 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(356)) - encryptDataTransfer        = false
2016-09-12 17:14:46,430 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(357)) - maxNumBlocksToLog          = 1000
2016-09-12 17:14:46,431 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(757)) - fsOwner             = root (auth:SIMPLE)
2016-09-12 17:14:46,431 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(758)) - supergroup          = supergroup
2016-09-12 17:14:46,431 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(759)) - isPermissionEnabled = true
2016-09-12 17:14:46,432 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(770)) - HA Enabled: false
2016-09-12 17:14:46,432 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(809)) - Append Enabled: true
2016-09-12 17:14:46,433 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map INodeMap
2016-09-12 17:14:46,433 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:46,434 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 1.0% max memory 3.6 GB = 36.4 MB
2016-09-12 17:14:46,434 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^22 = 4194304 entries
2016-09-12 17:14:46,438 INFO  namenode.FSDirectory (FSDirectory.java:<init>(235)) - ACLs enabled? false
2016-09-12 17:14:46,439 INFO  namenode.FSDirectory (FSDirectory.java:<init>(239)) - XAttrs enabled? true
2016-09-12 17:14:46,439 INFO  namenode.FSDirectory (FSDirectory.java:<init>(247)) - Maximum size of an xattr: 16384
2016-09-12 17:14:46,439 INFO  namenode.NameNode (FSDirectory.java:<init>(295)) - Caching file names occuring more than 10 times
2016-09-12 17:14:46,440 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map cachedBlocks
2016-09-12 17:14:46,440 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:46,441 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.25% max memory 3.6 GB = 9.1 MB
2016-09-12 17:14:46,441 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^20 = 1048576 entries
2016-09-12 17:14:46,442 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5664)) - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2016-09-12 17:14:46,443 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5665)) - dfs.namenode.safemode.min.datanodes = 0
2016-09-12 17:14:46,443 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5666)) - dfs.namenode.safemode.extension     = 0
2016-09-12 17:14:46,443 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:46,444 INFO  metrics.TopMetrics (TopMetrics.java:logConf(65)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2016-09-12 17:14:46,445 INFO  metrics.TopMetrics (TopMetrics.java:logConf(67)) - NNTop conf: dfs.namenode.top.num.users = 10
2016-09-12 17:14:46,445 INFO  metrics.TopMetrics (TopMetrics.java:logConf(69)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2016-09-12 17:14:46,445 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(920)) - Retry cache on namenode is enabled
2016-09-12 17:14:46,446 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(928)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2016-09-12 17:14:46,446 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map NameNodeRetryCache
2016-09-12 17:14:46,446 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:46,447 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.029999999329447746% max memory 3.6 GB = 1.1 MB
2016-09-12 17:14:46,447 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^17 = 131072 entries
2016-09-12 17:14:46,496 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:46,500 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:46,501 TRACE namenode.FSImage (FSImage.java:recoverTransitionRead(228)) - Data dir states:
  Storage Directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2: NORMAL
  Storage Directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1: NORMAL
2016-09-12 17:14:46,504 INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(362)) - Recovering unfinalized segments in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current
2016-09-12 17:14:46,505 INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(362)) - Recovering unfinalized segments in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current
2016-09-12 17:14:46,509 DEBUG namenode.FSImage (FSImage.java:loadFSImage(676)) - Planning to load edit log stream: org.apache.hadoop.hdfs.server.namenode.RedundantEditLogInputStream@5b0e476d
2016-09-12 17:14:46,509 DEBUG namenode.FSImage (FSImage.java:loadFSImageFile(740)) - Planning to load image :
FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000011, cpktTxId=0000000000000000011)
2016-09-12 17:14:46,511 INFO  namenode.FSImageFormatPBINode (FSImageFormatPBINode.java:loadINodeSection(259)) - Loading 1 INodes.
2016-09-12 17:14:46,512 INFO  namenode.FSImageFormatProtobuf (FSImageFormatProtobuf.java:load(181)) - Loaded FSImage in 0 seconds.
2016-09-12 17:14:46,512 INFO  namenode.FSImage (FSImage.java:loadFSImage(982)) - Loaded image for txid 11 from /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000011
2016-09-12 17:14:46,513 DEBUG namenode.FSImage (FSImage.java:loadEdits(834)) - About to load edits:
  org.apache.hadoop.hdfs.server.namenode.RedundantEditLogInputStream@5b0e476d
2016-09-12 17:14:46,513 INFO  namenode.FSImage (FSImage.java:loadEdits(844)) - Reading org.apache.hadoop.hdfs.server.namenode.RedundantEditLogInputStream@5b0e476d expecting start txid #12
2016-09-12 17:14:46,513 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000012-0000000000000000015, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000012-0000000000000000015
2016-09-12 17:14:46,514 INFO  namenode.EditLogInputStream (RedundantEditLogInputStream.java:nextOp(176)) - Fast-forwarding stream '/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000012-0000000000000000015' to transaction ID 12
2016-09-12 17:14:46,516 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
  OP_CLOSE=1
  OP_END_LOG_SEGMENT=1
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:46,516 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000012-0000000000000000015, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000012-0000000000000000015 of size 268 edits # 4 loaded in 0 seconds
2016-09-12 17:14:46,517 INFO  namenode.FSNamesystem (FSNamesystem.java:loadFSImage(997)) - Need to save fs image? true (staleImage=true, haEnabled=false, isRollingUpgrade=false)
2016-09-12 17:14:46,517 INFO  namenode.FSImage (FSImage.java:saveNamespace(1102)) - Save namespace ...
2016-09-12 17:14:46,594 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage.ckpt_0000000000000000015 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000015
2016-09-12 17:14:46,595 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage.ckpt_0000000000000000015 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000015
2016-09-12 17:14:46,597 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 11
2016-09-12 17:14:46,597 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000009, cpktTxId=0000000000000000009)
2016-09-12 17:14:46,598 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000009, cpktTxId=0000000000000000009)
2016-09-12 17:14:46,615 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 16
2016-09-12 17:14:46,702 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2016-09-12 17:14:46,702 INFO  namenode.FSNamesystem (FSNamesystem.java:loadFromDisk(699)) - Finished loading FSImage in 253 msecs
2016-09-12 17:14:46,703 INFO  namenode.NameNode (NameNodeRpcServer.java:<init>(342)) - RPC server is binding to localhost:0
2016-09-12 17:14:46,704 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:46,705 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 53432
2016-09-12 17:14:46,715 INFO  namenode.NameNode (NameNode.java:initialize(654)) - Clients are to use localhost:53432 to access this namenode/service.
2016-09-12 17:14:46,716 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(6536)) - Registered FSNamesystemState MBean
2016-09-12 17:14:46,733 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:46,734 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:46,735 INFO  namenode.FSNamesystem (FSNamesystem.java:initializeReplQueues(1202)) - initializing replication queues
2016-09-12 17:14:46,735 INFO  hdfs.StateChange (FSNamesystem.java:leave(5739)) - STATE* Leaving safe mode after 0 secs
2016-09-12 17:14:46,736 INFO  hdfs.StateChange (FSNamesystem.java:leave(5751)) - STATE* Network topology has 0 racks and 0 datanodes
2016-09-12 17:14:46,736 INFO  hdfs.StateChange (FSNamesystem.java:leave(5754)) - STATE* UnderReplicatedBlocks has 0 blocks
2016-09-12 17:14:46,737 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:46,748 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2766)) - Total number of blocks            = 0
2016-09-12 17:14:46,749 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2767)) - Number of invalid blocks          = 0
2016-09-12 17:14:46,749 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2768)) - Number of under-replicated blocks = 0
2016-09-12 17:14:46,749 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2769)) - Number of  over-replicated blocks = 0
2016-09-12 17:14:46,749 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2771)) - Number of blocks being written    = 0
2016-09-12 17:14:46,749 INFO  hdfs.StateChange (BlockManager.java:processMisReplicatesAsync(2772)) - STATE* Replication Queue initialization scan for invalid, over- and under-replicated blocks completed in 13 msec
2016-09-12 17:14:46,774 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:46,775 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 53432: starting
2016-09-12 17:14:46,778 INFO  namenode.NameNode (NameNode.java:startCommonServices(697)) - NameNode RPC up at: localhost/127.0.0.1:53432
2016-09-12 17:14:46,778 INFO  namenode.FSNamesystem (FSNamesystem.java:startActiveServices(1123)) - Starting services required for active state
2016-09-12 17:14:46,783 INFO  blockmanagement.CacheReplicationMonitor (CacheReplicationMonitor.java:run(160)) - Starting CacheReplicationMonitor with interval 30000 milliseconds
2016-09-12 17:14:46,794 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2286)) - Cluster is active
2016-09-12 17:14:46,800 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/checkpoint.dat	dst=null	perm=null	proto=rpc
2016-09-12 17:14:46,803 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/checkpoint2.dat	dst=null	perm=null	proto=rpc
2016-09-12 17:14:46,805 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdown(1712)) - Shutting down the Mini HDFS Cluster
2016-09-12 17:14:46,805 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:46,805 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 16
2016-09-12 17:14:46,805 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5196)) - NameNodeEditLogRoller was interrupted, exiting
2016-09-12 17:14:46,806 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5269)) - LazyPersistFileScrubber was interrupted, exiting
2016-09-12 17:14:46,806 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 2 Total time for transactions(ms): 0 Number of transactions batched in Syncs: 0 Number of syncs: 3 SyncTimes(ms): 3 3 
2016-09-12 17:14:46,807 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000016 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000016-0000000000000000017
2016-09-12 17:14:46,809 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000016 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000016-0000000000000000017
2016-09-12 17:14:46,810 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 53432
2016-09-12 17:14:46,811 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 53432
2016-09-12 17:14:46,811 INFO  blockmanagement.BlockManager (BlockManager.java:run(3636)) - Stopping ReplicationMonitor.
2016-09-12 17:14:46,812 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:46,822 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:46,823 INFO  namenode.FSNamesystem (FSNamesystem.java:stopStandbyServices(1317)) - Stopping services started for standby state
2016-09-12 17:14:46,827 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:46,928 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(211)) - Stopping NameNode metrics system...
2016-09-12 17:14:46,930 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(217)) - NameNode metrics system stopped.
2016-09-12 17:14:46,930 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:shutdown(606)) - NameNode metrics system shutdown complete.
2016-09-12 17:14:46,966 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:<init>(446)) - starting cluster: numNameNodes=1, numDataNodes=0
Formatting using clusterid: testClusterID
2016-09-12 17:14:46,969 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(727)) - No KeyProvider found.
2016-09-12 17:14:46,970 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(737)) - fsLock is fair:true
2016-09-12 17:14:46,971 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(242)) - dfs.block.invalidate.limit=1000
2016-09-12 17:14:46,971 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(248)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2016-09-12 17:14:46,972 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(71)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2016-09-12 17:14:46,973 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(76)) - The block deletion will start around 2016 九月 12 17:14:46
2016-09-12 17:14:46,973 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map BlocksMap
2016-09-12 17:14:46,974 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:46,974 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 2.0% max memory 3.6 GB = 72.8 MB
2016-09-12 17:14:46,974 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^23 = 8388608 entries
2016-09-12 17:14:46,983 INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(365)) - dfs.block.access.token.enable=false
2016-09-12 17:14:46,983 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(350)) - defaultReplication         = 0
2016-09-12 17:14:46,984 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(351)) - maxReplication             = 512
2016-09-12 17:14:46,984 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(352)) - minReplication             = 1
2016-09-12 17:14:46,984 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(353)) - maxReplicationStreams      = 2
2016-09-12 17:14:46,984 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(354)) - shouldCheckForEnoughRacks  = false
2016-09-12 17:14:46,985 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(355)) - replicationRecheckInterval = 3000
2016-09-12 17:14:46,985 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(356)) - encryptDataTransfer        = false
2016-09-12 17:14:46,985 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(357)) - maxNumBlocksToLog          = 1000
2016-09-12 17:14:46,986 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(757)) - fsOwner             = root (auth:SIMPLE)
2016-09-12 17:14:46,986 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(758)) - supergroup          = supergroup
2016-09-12 17:14:46,986 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(759)) - isPermissionEnabled = true
2016-09-12 17:14:46,987 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(770)) - HA Enabled: false
2016-09-12 17:14:46,987 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(809)) - Append Enabled: true
2016-09-12 17:14:46,989 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map INodeMap
2016-09-12 17:14:46,989 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:46,989 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 1.0% max memory 3.6 GB = 36.4 MB
2016-09-12 17:14:46,990 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^22 = 4194304 entries
2016-09-12 17:14:46,994 INFO  namenode.FSDirectory (FSDirectory.java:<init>(235)) - ACLs enabled? false
2016-09-12 17:14:46,995 INFO  namenode.FSDirectory (FSDirectory.java:<init>(239)) - XAttrs enabled? true
2016-09-12 17:14:46,995 INFO  namenode.FSDirectory (FSDirectory.java:<init>(247)) - Maximum size of an xattr: 16384
2016-09-12 17:14:46,995 INFO  namenode.NameNode (FSDirectory.java:<init>(295)) - Caching file names occuring more than 10 times
2016-09-12 17:14:46,996 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map cachedBlocks
2016-09-12 17:14:46,996 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:46,997 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.25% max memory 3.6 GB = 9.1 MB
2016-09-12 17:14:46,997 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^20 = 1048576 entries
2016-09-12 17:14:46,998 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5664)) - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2016-09-12 17:14:46,999 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5665)) - dfs.namenode.safemode.min.datanodes = 0
2016-09-12 17:14:46,999 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5666)) - dfs.namenode.safemode.extension     = 0
2016-09-12 17:14:46,999 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:47,000 INFO  metrics.TopMetrics (TopMetrics.java:logConf(65)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2016-09-12 17:14:47,001 INFO  metrics.TopMetrics (TopMetrics.java:logConf(67)) - NNTop conf: dfs.namenode.top.num.users = 10
2016-09-12 17:14:47,001 INFO  metrics.TopMetrics (TopMetrics.java:logConf(69)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2016-09-12 17:14:47,001 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(920)) - Retry cache on namenode is enabled
2016-09-12 17:14:47,002 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(928)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2016-09-12 17:14:47,002 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map NameNodeRetryCache
2016-09-12 17:14:47,002 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:47,003 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.029999999329447746% max memory 3.6 GB = 1.1 MB
2016-09-12 17:14:47,003 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^17 = 131072 entries
2016-09-12 17:14:47,007 INFO  namenode.FSImage (FSImage.java:format(168)) - Allocated new BlockPoolId: BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:47,037 INFO  common.Storage (NNStorage.java:format(552)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1 has been successfully formatted.
2016-09-12 17:14:47,070 INFO  common.Storage (NNStorage.java:format(552)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2 has been successfully formatted.
2016-09-12 17:14:47,123 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage.ckpt_0000000000000000000 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000
2016-09-12 17:14:47,124 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage.ckpt_0000000000000000000 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000000
2016-09-12 17:14:47,125 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 1 images with txid >= 0
2016-09-12 17:14:47,126 INFO  namenode.NameNode (NameNode.java:createNameNode(1419)) - createNameNode []
2016-09-12 17:14:47,128 WARN  impl.MetricsConfig (MetricsConfig.java:loadFirst(125)) - Cannot locate configuration: tried hadoop-metrics2-namenode.properties,hadoop-metrics2.properties
2016-09-12 17:14:47,131 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:startTimer(377)) - Scheduled snapshot period at 10 second(s).
2016-09-12 17:14:47,131 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:start(192)) - NameNode metrics system started
2016-09-12 17:14:47,132 INFO  namenode.NameNode (NameNode.java:setClientNamenodeAddress(399)) - fs.defaultFS is hdfs://127.0.0.1:0
2016-09-12 17:14:47,145 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1703)) - Starting Web-server for hdfs at: http://localhost:0
2016-09-12 17:14:47,147 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:47,148 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.namenode is not defined
2016-09-12 17:14:47,150 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:47,150 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hdfs
2016-09-12 17:14:47,151 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:47,151 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:47,153 INFO  http.HttpServer2 (NameNodeHttpServer.java:initWebHdfs(86)) - Added filter 'org.apache.hadoop.hdfs.web.AuthFilter' (class=org.apache.hadoop.hdfs.web.AuthFilter)
2016-09-12 17:14:47,153 INFO  http.HttpServer2 (HttpServer2.java:addJerseyResourcePackage(609)) - addJerseyResourcePackage: packageName=org.apache.hadoop.hdfs.server.namenode.web.resources;org.apache.hadoop.hdfs.web.resources, pathSpec=/webhdfs/v1/*
2016-09-12 17:14:47,156 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 44760
2016-09-12 17:14:47,156 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:47,176 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:44760
2016-09-12 17:14:47,178 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(727)) - No KeyProvider found.
2016-09-12 17:14:47,178 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(737)) - fsLock is fair:true
2016-09-12 17:14:47,179 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(242)) - dfs.block.invalidate.limit=1000
2016-09-12 17:14:47,180 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(248)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2016-09-12 17:14:47,180 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(71)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2016-09-12 17:14:47,181 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(76)) - The block deletion will start around 2016 九月 12 17:14:47
2016-09-12 17:14:47,181 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map BlocksMap
2016-09-12 17:14:47,181 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:47,182 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 2.0% max memory 3.6 GB = 72.8 MB
2016-09-12 17:14:47,182 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^23 = 8388608 entries
2016-09-12 17:14:47,190 INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(365)) - dfs.block.access.token.enable=false
2016-09-12 17:14:47,191 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(350)) - defaultReplication         = 0
2016-09-12 17:14:47,191 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(351)) - maxReplication             = 512
2016-09-12 17:14:47,192 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(352)) - minReplication             = 1
2016-09-12 17:14:47,192 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(353)) - maxReplicationStreams      = 2
2016-09-12 17:14:47,192 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(354)) - shouldCheckForEnoughRacks  = false
2016-09-12 17:14:47,192 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(355)) - replicationRecheckInterval = 3000
2016-09-12 17:14:47,193 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(356)) - encryptDataTransfer        = false
2016-09-12 17:14:47,193 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(357)) - maxNumBlocksToLog          = 1000
2016-09-12 17:14:47,193 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(757)) - fsOwner             = root (auth:SIMPLE)
2016-09-12 17:14:47,194 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(758)) - supergroup          = supergroup
2016-09-12 17:14:47,194 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(759)) - isPermissionEnabled = true
2016-09-12 17:14:47,194 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(770)) - HA Enabled: false
2016-09-12 17:14:47,195 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(809)) - Append Enabled: true
2016-09-12 17:14:47,196 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map INodeMap
2016-09-12 17:14:47,196 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:47,196 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 1.0% max memory 3.6 GB = 36.4 MB
2016-09-12 17:14:47,197 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^22 = 4194304 entries
2016-09-12 17:14:47,201 INFO  namenode.FSDirectory (FSDirectory.java:<init>(235)) - ACLs enabled? false
2016-09-12 17:14:47,201 INFO  namenode.FSDirectory (FSDirectory.java:<init>(239)) - XAttrs enabled? true
2016-09-12 17:14:47,202 INFO  namenode.FSDirectory (FSDirectory.java:<init>(247)) - Maximum size of an xattr: 16384
2016-09-12 17:14:47,202 INFO  namenode.NameNode (FSDirectory.java:<init>(295)) - Caching file names occuring more than 10 times
2016-09-12 17:14:47,203 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map cachedBlocks
2016-09-12 17:14:47,203 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:47,203 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.25% max memory 3.6 GB = 9.1 MB
2016-09-12 17:14:47,204 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^20 = 1048576 entries
2016-09-12 17:14:47,205 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5664)) - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2016-09-12 17:14:47,205 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5665)) - dfs.namenode.safemode.min.datanodes = 0
2016-09-12 17:14:47,205 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5666)) - dfs.namenode.safemode.extension     = 0
2016-09-12 17:14:47,206 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:47,206 INFO  metrics.TopMetrics (TopMetrics.java:logConf(65)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2016-09-12 17:14:47,207 INFO  metrics.TopMetrics (TopMetrics.java:logConf(67)) - NNTop conf: dfs.namenode.top.num.users = 10
2016-09-12 17:14:47,207 INFO  metrics.TopMetrics (TopMetrics.java:logConf(69)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2016-09-12 17:14:47,207 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(920)) - Retry cache on namenode is enabled
2016-09-12 17:14:47,208 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(928)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2016-09-12 17:14:47,208 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map NameNodeRetryCache
2016-09-12 17:14:47,208 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:47,209 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.029999999329447746% max memory 3.6 GB = 1.1 MB
2016-09-12 17:14:47,209 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^17 = 131072 entries
2016-09-12 17:14:47,226 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:47,246 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:47,247 TRACE namenode.FSImage (FSImage.java:recoverTransitionRead(228)) - Data dir states:
  Storage Directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2: NORMAL
  Storage Directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1: NORMAL
2016-09-12 17:14:47,249 INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(362)) - Recovering unfinalized segments in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current
2016-09-12 17:14:47,250 INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(362)) - Recovering unfinalized segments in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current
2016-09-12 17:14:47,251 INFO  namenode.FSImage (FSImage.java:loadFSImage(679)) - No edit log streams selected.
2016-09-12 17:14:47,251 DEBUG namenode.FSImage (FSImage.java:loadFSImageFile(740)) - Planning to load image :
FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000, cpktTxId=0000000000000000000)
2016-09-12 17:14:47,253 INFO  namenode.FSImageFormatPBINode (FSImageFormatPBINode.java:loadINodeSection(259)) - Loading 1 INodes.
2016-09-12 17:14:47,254 INFO  namenode.FSImageFormatProtobuf (FSImageFormatProtobuf.java:load(181)) - Loaded FSImage in 0 seconds.
2016-09-12 17:14:47,254 INFO  namenode.FSImage (FSImage.java:loadFSImage(982)) - Loaded image for txid 0 from /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000
2016-09-12 17:14:47,254 DEBUG namenode.FSImage (FSImage.java:loadEdits(834)) - About to load edits:
  
2016-09-12 17:14:47,255 INFO  namenode.FSNamesystem (FSNamesystem.java:loadFSImage(997)) - Need to save fs image? false (staleImage=false, haEnabled=false, isRollingUpgrade=false)
2016-09-12 17:14:47,256 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 1
2016-09-12 17:14:47,327 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2016-09-12 17:14:47,327 INFO  namenode.FSNamesystem (FSNamesystem.java:loadFromDisk(699)) - Finished loading FSImage in 116 msecs
2016-09-12 17:14:47,328 INFO  namenode.NameNode (NameNodeRpcServer.java:<init>(342)) - RPC server is binding to localhost:0
2016-09-12 17:14:47,329 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:47,330 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 52744
2016-09-12 17:14:47,336 INFO  namenode.NameNode (NameNode.java:initialize(654)) - Clients are to use localhost:52744 to access this namenode/service.
2016-09-12 17:14:47,337 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(6536)) - Registered FSNamesystemState MBean
2016-09-12 17:14:47,354 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:47,355 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:47,355 INFO  namenode.FSNamesystem (FSNamesystem.java:initializeReplQueues(1202)) - initializing replication queues
2016-09-12 17:14:47,356 INFO  hdfs.StateChange (FSNamesystem.java:leave(5739)) - STATE* Leaving safe mode after 0 secs
2016-09-12 17:14:47,356 INFO  hdfs.StateChange (FSNamesystem.java:leave(5751)) - STATE* Network topology has 0 racks and 0 datanodes
2016-09-12 17:14:47,357 INFO  hdfs.StateChange (FSNamesystem.java:leave(5754)) - STATE* UnderReplicatedBlocks has 0 blocks
2016-09-12 17:14:47,357 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:47,369 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2766)) - Total number of blocks            = 0
2016-09-12 17:14:47,370 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2767)) - Number of invalid blocks          = 0
2016-09-12 17:14:47,370 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2768)) - Number of under-replicated blocks = 0
2016-09-12 17:14:47,370 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2769)) - Number of  over-replicated blocks = 0
2016-09-12 17:14:47,371 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2771)) - Number of blocks being written    = 0
2016-09-12 17:14:47,371 INFO  hdfs.StateChange (BlockManager.java:processMisReplicatesAsync(2772)) - STATE* Replication Queue initialization scan for invalid, over- and under-replicated blocks completed in 15 msec
2016-09-12 17:14:47,391 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:47,391 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 52744: starting
2016-09-12 17:14:47,396 INFO  namenode.NameNode (NameNode.java:startCommonServices(697)) - NameNode RPC up at: localhost/127.0.0.1:52744
2016-09-12 17:14:47,396 INFO  namenode.FSNamesystem (FSNamesystem.java:startActiveServices(1123)) - Starting services required for active state
2016-09-12 17:14:47,398 INFO  blockmanagement.CacheReplicationMonitor (CacheReplicationMonitor.java:run(160)) - Starting CacheReplicationMonitor with interval 30000 milliseconds
2016-09-12 17:14:47,407 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2286)) - Cluster is active
2016-09-12 17:14:47,414 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/checkpoint.dat	dst=null	perm=null	proto=rpc
2016-09-12 17:14:47,417 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/checkpoint2.dat	dst=null	perm=null	proto=rpc
2016-09-12 17:14:47,420 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/checkpoint.dat	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:47,422 INFO  namenode.NameNode (NameNode.java:createNameNode(1419)) - createNameNode [-checkpoint]
2016-09-12 17:14:47,422 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(159)) - CheckpointNode metrics system started (again)
2016-09-12 17:14:47,422 INFO  namenode.NameNode (NameNode.java:setClientNamenodeAddress(399)) - fs.defaultFS is hdfs://localhost:52744
2016-09-12 17:14:47,423 INFO  namenode.NameNode (NameNode.java:setClientNamenodeAddress(419)) - Clients are to use localhost:52744 to access this namenode/service.
2016-09-12 17:14:47,442 WARN  common.Util (Util.java:stringAsURI(56)) - Path /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/ should be specified as a URI in configuration files. Please update hdfs configuration.
2016-09-12 17:14:47,443 WARN  common.Util (Util.java:stringAsURI(56)) - Path /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/ should be specified as a URI in configuration files. Please update hdfs configuration.
2016-09-12 17:14:47,443 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(727)) - No KeyProvider found.
2016-09-12 17:14:47,443 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(737)) - fsLock is fair:true
2016-09-12 17:14:47,445 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(242)) - dfs.block.invalidate.limit=1000
2016-09-12 17:14:47,445 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(248)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2016-09-12 17:14:47,446 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(71)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2016-09-12 17:14:47,446 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(76)) - The block deletion will start around 2016 九月 12 17:14:47
2016-09-12 17:14:47,447 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map BlocksMap
2016-09-12 17:14:47,447 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:47,447 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 2.0% max memory 3.6 GB = 72.8 MB
2016-09-12 17:14:47,448 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^23 = 8388608 entries
2016-09-12 17:14:47,458 INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(365)) - dfs.block.access.token.enable=false
2016-09-12 17:14:47,459 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(350)) - defaultReplication         = 0
2016-09-12 17:14:47,459 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(351)) - maxReplication             = 512
2016-09-12 17:14:47,459 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(352)) - minReplication             = 1
2016-09-12 17:14:47,459 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(353)) - maxReplicationStreams      = 2
2016-09-12 17:14:47,460 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(354)) - shouldCheckForEnoughRacks  = false
2016-09-12 17:14:47,460 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(355)) - replicationRecheckInterval = 3000
2016-09-12 17:14:47,460 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(356)) - encryptDataTransfer        = false
2016-09-12 17:14:47,460 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(357)) - maxNumBlocksToLog          = 1000
2016-09-12 17:14:47,461 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(757)) - fsOwner             = root (auth:SIMPLE)
2016-09-12 17:14:47,461 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(758)) - supergroup          = supergroup
2016-09-12 17:14:47,461 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(759)) - isPermissionEnabled = true
2016-09-12 17:14:47,462 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(770)) - HA Enabled: false
2016-09-12 17:14:47,462 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(809)) - Append Enabled: true
2016-09-12 17:14:47,463 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map INodeMap
2016-09-12 17:14:47,463 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:47,463 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 1.0% max memory 3.6 GB = 36.4 MB
2016-09-12 17:14:47,464 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^22 = 4194304 entries
2016-09-12 17:14:47,470 INFO  namenode.FSDirectory (FSDirectory.java:<init>(235)) - ACLs enabled? false
2016-09-12 17:14:47,470 INFO  namenode.FSDirectory (FSDirectory.java:<init>(239)) - XAttrs enabled? true
2016-09-12 17:14:47,470 INFO  namenode.FSDirectory (FSDirectory.java:<init>(247)) - Maximum size of an xattr: 16384
2016-09-12 17:14:47,471 INFO  namenode.NameNode (FSDirectory.java:<init>(295)) - Caching file names occuring more than 10 times
2016-09-12 17:14:47,471 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map cachedBlocks
2016-09-12 17:14:47,471 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:47,472 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.25% max memory 3.6 GB = 9.1 MB
2016-09-12 17:14:47,472 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^20 = 1048576 entries
2016-09-12 17:14:47,473 WARN  namenode.FSNamesystem (FSNamesystem.java:<init>(5655)) - The threshold value should't be greater than 1, threshold: 1.5
2016-09-12 17:14:47,474 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5664)) - dfs.namenode.safemode.threshold-pct = 1.5
2016-09-12 17:14:47,474 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5665)) - dfs.namenode.safemode.min.datanodes = 0
2016-09-12 17:14:47,474 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5666)) - dfs.namenode.safemode.extension     = 2147483647
2016-09-12 17:14:47,475 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:47,475 INFO  metrics.TopMetrics (TopMetrics.java:logConf(65)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2016-09-12 17:14:47,476 INFO  metrics.TopMetrics (TopMetrics.java:logConf(67)) - NNTop conf: dfs.namenode.top.num.users = 10
2016-09-12 17:14:47,476 INFO  metrics.TopMetrics (TopMetrics.java:logConf(69)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2016-09-12 17:14:47,476 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(920)) - Retry cache on namenode is enabled
2016-09-12 17:14:47,476 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(928)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2016-09-12 17:14:47,477 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map NameNodeRetryCache
2016-09-12 17:14:47,477 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:47,478 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.029999999329447746% max memory 3.6 GB = 1.1 MB
2016-09-12 17:14:47,478 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^17 = 131072 entries
2016-09-12 17:14:47,498 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:47,498 INFO  namenode.FSImage (BackupImage.java:recoverCreateRead(130)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1 is not formatted.
2016-09-12 17:14:47,499 INFO  namenode.FSImage (BackupImage.java:recoverCreateRead(131)) - Formatting ...
2016-09-12 17:14:47,500 INFO  namenode.NameNode (NameNodeRpcServer.java:<init>(342)) - RPC server is binding to localhost:0
2016-09-12 17:14:47,500 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:47,501 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 49412
2016-09-12 17:14:47,508 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(6536)) - Registered FSNamesystemState MBean
2016-09-12 17:14:47,509 WARN  common.Util (Util.java:stringAsURI(56)) - Path /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/ should be specified as a URI in configuration files. Please update hdfs configuration.
2016-09-12 17:14:47,518 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:47,518 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:47,519 INFO  hdfs.StateChange (FSNamesystem.java:leave(5739)) - STATE* Leaving safe mode after 0 secs
2016-09-12 17:14:47,519 INFO  hdfs.StateChange (FSNamesystem.java:leave(5751)) - STATE* Network topology has 0 racks and 0 datanodes
2016-09-12 17:14:47,519 INFO  hdfs.StateChange (FSNamesystem.java:leave(5754)) - STATE* UnderReplicatedBlocks has 0 blocks
2016-09-12 17:14:47,520 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:47,544 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1703)) - Starting Web-server for hdfs at: http://localhost:0
2016-09-12 17:14:47,546 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:47,547 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.namenode is not defined
2016-09-12 17:14:47,549 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:47,550 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hdfs
2016-09-12 17:14:47,550 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:47,550 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:47,552 INFO  http.HttpServer2 (NameNodeHttpServer.java:initWebHdfs(86)) - Added filter 'org.apache.hadoop.hdfs.web.AuthFilter' (class=org.apache.hadoop.hdfs.web.AuthFilter)
2016-09-12 17:14:47,552 INFO  http.HttpServer2 (HttpServer2.java:addJerseyResourcePackage(609)) - addJerseyResourcePackage: packageName=org.apache.hadoop.hdfs.server.namenode.web.resources;org.apache.hadoop.hdfs.web.resources, pathSpec=/webhdfs/v1/*
2016-09-12 17:14:47,555 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 59701
2016-09-12 17:14:47,556 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:47,573 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:59701
2016-09-12 17:14:47,575 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:47,575 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 49412: starting
2016-09-12 17:14:47,579 INFO  namenode.NameNode (NameNode.java:startCommonServices(697)) - Checkpoint Node RPC up at: localhost/127.0.0.1:49412
2016-09-12 17:14:47,580 INFO  hdfs.StateChange (FSNamesystem.java:reportStatus(6007)) - STATE* Safe mode is ON. 
It was turned on manually. Use "hdfs dfsadmin -safemode leave" to turn safe mode off.
2016-09-12 17:14:47,581 INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(362)) - Recovering unfinalized segments in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current
2016-09-12 17:14:47,585 INFO  namenode.Checkpointer (Checkpointer.java:initialize(108)) - Checkpoint Period : 3600 secs (60 min)
2016-09-12 17:14:47,585 INFO  namenode.Checkpointer (Checkpointer.java:initialize(111)) - Transactions count is  : 1, to trigger checkpoint
2016-09-12 17:14:47,586 INFO  namenode.FSNamesystem (FSNamesystem.java:startActiveServices(1123)) - Starting services required for active state
2016-09-12 17:14:47,588 ERROR namenode.FSNamesystem (FSNamesystem.java:run(5190)) - Swallowing exception in NameNodeEditLogRoller:
java.lang.IllegalStateException: Bad state: BETWEEN_LOG_SEGMENTS
	at com.google.common.base.Preconditions.checkState(Preconditions.java:172)
	at org.apache.hadoop.hdfs.server.namenode.FSEditLog.getCurSegmentTxId(FSEditLog.java:515)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem$NameNodeEditLogRoller.run(FSNamesystem.java:5181)
	at java.lang.Thread.run(Thread.java:745)
2016-09-12 17:14:47,592 INFO  namenode.FSNamesystem (FSNamesystem.java:startCheckpoint(6347)) - Start checkpoint for localhost:49412
2016-09-12 17:14:47,593 INFO  blockmanagement.CacheReplicationMonitor (CacheReplicationMonitor.java:run(160)) - Starting CacheReplicationMonitor with interval 30000 milliseconds
2016-09-12 17:14:47,589 INFO  namenode.TestBackupNode (TestBackupNode.java:waitCheckpointDone(115)) - Waiting checkpoint to complete... checkpoint txid should increase above 1
2016-09-12 17:14:47,593 INFO  namenode.FSImage (FSImage.java:startCheckpoint(1333)) - Start checkpoint at txid 1
2016-09-12 17:14:47,594 INFO  namenode.FSEditLog (FSEditLog.java:rollEditLog(1202)) - Rolling edit logs
2016-09-12 17:14:47,594 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 1
2016-09-12 17:14:47,596 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 2 Total time for transactions(ms): 2 Number of transactions batched in Syncs: 0 Number of syncs: 3 SyncTimes(ms): 3 2 
2016-09-12 17:14:47,598 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000001 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000001-0000000000000000002
2016-09-12 17:14:47,599 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000001 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000001-0000000000000000002
2016-09-12 17:14:47,600 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 3
2016-09-12 17:14:47,747 DEBUG namenode.Checkpointer (Checkpointer.java:doCheckpoint(211)) - Doing checkpoint. Last applied: 0
2016-09-12 17:14:47,751 INFO  namenode.TransferFsImage (TransferFsImage.java:getFileClient(396)) - Opening connection to http://localhost:44760/imagetransfer?getedit=1&startTxId=1&endTxId=2&storageInfo=-63:52563361:0:testClusterID
2016-09-12 17:14:47,782 INFO  namenode.TransferFsImage (TransferFsImage.java:receiveFile(553)) - Transfer took 0.03s at 0.00 KB/s
2016-09-12 17:14:47,782 INFO  namenode.TransferFsImage (TransferFsImage.java:downloadEditsToStorage(168)) - Downloaded file edits_tmp_0000000000000000001-0000000000000000002_0000000000972380751 size 0 bytes.
2016-09-12 17:14:47,783 INFO  namenode.Checkpointer (Checkpointer.java:rollForwardByApplyingLogs(309)) - Checkpointer about to load edits from 1 stream(s).
2016-09-12 17:14:47,783 DEBUG namenode.FSImage (FSImage.java:loadEdits(834)) - About to load edits:
  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000001-0000000000000000002
2016-09-12 17:14:47,784 INFO  namenode.FSImage (FSImage.java:loadEdits(844)) - Reading /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000001-0000000000000000002 expecting start txid #1
2016-09-12 17:14:47,784 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000001-0000000000000000002
2016-09-12 17:14:47,785 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_END_LOG_SEGMENT=1
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:47,785 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000001-0000000000000000002 of size 42 edits # 2 loaded in 0 seconds
2016-09-12 17:14:47,785 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2016-09-12 17:14:47,831 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/fsimage.ckpt_0000000000000000002 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/fsimage_0000000000000000002
2016-09-12 17:14:47,831 INFO  namenode.FSImageTransactionalStorageInspector (FSImageTransactionalStorageInspector.java:inspectDirectory(85)) - No version file in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1
2016-09-12 17:14:47,878 INFO  namenode.TransferFsImage (TransferFsImage.java:receiveFile(553)) - Transfer took 0.02s at 0.00 KB/s
2016-09-12 17:14:47,879 INFO  namenode.TransferFsImage (TransferFsImage.java:handleUploadImageRequest(134)) - Downloaded file fsimage.ckpt_0000000000000000002 size 350 bytes.
2016-09-12 17:14:47,915 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage.ckpt_0000000000000000002 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000002
2016-09-12 17:14:47,916 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage.ckpt_0000000000000000002 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000002
2016-09-12 17:14:47,917 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 0
2016-09-12 17:14:47,919 INFO  namenode.TransferFsImage (TransferFsImage.java:uploadImageFromStorage(237)) - Uploaded image with txid 2 to namenode at http://localhost:44760 in 0.065 seconds
2016-09-12 17:14:47,922 INFO  namenode.FSNamesystem (FSNamesystem.java:endCheckpoint(6375)) - End checkpoint for localhost:49412
2016-09-12 17:14:47,922 INFO  namenode.FSImage (FSImage.java:endCheckpoint(1373)) - End checkpoint at txid 3
2016-09-12 17:14:47,923 INFO  namenode.Checkpointer (Checkpointer.java:doCheckpoint(278)) - Checkpoint completed in 0 seconds. New Image Size: 350
2016-09-12 17:14:48,594 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(462)) - examining name dir with files: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000003,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000001-0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000002.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/VERSION,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/seen_txid
2016-09-12 17:14:48,595 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(465)) - Examining storage dir /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current with contents: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000003, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000001-0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000002.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/VERSION, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/seen_txid
2016-09-12 17:14:48,596 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(462)) - examining name dir with files: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000003,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000001-0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000002.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/VERSION,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000000.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000000,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/seen_txid
2016-09-12 17:14:48,596 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(465)) - Examining storage dir /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current with contents: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000003, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000001-0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000002.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/VERSION, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000000.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000000, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/seen_txid
2016-09-12 17:14:48,598 INFO  namenode.NameNode (NameNodeRpcServer.java:errorReport(501)) - Error report from NamenodeRegistration(localhost:49412, role=Checkpoint Node): Shutting down.
SEEEEEEEEEEEEEEEEEEEEETcheckpointManager null
2016-09-12 17:14:48,600 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:48,602 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5269)) - LazyPersistFileScrubber was interrupted, exiting
2016-09-12 17:14:48,602 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 49412
2016-09-12 17:14:48,602 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5196)) - NameNodeEditLogRoller was interrupted, exiting
2016-09-12 17:14:48,605 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 49412
2016-09-12 17:14:48,605 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:48,605 INFO  blockmanagement.BlockManager (BlockManager.java:run(3636)) - Stopping ReplicationMonitor.
2016-09-12 17:14:48,617 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:48,617 INFO  namenode.FSNamesystem (FSNamesystem.java:stopStandbyServices(1317)) - Stopping services started for standby state
2016-09-12 17:14:48,622 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:48,728 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdown(1712)) - Shutting down the Mini HDFS Cluster
2016-09-12 17:14:48,728 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:48,729 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 3
2016-09-12 17:14:48,729 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5269)) - LazyPersistFileScrubber was interrupted, exiting
2016-09-12 17:14:48,729 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5196)) - NameNodeEditLogRoller was interrupted, exiting
2016-09-12 17:14:48,732 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 2 Total time for transactions(ms): 2 Number of transactions batched in Syncs: 1 Number of syncs: 3 SyncTimes(ms): 3 3 
2016-09-12 17:14:48,733 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000003 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000003-0000000000000000004
2016-09-12 17:14:48,735 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000003 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000003-0000000000000000004
2016-09-12 17:14:48,736 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 52744
2016-09-12 17:14:48,737 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 52744
2016-09-12 17:14:48,739 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:48,739 INFO  blockmanagement.BlockManager (BlockManager.java:run(3636)) - Stopping ReplicationMonitor.
2016-09-12 17:14:48,750 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:48,750 INFO  namenode.FSNamesystem (FSNamesystem.java:stopStandbyServices(1317)) - Stopping services started for standby state
2016-09-12 17:14:48,755 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:48,855 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(211)) - Stopping CheckpointNode metrics system...
2016-09-12 17:14:48,857 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(217)) - CheckpointNode metrics system stopped.
2016-09-12 17:14:48,858 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:shutdown(606)) - CheckpointNode metrics system shutdown complete.
2016-09-12 17:14:48,865 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:<init>(446)) - starting cluster: numNameNodes=1, numDataNodes=3
2016-09-12 17:14:48,867 INFO  namenode.NameNode (NameNode.java:createNameNode(1419)) - createNameNode []
2016-09-12 17:14:48,869 WARN  impl.MetricsConfig (MetricsConfig.java:loadFirst(125)) - Cannot locate configuration: tried hadoop-metrics2-namenode.properties,hadoop-metrics2.properties
2016-09-12 17:14:48,873 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:startTimer(377)) - Scheduled snapshot period at 10 second(s).
2016-09-12 17:14:48,873 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:start(192)) - NameNode metrics system started
2016-09-12 17:14:48,874 INFO  namenode.NameNode (NameNode.java:setClientNamenodeAddress(399)) - fs.defaultFS is hdfs://127.0.0.1:0
2016-09-12 17:14:48,886 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1703)) - Starting Web-server for hdfs at: http://localhost:0
2016-09-12 17:14:48,888 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:48,889 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.namenode is not defined
2016-09-12 17:14:48,891 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:48,892 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hdfs
2016-09-12 17:14:48,893 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:48,893 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:48,895 INFO  http.HttpServer2 (NameNodeHttpServer.java:initWebHdfs(86)) - Added filter 'org.apache.hadoop.hdfs.web.AuthFilter' (class=org.apache.hadoop.hdfs.web.AuthFilter)
2016-09-12 17:14:48,896 INFO  http.HttpServer2 (HttpServer2.java:addJerseyResourcePackage(609)) - addJerseyResourcePackage: packageName=org.apache.hadoop.hdfs.server.namenode.web.resources;org.apache.hadoop.hdfs.web.resources, pathSpec=/webhdfs/v1/*
2016-09-12 17:14:48,899 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 53667
2016-09-12 17:14:48,899 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:48,920 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:53667
2016-09-12 17:14:48,923 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(727)) - No KeyProvider found.
2016-09-12 17:14:48,923 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(737)) - fsLock is fair:true
2016-09-12 17:14:48,925 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(242)) - dfs.block.invalidate.limit=1000
2016-09-12 17:14:48,925 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(248)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2016-09-12 17:14:48,926 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(71)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2016-09-12 17:14:48,927 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(76)) - The block deletion will start around 2016 九月 12 17:14:48
2016-09-12 17:14:48,927 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map BlocksMap
2016-09-12 17:14:48,927 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:48,928 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 2.0% max memory 3.6 GB = 72.8 MB
2016-09-12 17:14:48,928 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^23 = 8388608 entries
2016-09-12 17:14:48,993 INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(365)) - dfs.block.access.token.enable=false
2016-09-12 17:14:48,994 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(350)) - defaultReplication         = 0
2016-09-12 17:14:48,994 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(351)) - maxReplication             = 512
2016-09-12 17:14:48,994 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(352)) - minReplication             = 1
2016-09-12 17:14:48,995 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(353)) - maxReplicationStreams      = 2
2016-09-12 17:14:48,995 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(354)) - shouldCheckForEnoughRacks  = false
2016-09-12 17:14:48,996 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(355)) - replicationRecheckInterval = 3000
2016-09-12 17:14:48,996 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(356)) - encryptDataTransfer        = false
2016-09-12 17:14:48,996 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(357)) - maxNumBlocksToLog          = 1000
2016-09-12 17:14:48,997 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(757)) - fsOwner             = root (auth:SIMPLE)
2016-09-12 17:14:48,997 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(758)) - supergroup          = supergroup
2016-09-12 17:14:48,997 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(759)) - isPermissionEnabled = true
2016-09-12 17:14:48,998 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(770)) - HA Enabled: false
2016-09-12 17:14:48,999 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(809)) - Append Enabled: true
2016-09-12 17:14:48,999 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map INodeMap
2016-09-12 17:14:49,000 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:49,001 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 1.0% max memory 3.6 GB = 36.4 MB
2016-09-12 17:14:49,001 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^22 = 4194304 entries
2016-09-12 17:14:49,005 INFO  namenode.FSDirectory (FSDirectory.java:<init>(235)) - ACLs enabled? false
2016-09-12 17:14:49,006 INFO  namenode.FSDirectory (FSDirectory.java:<init>(239)) - XAttrs enabled? true
2016-09-12 17:14:49,006 INFO  namenode.FSDirectory (FSDirectory.java:<init>(247)) - Maximum size of an xattr: 16384
2016-09-12 17:14:49,007 INFO  namenode.NameNode (FSDirectory.java:<init>(295)) - Caching file names occuring more than 10 times
2016-09-12 17:14:49,007 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map cachedBlocks
2016-09-12 17:14:49,008 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:49,009 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.25% max memory 3.6 GB = 9.1 MB
2016-09-12 17:14:49,009 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^20 = 1048576 entries
2016-09-12 17:14:49,010 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5664)) - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2016-09-12 17:14:49,011 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5665)) - dfs.namenode.safemode.min.datanodes = 0
2016-09-12 17:14:49,011 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5666)) - dfs.namenode.safemode.extension     = 0
2016-09-12 17:14:49,012 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:49,013 INFO  metrics.TopMetrics (TopMetrics.java:logConf(65)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2016-09-12 17:14:49,013 INFO  metrics.TopMetrics (TopMetrics.java:logConf(67)) - NNTop conf: dfs.namenode.top.num.users = 10
2016-09-12 17:14:49,013 INFO  metrics.TopMetrics (TopMetrics.java:logConf(69)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2016-09-12 17:14:49,014 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(920)) - Retry cache on namenode is enabled
2016-09-12 17:14:49,014 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(928)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2016-09-12 17:14:49,015 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map NameNodeRetryCache
2016-09-12 17:14:49,015 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:49,016 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.029999999329447746% max memory 3.6 GB = 1.1 MB
2016-09-12 17:14:49,016 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^17 = 131072 entries
2016-09-12 17:14:49,041 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:49,046 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:49,046 TRACE namenode.FSImage (FSImage.java:recoverTransitionRead(228)) - Data dir states:
  Storage Directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2: NORMAL
  Storage Directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1: NORMAL
2016-09-12 17:14:49,049 INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(362)) - Recovering unfinalized segments in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current
2016-09-12 17:14:49,050 INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(362)) - Recovering unfinalized segments in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current
2016-09-12 17:14:49,052 DEBUG namenode.FSImage (FSImage.java:loadFSImage(676)) - Planning to load edit log stream: org.apache.hadoop.hdfs.server.namenode.RedundantEditLogInputStream@1df3b58e
2016-09-12 17:14:49,053 DEBUG namenode.FSImage (FSImage.java:loadFSImageFile(740)) - Planning to load image :
FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000002, cpktTxId=0000000000000000002)
2016-09-12 17:14:49,055 INFO  namenode.FSImageFormatPBINode (FSImageFormatPBINode.java:loadINodeSection(259)) - Loading 1 INodes.
2016-09-12 17:14:49,056 INFO  namenode.FSImageFormatProtobuf (FSImageFormatProtobuf.java:load(181)) - Loaded FSImage in 0 seconds.
2016-09-12 17:14:49,056 INFO  namenode.FSImage (FSImage.java:loadFSImage(982)) - Loaded image for txid 2 from /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000002
2016-09-12 17:14:49,057 DEBUG namenode.FSImage (FSImage.java:loadEdits(834)) - About to load edits:
  org.apache.hadoop.hdfs.server.namenode.RedundantEditLogInputStream@1df3b58e
2016-09-12 17:14:49,057 INFO  namenode.FSImage (FSImage.java:loadEdits(844)) - Reading org.apache.hadoop.hdfs.server.namenode.RedundantEditLogInputStream@1df3b58e expecting start txid #3
2016-09-12 17:14:49,058 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000003-0000000000000000004, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000003-0000000000000000004
2016-09-12 17:14:49,058 INFO  namenode.EditLogInputStream (RedundantEditLogInputStream.java:nextOp(176)) - Fast-forwarding stream '/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000003-0000000000000000004' to transaction ID 3
2016-09-12 17:14:49,059 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_END_LOG_SEGMENT=1
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:49,060 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000003-0000000000000000004, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000003-0000000000000000004 of size 42 edits # 2 loaded in 0 seconds
2016-09-12 17:14:49,060 INFO  namenode.FSNamesystem (FSNamesystem.java:loadFSImage(997)) - Need to save fs image? true (staleImage=true, haEnabled=false, isRollingUpgrade=false)
2016-09-12 17:14:49,061 INFO  namenode.FSImage (FSImage.java:saveNamespace(1102)) - Save namespace ...
2016-09-12 17:14:49,131 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage.ckpt_0000000000000000004 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000004
2016-09-12 17:14:49,132 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage.ckpt_0000000000000000004 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000004
2016-09-12 17:14:49,133 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 2
2016-09-12 17:14:49,134 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000, cpktTxId=0000000000000000000)
2016-09-12 17:14:49,134 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000000, cpktTxId=0000000000000000000)
2016-09-12 17:14:49,146 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 5
2016-09-12 17:14:49,235 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2016-09-12 17:14:49,235 INFO  namenode.FSNamesystem (FSNamesystem.java:loadFromDisk(699)) - Finished loading FSImage in 216 msecs
2016-09-12 17:14:49,236 INFO  namenode.NameNode (NameNodeRpcServer.java:<init>(342)) - RPC server is binding to localhost:0
2016-09-12 17:14:49,237 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:49,239 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 42394
2016-09-12 17:14:49,249 INFO  namenode.NameNode (NameNode.java:initialize(654)) - Clients are to use localhost:42394 to access this namenode/service.
2016-09-12 17:14:49,250 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(6536)) - Registered FSNamesystemState MBean
2016-09-12 17:14:49,267 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:49,267 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:49,268 INFO  namenode.FSNamesystem (FSNamesystem.java:initializeReplQueues(1202)) - initializing replication queues
2016-09-12 17:14:49,268 INFO  hdfs.StateChange (FSNamesystem.java:leave(5739)) - STATE* Leaving safe mode after 0 secs
2016-09-12 17:14:49,268 INFO  hdfs.StateChange (FSNamesystem.java:leave(5751)) - STATE* Network topology has 0 racks and 0 datanodes
2016-09-12 17:14:49,269 INFO  hdfs.StateChange (FSNamesystem.java:leave(5754)) - STATE* UnderReplicatedBlocks has 0 blocks
2016-09-12 17:14:49,269 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:49,281 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2766)) - Total number of blocks            = 0
2016-09-12 17:14:49,281 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2767)) - Number of invalid blocks          = 0
2016-09-12 17:14:49,281 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2768)) - Number of under-replicated blocks = 0
2016-09-12 17:14:49,281 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2769)) - Number of  over-replicated blocks = 0
2016-09-12 17:14:49,282 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2771)) - Number of blocks being written    = 0
2016-09-12 17:14:49,282 INFO  hdfs.StateChange (BlockManager.java:processMisReplicatesAsync(2772)) - STATE* Replication Queue initialization scan for invalid, over- and under-replicated blocks completed in 14 msec
2016-09-12 17:14:49,304 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:49,304 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 42394: starting
2016-09-12 17:14:49,309 INFO  namenode.NameNode (NameNode.java:startCommonServices(697)) - NameNode RPC up at: localhost/127.0.0.1:42394
2016-09-12 17:14:49,309 INFO  namenode.FSNamesystem (FSNamesystem.java:startActiveServices(1123)) - Starting services required for active state
2016-09-12 17:14:49,313 INFO  blockmanagement.CacheReplicationMonitor (CacheReplicationMonitor.java:run(160)) - Starting CacheReplicationMonitor with interval 30000 milliseconds
2016-09-12 17:14:49,314 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:startDataNodes(1413)) - Starting DataNode 0 with dfs.datanode.data.dir: [DISK]file:/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1,[DISK]file:/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2
2016-09-12 17:14:49,326 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(159)) - DataNode metrics system started (again)
2016-09-12 17:14:49,327 INFO  datanode.BlockScanner (BlockScanner.java:<init>(175)) - Disabled block scanner.
2016-09-12 17:14:49,327 INFO  datanode.DataNode (DataNode.java:<init>(434)) - Configured hostname is 127.0.0.1
2016-09-12 17:14:49,327 INFO  datanode.DataNode (DataNode.java:startDataNode(1147)) - Starting DataNode with maxLockedMemory = 0
2016-09-12 17:14:49,328 INFO  datanode.DataNode (DataXceiverServer.java:<init>(76)) - Balancing bandwith is 1048576 bytes/s
2016-09-12 17:14:49,329 INFO  datanode.DataNode (DataXceiverServer.java:<init>(77)) - Number threads for balancing is 5
2016-09-12 17:14:49,329 INFO  datanode.DataNode (DataNode.java:initDataXceiver(929)) - Opened streaming server at /127.0.0.1:59379
2016-09-12 17:14:49,335 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:49,336 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.datanode is not defined
2016-09-12 17:14:49,338 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:49,339 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context datanode
2016-09-12 17:14:49,339 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:49,339 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:49,342 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 59022
2016-09-12 17:14:49,342 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:49,362 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:59022
2016-09-12 17:14:49,367 INFO  web.DatanodeHttpServer (DatanodeHttpServer.java:start(186)) - Listening HTTP traffic on /127.0.0.1:42552
2016-09-12 17:14:49,368 INFO  datanode.DataNode (DataNode.java:startDataNode(1164)) - dnUserName = root
2016-09-12 17:14:49,368 INFO  datanode.DataNode (DataNode.java:startDataNode(1165)) - supergroup = supergroup
2016-09-12 17:14:49,369 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:49,370 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 34825
2016-09-12 17:14:49,376 INFO  datanode.DataNode (DataNode.java:initIpcServer(824)) - Opened IPC server at /127.0.0.1:34825
2016-09-12 17:14:49,388 INFO  datanode.DataNode (BlockPoolManager.java:refreshNamenodes(152)) - Refresh request received for nameservices: null
2016-09-12 17:14:49,388 INFO  datanode.DataNode (BlockPoolManager.java:doRefreshNamenodes(197)) - Starting BPOfferServices for nameservices: <default>
2016-09-12 17:14:49,390 INFO  datanode.DataNode (BPServiceActor.java:run(794)) - Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:42394 starting to offer service
2016-09-12 17:14:49,391 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:49,391 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 34825: starting
2016-09-12 17:14:49,396 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:startDataNodes(1413)) - Starting DataNode 1 with dfs.datanode.data.dir: [DISK]file:/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3,[DISK]file:/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4
2016-09-12 17:14:49,410 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(159)) - DataNode metrics system started (again)
2016-09-12 17:14:49,410 INFO  datanode.BlockScanner (BlockScanner.java:<init>(175)) - Disabled block scanner.
2016-09-12 17:14:49,410 INFO  datanode.DataNode (DataNode.java:<init>(434)) - Configured hostname is 127.0.0.1
2016-09-12 17:14:49,411 INFO  datanode.DataNode (DataNode.java:startDataNode(1147)) - Starting DataNode with maxLockedMemory = 0
2016-09-12 17:14:49,412 INFO  datanode.DataNode (DataXceiverServer.java:<init>(76)) - Balancing bandwith is 1048576 bytes/s
2016-09-12 17:14:49,412 INFO  datanode.DataNode (DataXceiverServer.java:<init>(77)) - Number threads for balancing is 5
2016-09-12 17:14:49,413 INFO  datanode.DataNode (DataNode.java:initDataXceiver(929)) - Opened streaming server at /127.0.0.1:35851
2016-09-12 17:14:49,416 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:49,416 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.datanode is not defined
2016-09-12 17:14:49,418 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:49,419 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context datanode
2016-09-12 17:14:49,419 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:49,419 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:49,422 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 39513
2016-09-12 17:14:49,422 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:49,431 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:49,431 INFO  common.Storage (DataStorage.java:loadStorageDirectory(273)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1 is not formatted for BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,431 INFO  common.Storage (DataStorage.java:loadStorageDirectory(275)) - Formatting ...
2016-09-12 17:14:49,442 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:39513
2016-09-12 17:14:49,447 INFO  web.DatanodeHttpServer (DatanodeHttpServer.java:start(186)) - Listening HTTP traffic on /127.0.0.1:58107
2016-09-12 17:14:49,448 INFO  datanode.DataNode (DataNode.java:startDataNode(1164)) - dnUserName = root
2016-09-12 17:14:49,448 INFO  datanode.DataNode (DataNode.java:startDataNode(1165)) - supergroup = supergroup
2016-09-12 17:14:49,449 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:49,455 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 59653
2016-09-12 17:14:49,455 INFO  datanode.DataNode (DataNode.java:initIpcServer(824)) - Opened IPC server at /127.0.0.1:59653
2016-09-12 17:14:49,468 INFO  datanode.DataNode (BlockPoolManager.java:refreshNamenodes(152)) - Refresh request received for nameservices: null
2016-09-12 17:14:49,469 INFO  datanode.DataNode (BlockPoolManager.java:doRefreshNamenodes(197)) - Starting BPOfferServices for nameservices: <default>
2016-09-12 17:14:49,471 INFO  datanode.DataNode (BPServiceActor.java:run(794)) - Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:42394 starting to offer service
2016-09-12 17:14:49,474 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 59653: starting
2016-09-12 17:14:49,479 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:startDataNodes(1413)) - Starting DataNode 2 with dfs.datanode.data.dir: [DISK]file:/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5,[DISK]file:/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6
2016-09-12 17:14:49,475 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:49,498 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(159)) - DataNode metrics system started (again)
2016-09-12 17:14:49,498 INFO  datanode.BlockScanner (BlockScanner.java:<init>(175)) - Disabled block scanner.
2016-09-12 17:14:49,498 INFO  datanode.DataNode (DataNode.java:<init>(434)) - Configured hostname is 127.0.0.1
2016-09-12 17:14:49,499 INFO  datanode.DataNode (DataNode.java:startDataNode(1147)) - Starting DataNode with maxLockedMemory = 0
2016-09-12 17:14:49,499 INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(241)) - Analyzing storage directories for bpid BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,500 INFO  common.Storage (Storage.java:lock(675)) - Locking is disabled for /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current/BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,500 INFO  datanode.DataNode (DataXceiverServer.java:<init>(76)) - Balancing bandwith is 1048576 bytes/s
2016-09-12 17:14:49,500 INFO  datanode.DataNode (DataXceiverServer.java:<init>(77)) - Number threads for balancing is 5
2016-09-12 17:14:49,500 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(158)) - Block pool storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current/BP-874534698-192.168.9.78-1473671687007 is not formatted for BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,501 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(160)) - Formatting ...
2016-09-12 17:14:49,501 INFO  datanode.DataNode (DataNode.java:initDataXceiver(929)) - Opened streaming server at /127.0.0.1:41802
2016-09-12 17:14:49,501 INFO  common.Storage (BlockPoolSliceStorage.java:format(267)) - Formatting block pool BP-874534698-192.168.9.78-1473671687007 directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current/BP-874534698-192.168.9.78-1473671687007/current
2016-09-12 17:14:49,504 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:49,505 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.datanode is not defined
2016-09-12 17:14:49,506 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:49,507 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context datanode
2016-09-12 17:14:49,508 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:49,508 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:49,510 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 36036
2016-09-12 17:14:49,511 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:49,533 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:36036
2016-09-12 17:14:49,536 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:49,536 INFO  common.Storage (DataStorage.java:loadStorageDirectory(273)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3 is not formatted for BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,536 INFO  common.Storage (DataStorage.java:loadStorageDirectory(275)) - Formatting ...
2016-09-12 17:14:49,539 INFO  web.DatanodeHttpServer (DatanodeHttpServer.java:start(186)) - Listening HTTP traffic on /127.0.0.1:46821
2016-09-12 17:14:49,540 INFO  datanode.DataNode (DataNode.java:startDataNode(1164)) - dnUserName = root
2016-09-12 17:14:49,540 INFO  datanode.DataNode (DataNode.java:startDataNode(1165)) - supergroup = supergroup
2016-09-12 17:14:49,541 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:49,542 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 56179
2016-09-12 17:14:49,547 INFO  datanode.DataNode (DataNode.java:initIpcServer(824)) - Opened IPC server at /127.0.0.1:56179
2016-09-12 17:14:49,560 INFO  datanode.DataNode (BlockPoolManager.java:refreshNamenodes(152)) - Refresh request received for nameservices: null
2016-09-12 17:14:49,560 INFO  datanode.DataNode (BlockPoolManager.java:doRefreshNamenodes(197)) - Starting BPOfferServices for nameservices: <default>
2016-09-12 17:14:49,562 INFO  datanode.DataNode (BPServiceActor.java:run(794)) - Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:42394 starting to offer service
2016-09-12 17:14:49,563 INFO  common.Storage (BlockPoolSliceStorage.java:doTransition(359)) - Restored 0 block files from trash.
2016-09-12 17:14:49,567 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:49,568 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 56179: starting
2016-09-12 17:14:49,588 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2303)) - dnInfo.length != numDataNodes
2016-09-12 17:14:49,589 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2255)) - Waiting for cluster to become active
2016-09-12 17:14:49,599 INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(241)) - Analyzing storage directories for bpid BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,600 INFO  common.Storage (Storage.java:lock(675)) - Locking is disabled for /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current/BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,600 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(158)) - Block pool storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current/BP-874534698-192.168.9.78-1473671687007 is not formatted for BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,601 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(160)) - Formatting ...
2016-09-12 17:14:49,601 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:49,601 INFO  common.Storage (BlockPoolSliceStorage.java:format(267)) - Formatting block pool BP-874534698-192.168.9.78-1473671687007 directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current/BP-874534698-192.168.9.78-1473671687007/current
2016-09-12 17:14:49,602 INFO  common.Storage (DataStorage.java:loadStorageDirectory(273)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2 is not formatted for BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,602 INFO  common.Storage (DataStorage.java:loadStorageDirectory(275)) - Formatting ...
2016-09-12 17:14:49,643 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:49,643 INFO  common.Storage (BlockPoolSliceStorage.java:doTransition(359)) - Restored 0 block files from trash.
2016-09-12 17:14:49,643 INFO  common.Storage (DataStorage.java:loadStorageDirectory(273)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5 is not formatted for BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,644 INFO  common.Storage (DataStorage.java:loadStorageDirectory(275)) - Formatting ...
2016-09-12 17:14:49,676 INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(241)) - Analyzing storage directories for bpid BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,677 INFO  common.Storage (Storage.java:lock(675)) - Locking is disabled for /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current/BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,678 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(158)) - Block pool storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current/BP-874534698-192.168.9.78-1473671687007 is not formatted for BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,678 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(160)) - Formatting ...
2016-09-12 17:14:49,679 INFO  common.Storage (BlockPoolSliceStorage.java:format(267)) - Formatting block pool BP-874534698-192.168.9.78-1473671687007 directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current/BP-874534698-192.168.9.78-1473671687007/current
2016-09-12 17:14:49,677 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:49,679 INFO  common.Storage (DataStorage.java:loadStorageDirectory(273)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4 is not formatted for BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,680 INFO  common.Storage (DataStorage.java:loadStorageDirectory(275)) - Formatting ...
2016-09-12 17:14:49,693 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2303)) - dnInfo.length != numDataNodes
2016-09-12 17:14:49,693 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2255)) - Waiting for cluster to become active
2016-09-12 17:14:49,708 INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(241)) - Analyzing storage directories for bpid BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,709 INFO  common.Storage (Storage.java:lock(675)) - Locking is disabled for /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current/BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,709 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(158)) - Block pool storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current/BP-874534698-192.168.9.78-1473671687007 is not formatted for BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,710 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(160)) - Formatting ...
2016-09-12 17:14:49,710 INFO  common.Storage (BlockPoolSliceStorage.java:format(267)) - Formatting block pool BP-874534698-192.168.9.78-1473671687007 directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current/BP-874534698-192.168.9.78-1473671687007/current
2016-09-12 17:14:49,712 INFO  common.Storage (BlockPoolSliceStorage.java:doTransition(359)) - Restored 0 block files from trash.
2016-09-12 17:14:49,718 INFO  datanode.DataNode (DataNode.java:initStorage(1411)) - Setting up storage: nsid=52563361;bpid=BP-874534698-192.168.9.78-1473671687007;lv=-56;nsInfo=lv=-63;cid=testClusterID;nsid=52563361;c=0;bpid=BP-874534698-192.168.9.78-1473671687007;dnuuid=null
2016-09-12 17:14:49,740 INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(241)) - Analyzing storage directories for bpid BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,741 INFO  common.Storage (Storage.java:lock(675)) - Locking is disabled for /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current/BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,741 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(158)) - Block pool storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current/BP-874534698-192.168.9.78-1473671687007 is not formatted for BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,741 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(160)) - Formatting ...
2016-09-12 17:14:49,741 INFO  common.Storage (BlockPoolSliceStorage.java:format(267)) - Formatting block pool BP-874534698-192.168.9.78-1473671687007 directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current/BP-874534698-192.168.9.78-1473671687007/current
2016-09-12 17:14:49,748 INFO  common.Storage (BlockPoolSliceStorage.java:doTransition(359)) - Restored 0 block files from trash.
2016-09-12 17:14:49,784 INFO  common.Storage (BlockPoolSliceStorage.java:doTransition(359)) - Restored 0 block files from trash.
2016-09-12 17:14:49,788 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:49,789 INFO  common.Storage (DataStorage.java:loadStorageDirectory(273)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6 is not formatted for BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,789 INFO  common.Storage (DataStorage.java:loadStorageDirectory(275)) - Formatting ...
2016-09-12 17:14:49,796 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2303)) - dnInfo.length != numDataNodes
2016-09-12 17:14:49,796 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2255)) - Waiting for cluster to become active
2016-09-12 17:14:49,798 INFO  datanode.DataNode (DataNode.java:initStorage(1411)) - Setting up storage: nsid=52563361;bpid=BP-874534698-192.168.9.78-1473671687007;lv=-56;nsInfo=lv=-63;cid=testClusterID;nsid=52563361;c=0;bpid=BP-874534698-192.168.9.78-1473671687007;dnuuid=null
2016-09-12 17:14:49,808 INFO  datanode.DataNode (DataNode.java:checkDatanodeUuid(1240)) - Generated and persisted new Datanode UUID 01b352c0-fc14-4f31-b37a-c54ed9bbadf3
2016-09-12 17:14:49,810 INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(303)) - Added new volume: DS-2b48d027-8d62-4a38-88d8-63ec150fcf9e
2016-09-12 17:14:49,810 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(380)) - Added volume - /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current, StorageType: DISK
2016-09-12 17:14:49,810 INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(303)) - Added new volume: DS-1e6a3ac9-e3e7-4da4-adb1-348e01ac5fa4
2016-09-12 17:14:49,810 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(380)) - Added volume - /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current, StorageType: DISK
2016-09-12 17:14:49,812 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:registerMBean(2028)) - Registered FSDatasetState MBean
2016-09-12 17:14:49,813 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addBlockPool(2474)) - Adding block pool BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,814 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(402)) - Scanning block pool BP-874534698-192.168.9.78-1473671687007 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current...
2016-09-12 17:14:49,814 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(402)) - Scanning block pool BP-874534698-192.168.9.78-1473671687007 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current...
2016-09-12 17:14:49,822 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(407)) - Time taken to scan block pool BP-874534698-192.168.9.78-1473671687007 on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current: 8ms
2016-09-12 17:14:49,822 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(407)) - Time taken to scan block pool BP-874534698-192.168.9.78-1473671687007 on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current: 8ms
2016-09-12 17:14:49,823 INFO  impl.FsDatasetImpl (FsVolumeList.java:addBlockPool(433)) - Total time to scan all replicas for block pool BP-874534698-192.168.9.78-1473671687007: 10ms
2016-09-12 17:14:49,823 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(189)) - Adding replicas to map for block pool BP-874534698-192.168.9.78-1473671687007 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current...
2016-09-12 17:14:49,823 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(189)) - Adding replicas to map for block pool BP-874534698-192.168.9.78-1473671687007 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current...
2016-09-12 17:14:49,824 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(194)) - Time to add replicas to map for block pool BP-874534698-192.168.9.78-1473671687007 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current: 0ms
2016-09-12 17:14:49,824 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(194)) - Time to add replicas to map for block pool BP-874534698-192.168.9.78-1473671687007 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current: 0ms
2016-09-12 17:14:49,825 INFO  impl.FsDatasetImpl (FsVolumeList.java:getAllVolumesMap(220)) - Total time to add all replicas to map: 2ms
2016-09-12 17:14:49,825 INFO  datanode.DirectoryScanner (DirectoryScanner.java:start(332)) - Periodic Directory Tree Verification scan starting at 1473692456825 with interval 21600000
2016-09-12 17:14:49,827 INFO  datanode.DataNode (BPServiceActor.java:register(749)) - Block pool BP-874534698-192.168.9.78-1473671687007 (Datanode Uuid null) service to localhost/127.0.0.1:42394 beginning handshake with NN
2016-09-12 17:14:49,829 INFO  hdfs.StateChange (DatanodeManager.java:registerDatanode(891)) - BLOCK* registerDatanode: from DatanodeRegistration(127.0.0.1:59379, datanodeUuid=01b352c0-fc14-4f31-b37a-c54ed9bbadf3, infoPort=42552, infoSecurePort=0, ipcPort=34825, storageInfo=lv=-56;cid=testClusterID;nsid=52563361;c=0) storage 01b352c0-fc14-4f31-b37a-c54ed9bbadf3
2016-09-12 17:14:49,830 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:49,830 INFO  net.NetworkTopology (NetworkTopology.java:add(419)) - Adding a new node: /default-rack/127.0.0.1:59379
2016-09-12 17:14:49,831 INFO  datanode.DataNode (BPServiceActor.java:register(767)) - Block pool Block pool BP-874534698-192.168.9.78-1473671687007 (Datanode Uuid null) service to localhost/127.0.0.1:42394 successfully registered with NN
2016-09-12 17:14:49,832 INFO  datanode.DataNode (BPServiceActor.java:offerService(625)) - For namenode localhost/127.0.0.1:42394 using DELETEREPORT_INTERVAL of 300000 msec  BLOCKREPORT_INTERVAL of 21600000msec CACHEREPORT_INTERVAL of 10000msec Initial delay: 0msec; heartBeatInterval=3000
2016-09-12 17:14:49,835 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:49,836 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-2b48d027-8d62-4a38-88d8-63ec150fcf9e for DN 127.0.0.1:59379
2016-09-12 17:14:49,836 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-1e6a3ac9-e3e7-4da4-adb1-348e01ac5fa4 for DN 127.0.0.1:59379
2016-09-12 17:14:49,837 INFO  datanode.DataNode (BPOfferService.java:updateActorStatesFromHeartbeat(507)) - Namenode Block pool BP-874534698-192.168.9.78-1473671687007 (Datanode Uuid 01b352c0-fc14-4f31-b37a-c54ed9bbadf3) service to localhost/127.0.0.1:42394 trying to claim ACTIVE state with txid=5
2016-09-12 17:14:49,837 INFO  datanode.DataNode (BPOfferService.java:updateActorStatesFromHeartbeat(519)) - Acknowledging ACTIVE Namenode Block pool BP-874534698-192.168.9.78-1473671687007 (Datanode Uuid 01b352c0-fc14-4f31-b37a-c54ed9bbadf3) service to localhost/127.0.0.1:42394
2016-09-12 17:14:49,840 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-1e6a3ac9-e3e7-4da4-adb1-348e01ac5fa4 node DatanodeRegistration(127.0.0.1:59379, datanodeUuid=01b352c0-fc14-4f31-b37a-c54ed9bbadf3, infoPort=42552, infoSecurePort=0, ipcPort=34825, storageInfo=lv=-56;cid=testClusterID;nsid=52563361;c=0), blocks: 0, hasStaleStorage: true, processing time: 1 msecs
2016-09-12 17:14:49,840 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-2b48d027-8d62-4a38-88d8-63ec150fcf9e node DatanodeRegistration(127.0.0.1:59379, datanodeUuid=01b352c0-fc14-4f31-b37a-c54ed9bbadf3, infoPort=42552, infoSecurePort=0, ipcPort=34825, storageInfo=lv=-56;cid=testClusterID;nsid=52563361;c=0), blocks: 0, hasStaleStorage: false, processing time: 0 msecs
2016-09-12 17:14:49,841 INFO  datanode.DataNode (BPServiceActor.java:blockReport(492)) - Successfully sent block report 0x3746085a82d64,  containing 2 storage report(s), of which we sent 2. The reports had 0 total blocks and used 1 RPC(s). This took 0 msec to generate and 3 msecs for RPC and NN processing. Got back one command: FinalizeCommand/5.
2016-09-12 17:14:49,842 INFO  datanode.DataNode (BPOfferService.java:processCommandFromActive(690)) - Got finalize command for block pool BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,842 INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(241)) - Analyzing storage directories for bpid BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,842 INFO  common.Storage (Storage.java:lock(675)) - Locking is disabled for /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current/BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,842 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(158)) - Block pool storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current/BP-874534698-192.168.9.78-1473671687007 is not formatted for BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,843 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(160)) - Formatting ...
2016-09-12 17:14:49,843 INFO  common.Storage (BlockPoolSliceStorage.java:format(267)) - Formatting block pool BP-874534698-192.168.9.78-1473671687007 directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current/BP-874534698-192.168.9.78-1473671687007/current
2016-09-12 17:14:49,864 INFO  datanode.DataNode (DataNode.java:checkDatanodeUuid(1240)) - Generated and persisted new Datanode UUID 1a5a6641-c868-4b2e-a9f9-3adc5d0cc714
2016-09-12 17:14:49,866 INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(303)) - Added new volume: DS-a22fc87f-ba2d-4040-a651-16d8b31bc4a7
2016-09-12 17:14:49,866 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(380)) - Added volume - /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current, StorageType: DISK
2016-09-12 17:14:49,867 INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(303)) - Added new volume: DS-cddef92c-9282-44fb-845a-12adb8bc6929
2016-09-12 17:14:49,867 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(380)) - Added volume - /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current, StorageType: DISK
2016-09-12 17:14:49,868 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:registerMBean(2028)) - Registered FSDatasetState MBean
2016-09-12 17:14:49,869 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addBlockPool(2474)) - Adding block pool BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,870 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(402)) - Scanning block pool BP-874534698-192.168.9.78-1473671687007 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current...
2016-09-12 17:14:49,870 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(402)) - Scanning block pool BP-874534698-192.168.9.78-1473671687007 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current...
2016-09-12 17:14:49,875 INFO  common.Storage (BlockPoolSliceStorage.java:doTransition(359)) - Restored 0 block files from trash.
2016-09-12 17:14:49,875 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(407)) - Time taken to scan block pool BP-874534698-192.168.9.78-1473671687007 on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current: 5ms
2016-09-12 17:14:49,877 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(407)) - Time taken to scan block pool BP-874534698-192.168.9.78-1473671687007 on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current: 6ms
2016-09-12 17:14:49,877 INFO  impl.FsDatasetImpl (FsVolumeList.java:addBlockPool(433)) - Total time to scan all replicas for block pool BP-874534698-192.168.9.78-1473671687007: 8ms
2016-09-12 17:14:49,878 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(189)) - Adding replicas to map for block pool BP-874534698-192.168.9.78-1473671687007 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current...
2016-09-12 17:14:49,878 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(189)) - Adding replicas to map for block pool BP-874534698-192.168.9.78-1473671687007 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current...
2016-09-12 17:14:49,878 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(194)) - Time to add replicas to map for block pool BP-874534698-192.168.9.78-1473671687007 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data3/current: 0ms
2016-09-12 17:14:49,878 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(194)) - Time to add replicas to map for block pool BP-874534698-192.168.9.78-1473671687007 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data4/current: 0ms
2016-09-12 17:14:49,879 INFO  impl.FsDatasetImpl (FsVolumeList.java:getAllVolumesMap(220)) - Total time to add all replicas to map: 2ms
2016-09-12 17:14:49,880 INFO  datanode.DirectoryScanner (DirectoryScanner.java:start(332)) - Periodic Directory Tree Verification scan starting at 1473682694880 with interval 21600000
2016-09-12 17:14:49,881 INFO  datanode.DataNode (BPServiceActor.java:register(749)) - Block pool BP-874534698-192.168.9.78-1473671687007 (Datanode Uuid null) service to localhost/127.0.0.1:42394 beginning handshake with NN
2016-09-12 17:14:49,883 INFO  hdfs.StateChange (DatanodeManager.java:registerDatanode(891)) - BLOCK* registerDatanode: from DatanodeRegistration(127.0.0.1:35851, datanodeUuid=1a5a6641-c868-4b2e-a9f9-3adc5d0cc714, infoPort=58107, infoSecurePort=0, ipcPort=59653, storageInfo=lv=-56;cid=testClusterID;nsid=52563361;c=0) storage 1a5a6641-c868-4b2e-a9f9-3adc5d0cc714
2016-09-12 17:14:49,883 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:49,884 INFO  datanode.DataNode (DataNode.java:initStorage(1411)) - Setting up storage: nsid=52563361;bpid=BP-874534698-192.168.9.78-1473671687007;lv=-56;nsInfo=lv=-63;cid=testClusterID;nsid=52563361;c=0;bpid=BP-874534698-192.168.9.78-1473671687007;dnuuid=null
2016-09-12 17:14:49,884 INFO  net.NetworkTopology (NetworkTopology.java:add(419)) - Adding a new node: /default-rack/127.0.0.1:35851
2016-09-12 17:14:49,886 INFO  datanode.DataNode (BPServiceActor.java:register(767)) - Block pool Block pool BP-874534698-192.168.9.78-1473671687007 (Datanode Uuid null) service to localhost/127.0.0.1:42394 successfully registered with NN
2016-09-12 17:14:49,886 INFO  datanode.DataNode (BPServiceActor.java:offerService(625)) - For namenode localhost/127.0.0.1:42394 using DELETEREPORT_INTERVAL of 300000 msec  BLOCKREPORT_INTERVAL of 21600000msec CACHEREPORT_INTERVAL of 10000msec Initial delay: 0msec; heartBeatInterval=3000
2016-09-12 17:14:49,890 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:49,890 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-a22fc87f-ba2d-4040-a651-16d8b31bc4a7 for DN 127.0.0.1:35851
2016-09-12 17:14:49,890 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-cddef92c-9282-44fb-845a-12adb8bc6929 for DN 127.0.0.1:35851
2016-09-12 17:14:49,891 INFO  datanode.DataNode (BPOfferService.java:updateActorStatesFromHeartbeat(507)) - Namenode Block pool BP-874534698-192.168.9.78-1473671687007 (Datanode Uuid 1a5a6641-c868-4b2e-a9f9-3adc5d0cc714) service to localhost/127.0.0.1:42394 trying to claim ACTIVE state with txid=5
2016-09-12 17:14:49,891 INFO  datanode.DataNode (BPOfferService.java:updateActorStatesFromHeartbeat(519)) - Acknowledging ACTIVE Namenode Block pool BP-874534698-192.168.9.78-1473671687007 (Datanode Uuid 1a5a6641-c868-4b2e-a9f9-3adc5d0cc714) service to localhost/127.0.0.1:42394
2016-09-12 17:14:49,894 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-cddef92c-9282-44fb-845a-12adb8bc6929 node DatanodeRegistration(127.0.0.1:35851, datanodeUuid=1a5a6641-c868-4b2e-a9f9-3adc5d0cc714, infoPort=58107, infoSecurePort=0, ipcPort=59653, storageInfo=lv=-56;cid=testClusterID;nsid=52563361;c=0), blocks: 0, hasStaleStorage: true, processing time: 0 msecs
2016-09-12 17:14:49,894 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-a22fc87f-ba2d-4040-a651-16d8b31bc4a7 node DatanodeRegistration(127.0.0.1:35851, datanodeUuid=1a5a6641-c868-4b2e-a9f9-3adc5d0cc714, infoPort=58107, infoSecurePort=0, ipcPort=59653, storageInfo=lv=-56;cid=testClusterID;nsid=52563361;c=0), blocks: 0, hasStaleStorage: false, processing time: 0 msecs
2016-09-12 17:14:49,895 INFO  datanode.DataNode (BPServiceActor.java:blockReport(492)) - Successfully sent block report 0x3746088ddb641,  containing 2 storage report(s), of which we sent 2. The reports had 0 total blocks and used 1 RPC(s). This took 1 msec to generate and 3 msecs for RPC and NN processing. Got back one command: FinalizeCommand/5.
2016-09-12 17:14:49,895 INFO  datanode.DataNode (BPOfferService.java:processCommandFromActive(690)) - Got finalize command for block pool BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,900 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2303)) - dnInfo.length != numDataNodes
2016-09-12 17:14:49,900 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2255)) - Waiting for cluster to become active
2016-09-12 17:14:49,925 INFO  datanode.DataNode (DataNode.java:checkDatanodeUuid(1240)) - Generated and persisted new Datanode UUID 8ed2a606-46d4-4782-89a7-147deec1c7ca
2016-09-12 17:14:49,927 INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(303)) - Added new volume: DS-02fe16f9-9e72-4283-8f3a-0aa473b6f913
2016-09-12 17:14:49,927 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(380)) - Added volume - /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current, StorageType: DISK
2016-09-12 17:14:49,928 INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(303)) - Added new volume: DS-3c4e5c85-3bb5-4b8b-81b3-8ff2373e9506
2016-09-12 17:14:49,928 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(380)) - Added volume - /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current, StorageType: DISK
2016-09-12 17:14:49,929 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:registerMBean(2028)) - Registered FSDatasetState MBean
2016-09-12 17:14:49,929 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addBlockPool(2474)) - Adding block pool BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:49,930 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(402)) - Scanning block pool BP-874534698-192.168.9.78-1473671687007 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current...
2016-09-12 17:14:49,931 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(402)) - Scanning block pool BP-874534698-192.168.9.78-1473671687007 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current...
2016-09-12 17:14:49,937 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(407)) - Time taken to scan block pool BP-874534698-192.168.9.78-1473671687007 on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current: 6ms
2016-09-12 17:14:49,938 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(407)) - Time taken to scan block pool BP-874534698-192.168.9.78-1473671687007 on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current: 7ms
2016-09-12 17:14:49,938 INFO  impl.FsDatasetImpl (FsVolumeList.java:addBlockPool(433)) - Total time to scan all replicas for block pool BP-874534698-192.168.9.78-1473671687007: 8ms
2016-09-12 17:14:49,939 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(189)) - Adding replicas to map for block pool BP-874534698-192.168.9.78-1473671687007 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current...
2016-09-12 17:14:49,939 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(189)) - Adding replicas to map for block pool BP-874534698-192.168.9.78-1473671687007 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current...
2016-09-12 17:14:49,939 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(194)) - Time to add replicas to map for block pool BP-874534698-192.168.9.78-1473671687007 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data5/current: 0ms
2016-09-12 17:14:49,939 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(194)) - Time to add replicas to map for block pool BP-874534698-192.168.9.78-1473671687007 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data6/current: 0ms
2016-09-12 17:14:49,940 INFO  impl.FsDatasetImpl (FsVolumeList.java:getAllVolumesMap(220)) - Total time to add all replicas to map: 2ms
2016-09-12 17:14:49,940 INFO  datanode.DirectoryScanner (DirectoryScanner.java:start(332)) - Periodic Directory Tree Verification scan starting at 1473692789940 with interval 21600000
2016-09-12 17:14:49,942 INFO  datanode.DataNode (BPServiceActor.java:register(749)) - Block pool BP-874534698-192.168.9.78-1473671687007 (Datanode Uuid null) service to localhost/127.0.0.1:42394 beginning handshake with NN
2016-09-12 17:14:49,944 INFO  hdfs.StateChange (DatanodeManager.java:registerDatanode(891)) - BLOCK* registerDatanode: from DatanodeRegistration(127.0.0.1:41802, datanodeUuid=8ed2a606-46d4-4782-89a7-147deec1c7ca, infoPort=46821, infoSecurePort=0, ipcPort=56179, storageInfo=lv=-56;cid=testClusterID;nsid=52563361;c=0) storage 8ed2a606-46d4-4782-89a7-147deec1c7ca
2016-09-12 17:14:49,944 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:49,944 INFO  net.NetworkTopology (NetworkTopology.java:add(419)) - Adding a new node: /default-rack/127.0.0.1:41802
2016-09-12 17:14:49,946 INFO  datanode.DataNode (BPServiceActor.java:register(767)) - Block pool Block pool BP-874534698-192.168.9.78-1473671687007 (Datanode Uuid null) service to localhost/127.0.0.1:42394 successfully registered with NN
2016-09-12 17:14:49,946 INFO  datanode.DataNode (BPServiceActor.java:offerService(625)) - For namenode localhost/127.0.0.1:42394 using DELETEREPORT_INTERVAL of 300000 msec  BLOCKREPORT_INTERVAL of 21600000msec CACHEREPORT_INTERVAL of 10000msec Initial delay: 0msec; heartBeatInterval=3000
2016-09-12 17:14:49,950 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:49,950 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-02fe16f9-9e72-4283-8f3a-0aa473b6f913 for DN 127.0.0.1:41802
2016-09-12 17:14:49,950 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-3c4e5c85-3bb5-4b8b-81b3-8ff2373e9506 for DN 127.0.0.1:41802
2016-09-12 17:14:49,951 INFO  datanode.DataNode (BPOfferService.java:updateActorStatesFromHeartbeat(507)) - Namenode Block pool BP-874534698-192.168.9.78-1473671687007 (Datanode Uuid 8ed2a606-46d4-4782-89a7-147deec1c7ca) service to localhost/127.0.0.1:42394 trying to claim ACTIVE state with txid=5
2016-09-12 17:14:49,951 INFO  datanode.DataNode (BPOfferService.java:updateActorStatesFromHeartbeat(519)) - Acknowledging ACTIVE Namenode Block pool BP-874534698-192.168.9.78-1473671687007 (Datanode Uuid 8ed2a606-46d4-4782-89a7-147deec1c7ca) service to localhost/127.0.0.1:42394
2016-09-12 17:14:49,954 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-3c4e5c85-3bb5-4b8b-81b3-8ff2373e9506 node DatanodeRegistration(127.0.0.1:41802, datanodeUuid=8ed2a606-46d4-4782-89a7-147deec1c7ca, infoPort=46821, infoSecurePort=0, ipcPort=56179, storageInfo=lv=-56;cid=testClusterID;nsid=52563361;c=0), blocks: 0, hasStaleStorage: true, processing time: 1 msecs
2016-09-12 17:14:49,954 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-02fe16f9-9e72-4283-8f3a-0aa473b6f913 node DatanodeRegistration(127.0.0.1:41802, datanodeUuid=8ed2a606-46d4-4782-89a7-147deec1c7ca, infoPort=46821, infoSecurePort=0, ipcPort=56179, storageInfo=lv=-56;cid=testClusterID;nsid=52563361;c=0), blocks: 0, hasStaleStorage: false, processing time: 0 msecs
2016-09-12 17:14:49,955 INFO  datanode.DataNode (BPServiceActor.java:blockReport(492)) - Successfully sent block report 0x374608c76817e,  containing 2 storage report(s), of which we sent 2. The reports had 0 total blocks and used 1 RPC(s). This took 0 msec to generate and 3 msecs for RPC and NN processing. Got back one command: FinalizeCommand/5.
2016-09-12 17:14:49,956 INFO  datanode.DataNode (BPOfferService.java:processCommandFromActive(690)) - Got finalize command for block pool BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:50,004 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2286)) - Cluster is active
2016-09-12 17:14:50,015 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/checkpoint.dat	dst=null	perm=null	proto=rpc
2016-09-12 17:14:50,030 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=delete	src=/checkpoint.dat	dst=null	perm=null	proto=rpc
2016-09-12 17:14:50,033 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/checkpoint2.dat	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:50,034 INFO  namenode.NameNode (NameNode.java:createNameNode(1419)) - createNameNode [-checkpoint]
2016-09-12 17:14:50,035 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(159)) - CheckpointNode metrics system started (again)
2016-09-12 17:14:50,035 INFO  namenode.NameNode (NameNode.java:setClientNamenodeAddress(399)) - fs.defaultFS is hdfs://localhost:42394
2016-09-12 17:14:50,035 INFO  namenode.NameNode (NameNode.java:setClientNamenodeAddress(419)) - Clients are to use localhost:42394 to access this namenode/service.
2016-09-12 17:14:50,053 WARN  common.Util (Util.java:stringAsURI(56)) - Path /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/ should be specified as a URI in configuration files. Please update hdfs configuration.
2016-09-12 17:14:50,054 WARN  common.Util (Util.java:stringAsURI(56)) - Path /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/ should be specified as a URI in configuration files. Please update hdfs configuration.
2016-09-12 17:14:50,055 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(727)) - No KeyProvider found.
2016-09-12 17:14:50,055 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(737)) - fsLock is fair:true
2016-09-12 17:14:50,057 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(242)) - dfs.block.invalidate.limit=1000
2016-09-12 17:14:50,057 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(248)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2016-09-12 17:14:50,058 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(71)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2016-09-12 17:14:50,059 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(76)) - The block deletion will start around 2016 九月 12 17:14:50
2016-09-12 17:14:50,059 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map BlocksMap
2016-09-12 17:14:50,060 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:50,060 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 2.0% max memory 3.6 GB = 72.8 MB
2016-09-12 17:14:50,061 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^23 = 8388608 entries
2016-09-12 17:14:50,069 INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(365)) - dfs.block.access.token.enable=false
2016-09-12 17:14:50,070 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(350)) - defaultReplication         = 0
2016-09-12 17:14:50,070 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(351)) - maxReplication             = 512
2016-09-12 17:14:50,071 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(352)) - minReplication             = 1
2016-09-12 17:14:50,071 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(353)) - maxReplicationStreams      = 2
2016-09-12 17:14:50,071 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(354)) - shouldCheckForEnoughRacks  = false
2016-09-12 17:14:50,072 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(355)) - replicationRecheckInterval = 3000
2016-09-12 17:14:50,072 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(356)) - encryptDataTransfer        = false
2016-09-12 17:14:50,072 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(357)) - maxNumBlocksToLog          = 1000
2016-09-12 17:14:50,073 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(757)) - fsOwner             = root (auth:SIMPLE)
2016-09-12 17:14:50,073 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(758)) - supergroup          = supergroup
2016-09-12 17:14:50,074 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(759)) - isPermissionEnabled = true
2016-09-12 17:14:50,074 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(770)) - HA Enabled: false
2016-09-12 17:14:50,075 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(809)) - Append Enabled: true
2016-09-12 17:14:50,075 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map INodeMap
2016-09-12 17:14:50,075 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:50,076 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 1.0% max memory 3.6 GB = 36.4 MB
2016-09-12 17:14:50,076 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^22 = 4194304 entries
2016-09-12 17:14:50,081 INFO  namenode.FSDirectory (FSDirectory.java:<init>(235)) - ACLs enabled? false
2016-09-12 17:14:50,081 INFO  namenode.FSDirectory (FSDirectory.java:<init>(239)) - XAttrs enabled? true
2016-09-12 17:14:50,081 INFO  namenode.FSDirectory (FSDirectory.java:<init>(247)) - Maximum size of an xattr: 16384
2016-09-12 17:14:50,082 INFO  namenode.NameNode (FSDirectory.java:<init>(295)) - Caching file names occuring more than 10 times
2016-09-12 17:14:50,082 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map cachedBlocks
2016-09-12 17:14:50,082 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:50,083 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.25% max memory 3.6 GB = 9.1 MB
2016-09-12 17:14:50,083 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^20 = 1048576 entries
2016-09-12 17:14:50,084 WARN  namenode.FSNamesystem (FSNamesystem.java:<init>(5655)) - The threshold value should't be greater than 1, threshold: 1.5
2016-09-12 17:14:50,084 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5664)) - dfs.namenode.safemode.threshold-pct = 1.5
2016-09-12 17:14:50,085 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5665)) - dfs.namenode.safemode.min.datanodes = 0
2016-09-12 17:14:50,085 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5666)) - dfs.namenode.safemode.extension     = 2147483647
2016-09-12 17:14:50,085 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:50,086 INFO  metrics.TopMetrics (TopMetrics.java:logConf(65)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2016-09-12 17:14:50,086 INFO  metrics.TopMetrics (TopMetrics.java:logConf(67)) - NNTop conf: dfs.namenode.top.num.users = 10
2016-09-12 17:14:50,086 INFO  metrics.TopMetrics (TopMetrics.java:logConf(69)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2016-09-12 17:14:50,087 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(920)) - Retry cache on namenode is enabled
2016-09-12 17:14:50,087 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(928)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2016-09-12 17:14:50,087 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map NameNodeRetryCache
2016-09-12 17:14:50,088 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:50,088 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.029999999329447746% max memory 3.6 GB = 1.1 MB
2016-09-12 17:14:50,088 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^17 = 131072 entries
2016-09-12 17:14:50,097 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:50,098 INFO  namenode.NameNode (NameNodeRpcServer.java:<init>(342)) - RPC server is binding to localhost:0
2016-09-12 17:14:50,098 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:50,099 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 48689
2016-09-12 17:14:50,107 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(6536)) - Registered FSNamesystemState MBean
2016-09-12 17:14:50,108 WARN  common.Util (Util.java:stringAsURI(56)) - Path /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/ should be specified as a URI in configuration files. Please update hdfs configuration.
2016-09-12 17:14:50,117 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:50,118 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:50,118 INFO  hdfs.StateChange (FSNamesystem.java:leave(5739)) - STATE* Leaving safe mode after 0 secs
2016-09-12 17:14:50,119 INFO  hdfs.StateChange (FSNamesystem.java:leave(5751)) - STATE* Network topology has 0 racks and 0 datanodes
2016-09-12 17:14:50,119 INFO  hdfs.StateChange (FSNamesystem.java:leave(5754)) - STATE* UnderReplicatedBlocks has 0 blocks
2016-09-12 17:14:50,120 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:50,146 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1703)) - Starting Web-server for hdfs at: http://localhost:0
2016-09-12 17:14:50,148 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:50,149 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.namenode is not defined
2016-09-12 17:14:50,150 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:50,151 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hdfs
2016-09-12 17:14:50,151 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:50,152 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:50,153 INFO  http.HttpServer2 (NameNodeHttpServer.java:initWebHdfs(86)) - Added filter 'org.apache.hadoop.hdfs.web.AuthFilter' (class=org.apache.hadoop.hdfs.web.AuthFilter)
2016-09-12 17:14:50,153 INFO  http.HttpServer2 (HttpServer2.java:addJerseyResourcePackage(609)) - addJerseyResourcePackage: packageName=org.apache.hadoop.hdfs.server.namenode.web.resources;org.apache.hadoop.hdfs.web.resources, pathSpec=/webhdfs/v1/*
2016-09-12 17:14:50,155 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 46135
2016-09-12 17:14:50,155 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:50,175 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:46135
2016-09-12 17:14:50,178 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:50,178 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 48689: starting
2016-09-12 17:14:50,186 INFO  namenode.NameNode (NameNode.java:startCommonServices(697)) - Checkpoint Node RPC up at: localhost/127.0.0.1:48689
2016-09-12 17:14:50,187 INFO  hdfs.StateChange (FSNamesystem.java:reportStatus(6007)) - STATE* Safe mode is ON. 
It was turned on manually. Use "hdfs dfsadmin -safemode leave" to turn safe mode off.
2016-09-12 17:14:50,187 INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(362)) - Recovering unfinalized segments in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current
2016-09-12 17:14:50,191 INFO  namenode.Checkpointer (Checkpointer.java:initialize(108)) - Checkpoint Period : 3600 secs (60 min)
2016-09-12 17:14:50,191 INFO  namenode.Checkpointer (Checkpointer.java:initialize(111)) - Transactions count is  : 1, to trigger checkpoint
2016-09-12 17:14:50,192 INFO  namenode.FSNamesystem (FSNamesystem.java:startActiveServices(1123)) - Starting services required for active state
2016-09-12 17:14:50,194 INFO  namenode.TestBackupNode (TestBackupNode.java:waitCheckpointDone(115)) - Waiting checkpoint to complete... checkpoint txid should increase above 6
2016-09-12 17:14:50,199 INFO  blockmanagement.CacheReplicationMonitor (CacheReplicationMonitor.java:run(160)) - Starting CacheReplicationMonitor with interval 30000 milliseconds
2016-09-12 17:14:50,199 ERROR namenode.FSNamesystem (FSNamesystem.java:run(5190)) - Swallowing exception in NameNodeEditLogRoller:
java.lang.IllegalStateException: Bad state: BETWEEN_LOG_SEGMENTS
	at com.google.common.base.Preconditions.checkState(Preconditions.java:172)
	at org.apache.hadoop.hdfs.server.namenode.FSEditLog.getCurSegmentTxId(FSEditLog.java:515)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem$NameNodeEditLogRoller.run(FSNamesystem.java:5181)
	at java.lang.Thread.run(Thread.java:745)
2016-09-12 17:14:50,201 INFO  namenode.FSNamesystem (FSNamesystem.java:startCheckpoint(6347)) - Start checkpoint for localhost:48689
2016-09-12 17:14:50,202 INFO  namenode.FSImage (FSImage.java:startCheckpoint(1333)) - Start checkpoint at txid 6
2016-09-12 17:14:50,202 INFO  namenode.FSEditLog (FSEditLog.java:rollEditLog(1202)) - Rolling edit logs
2016-09-12 17:14:50,202 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 5
2016-09-12 17:14:50,203 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 3 Total time for transactions(ms): 2 Number of transactions batched in Syncs: 0 Number of syncs: 4 SyncTimes(ms): 3 3 
2016-09-12 17:14:50,204 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000005 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:50,206 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000005 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:50,207 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 8
2016-09-12 17:14:50,287 DEBUG namenode.Checkpointer (Checkpointer.java:doCheckpoint(211)) - Doing checkpoint. Last applied: 0
2016-09-12 17:14:50,291 INFO  namenode.TransferFsImage (TransferFsImage.java:downloadEditsToStorage(154)) - Skipping download of remote edit log [1,2] since it already is stored locally at /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000001-0000000000000000002
2016-09-12 17:14:50,292 INFO  namenode.TransferFsImage (TransferFsImage.java:getFileClient(396)) - Opening connection to http://localhost:53667/imagetransfer?getedit=1&startTxId=3&endTxId=4&storageInfo=-63:52563361:0:testClusterID
2016-09-12 17:14:50,326 INFO  namenode.TransferFsImage (TransferFsImage.java:receiveFile(553)) - Transfer took 0.03s at 0.00 KB/s
2016-09-12 17:14:50,326 INFO  namenode.TransferFsImage (TransferFsImage.java:downloadEditsToStorage(168)) - Downloaded file edits_tmp_0000000000000000003-0000000000000000004_0000000000972383291 size 0 bytes.
2016-09-12 17:14:50,327 INFO  namenode.TransferFsImage (TransferFsImage.java:getFileClient(396)) - Opening connection to http://localhost:53667/imagetransfer?getedit=1&startTxId=5&endTxId=7&storageInfo=-63:52563361:0:testClusterID
2016-09-12 17:14:50,350 INFO  namenode.TransferFsImage (TransferFsImage.java:receiveFile(553)) - Transfer took 0.02s at 0.00 KB/s
2016-09-12 17:14:50,350 INFO  namenode.TransferFsImage (TransferFsImage.java:downloadEditsToStorage(168)) - Downloaded file edits_tmp_0000000000000000005-0000000000000000007_0000000000972383327 size 0 bytes.
2016-09-12 17:14:50,351 INFO  namenode.Checkpointer (Checkpointer.java:rollForwardByApplyingLogs(309)) - Checkpointer about to load edits from 3 stream(s).
2016-09-12 17:14:50,352 DEBUG namenode.FSImage (FSImage.java:loadEdits(834)) - About to load edits:
  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000001-0000000000000000002
  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000003-0000000000000000004
  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:50,352 INFO  namenode.FSImage (FSImage.java:loadEdits(844)) - Reading /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000001-0000000000000000002 expecting start txid #1
2016-09-12 17:14:50,352 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000001-0000000000000000002
2016-09-12 17:14:50,353 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_END_LOG_SEGMENT=1
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:50,353 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000001-0000000000000000002 of size 42 edits # 2 loaded in 0 seconds
2016-09-12 17:14:50,353 INFO  namenode.FSImage (FSImage.java:loadEdits(844)) - Reading /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000003-0000000000000000004 expecting start txid #3
2016-09-12 17:14:50,354 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000003-0000000000000000004
2016-09-12 17:14:50,354 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_END_LOG_SEGMENT=1
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:50,355 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000003-0000000000000000004 of size 42 edits # 2 loaded in 0 seconds
2016-09-12 17:14:50,355 INFO  namenode.FSImage (FSImage.java:loadEdits(844)) - Reading /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000005-0000000000000000007 expecting start txid #5
2016-09-12 17:14:50,355 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:50,356 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_DELETE=1
  OP_END_LOG_SEGMENT=1
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:50,357 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000005-0000000000000000007 of size 106 edits # 3 loaded in 0 seconds
2016-09-12 17:14:50,357 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2016-09-12 17:14:50,398 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/fsimage.ckpt_0000000000000000007 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/fsimage_0000000000000000007
2016-09-12 17:14:50,399 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 2
2016-09-12 17:14:50,434 INFO  namenode.TransferFsImage (TransferFsImage.java:receiveFile(553)) - Transfer took 0.02s at 0.00 KB/s
2016-09-12 17:14:50,435 INFO  namenode.TransferFsImage (TransferFsImage.java:handleUploadImageRequest(134)) - Downloaded file fsimage.ckpt_0000000000000000007 size 350 bytes.
2016-09-12 17:14:50,475 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage.ckpt_0000000000000000007 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000007
2016-09-12 17:14:50,475 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage.ckpt_0000000000000000007 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000007
2016-09-12 17:14:50,477 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 4
2016-09-12 17:14:50,477 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000002, cpktTxId=0000000000000000002)
2016-09-12 17:14:50,478 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000002, cpktTxId=0000000000000000002)
2016-09-12 17:14:50,481 INFO  namenode.TransferFsImage (TransferFsImage.java:uploadImageFromStorage(237)) - Uploaded image with txid 7 to namenode at http://localhost:53667 in 0.073 seconds
2016-09-12 17:14:50,484 INFO  namenode.FSNamesystem (FSNamesystem.java:endCheckpoint(6375)) - End checkpoint for localhost:48689
2016-09-12 17:14:50,484 INFO  namenode.FSImage (FSImage.java:endCheckpoint(1373)) - End checkpoint at txid 8
2016-09-12 17:14:50,485 INFO  namenode.Checkpointer (Checkpointer.java:doCheckpoint(278)) - Checkpoint completed in 0 seconds. New Image Size: 350
2016-09-12 17:14:51,195 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(462)) - examining name dir with files: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000007,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000007.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000003-0000000000000000004,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000001-0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000004.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/VERSION,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000008,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000004,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/seen_txid,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:51,195 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(465)) - Examining storage dir /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current with contents: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000007, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000007.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000003-0000000000000000004, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000001-0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000004.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/VERSION, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000008, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000004, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/seen_txid, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:51,196 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(462)) - examining name dir with files: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000007,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000007.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000003-0000000000000000004,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000001-0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000004.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/VERSION,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000008,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000004,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/seen_txid,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:51,196 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(465)) - Examining storage dir /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current with contents: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000007, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000007.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000003-0000000000000000004, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000001-0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000004.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/VERSION, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000008, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000004, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/seen_txid, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:51,201 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/user/root/file_0	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:51,205 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/user/root/file_1	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:51,208 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/user/root/file_2	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:51,211 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/user/root/file_3	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:51,214 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/user/root/file_4	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:51,217 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/user/root/file_5	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:51,219 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/user/root/file_6	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:51,222 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/user/root/file_7	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:51,225 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/user/root/file_8	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:51,228 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/user/root/file_9	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:51,231 INFO  namenode.FSNamesystem (FSNamesystem.java:startCheckpoint(6347)) - Start checkpoint for localhost:48689
2016-09-12 17:14:51,231 INFO  namenode.FSImage (FSImage.java:startCheckpoint(1333)) - Start checkpoint at txid 8
2016-09-12 17:14:51,231 INFO  namenode.FSEditLog (FSEditLog.java:rollEditLog(1202)) - Rolling edit logs
2016-09-12 17:14:51,231 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 8
2016-09-12 17:14:51,232 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 2 Total time for transactions(ms): 0 Number of transactions batched in Syncs: 1 Number of syncs: 3 SyncTimes(ms): 3 2 
2016-09-12 17:14:51,233 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000008 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000008-0000000000000000009
2016-09-12 17:14:51,234 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000008 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000008-0000000000000000009
2016-09-12 17:14:51,235 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 10
2016-09-12 17:14:51,317 DEBUG namenode.Checkpointer (Checkpointer.java:doCheckpoint(211)) - Doing checkpoint. Last applied: 7
2016-09-12 17:14:51,321 INFO  namenode.TransferFsImage (TransferFsImage.java:getFileClient(396)) - Opening connection to http://localhost:53667/imagetransfer?getedit=1&startTxId=8&endTxId=9&storageInfo=-63:52563361:0:testClusterID
2016-09-12 17:14:51,352 INFO  namenode.TransferFsImage (TransferFsImage.java:receiveFile(553)) - Transfer took 0.03s at 0.00 KB/s
2016-09-12 17:14:51,352 INFO  namenode.TransferFsImage (TransferFsImage.java:downloadEditsToStorage(168)) - Downloaded file edits_tmp_0000000000000000008-0000000000000000009_0000000000972384321 size 0 bytes.
2016-09-12 17:14:51,353 INFO  namenode.Checkpointer (Checkpointer.java:rollForwardByApplyingLogs(309)) - Checkpointer about to load edits from 1 stream(s).
2016-09-12 17:14:51,353 DEBUG namenode.FSImage (FSImage.java:loadEdits(834)) - About to load edits:
  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000008-0000000000000000009
2016-09-12 17:14:51,354 INFO  namenode.FSImage (FSImage.java:loadEdits(844)) - Reading /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000008-0000000000000000009 expecting start txid #8
2016-09-12 17:14:51,354 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000008-0000000000000000009
2016-09-12 17:14:51,355 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_END_LOG_SEGMENT=1
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:51,355 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000008-0000000000000000009 of size 42 edits # 2 loaded in 0 seconds
2016-09-12 17:14:51,404 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/fsimage.ckpt_0000000000000000009 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/fsimage_0000000000000000009
2016-09-12 17:14:51,405 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 7
2016-09-12 17:14:51,406 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/fsimage_0000000000000000002, cpktTxId=0000000000000000002)
2016-09-12 17:14:51,436 INFO  namenode.TransferFsImage (TransferFsImage.java:receiveFile(553)) - Transfer took 0.02s at 0.00 KB/s
2016-09-12 17:14:51,436 INFO  namenode.TransferFsImage (TransferFsImage.java:handleUploadImageRequest(134)) - Downloaded file fsimage.ckpt_0000000000000000009 size 350 bytes.
2016-09-12 17:14:51,473 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage.ckpt_0000000000000000009 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000009
2016-09-12 17:14:51,473 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage.ckpt_0000000000000000009 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000009
2016-09-12 17:14:51,475 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 7
2016-09-12 17:14:51,475 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000004, cpktTxId=0000000000000000004)
2016-09-12 17:14:51,476 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000004, cpktTxId=0000000000000000004)
2016-09-12 17:14:51,480 INFO  namenode.TransferFsImage (TransferFsImage.java:uploadImageFromStorage(237)) - Uploaded image with txid 9 to namenode at http://localhost:53667 in 0.068 seconds
2016-09-12 17:14:51,482 INFO  namenode.FSNamesystem (FSNamesystem.java:endCheckpoint(6375)) - End checkpoint for localhost:48689
2016-09-12 17:14:51,482 INFO  namenode.FSImage (FSImage.java:endCheckpoint(1373)) - End checkpoint at txid 10
2016-09-12 17:14:51,483 INFO  namenode.Checkpointer (Checkpointer.java:doCheckpoint(278)) - Checkpoint completed in 0 seconds. New Image Size: 350
2016-09-12 17:14:51,483 INFO  namenode.TestBackupNode (TestBackupNode.java:waitCheckpointDone(115)) - Waiting checkpoint to complete... checkpoint txid should increase above 8
2016-09-12 17:14:52,484 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(462)) - examining name dir with files: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000007,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000009,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000007.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000003-0000000000000000004,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000001-0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/VERSION,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000009.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000008-0000000000000000009,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/seen_txid,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000010,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:52,485 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(465)) - Examining storage dir /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current with contents: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000007, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000009, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000007.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000003-0000000000000000004, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000001-0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/VERSION, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000009.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000008-0000000000000000009, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/seen_txid, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000010, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:52,486 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(462)) - examining name dir with files: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000007,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000009,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000007.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000003-0000000000000000004,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000001-0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/VERSION,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000009.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000008-0000000000000000009,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/seen_txid,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000010,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:52,486 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(465)) - Examining storage dir /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current with contents: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000007, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000009, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000007.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000003-0000000000000000004, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000001-0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/VERSION, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000009.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000008-0000000000000000009, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/seen_txid, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000010, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000005-0000000000000000007
2016-09-12 17:14:52,488 INFO  namenode.FSNamesystem (FSNamesystem.java:startCheckpoint(6347)) - Start checkpoint for localhost:48689
2016-09-12 17:14:52,489 INFO  namenode.FSImage (FSImage.java:startCheckpoint(1333)) - Start checkpoint at txid 10
2016-09-12 17:14:52,489 INFO  namenode.FSEditLog (FSEditLog.java:rollEditLog(1202)) - Rolling edit logs
2016-09-12 17:14:52,489 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 10
2016-09-12 17:14:52,492 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 2 Total time for transactions(ms): 0 Number of transactions batched in Syncs: 1 Number of syncs: 3 SyncTimes(ms): 5 2 
2016-09-12 17:14:52,493 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000010 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000010-0000000000000000011
2016-09-12 17:14:52,494 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000010 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000010-0000000000000000011
2016-09-12 17:14:52,495 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 12
2016-09-12 17:14:52,654 DEBUG namenode.Checkpointer (Checkpointer.java:doCheckpoint(211)) - Doing checkpoint. Last applied: 9
2016-09-12 17:14:52,659 INFO  namenode.TransferFsImage (TransferFsImage.java:getFileClient(396)) - Opening connection to http://localhost:53667/imagetransfer?getedit=1&startTxId=10&endTxId=11&storageInfo=-63:52563361:0:testClusterID
2016-09-12 17:14:52,680 INFO  namenode.TransferFsImage (TransferFsImage.java:receiveFile(553)) - Transfer took 0.02s at 0.00 KB/s
2016-09-12 17:14:52,681 INFO  namenode.TransferFsImage (TransferFsImage.java:downloadEditsToStorage(168)) - Downloaded file edits_tmp_0000000000000000010-0000000000000000011_0000000000972385658 size 0 bytes.
2016-09-12 17:14:52,682 INFO  namenode.Checkpointer (Checkpointer.java:rollForwardByApplyingLogs(309)) - Checkpointer about to load edits from 1 stream(s).
2016-09-12 17:14:52,682 DEBUG namenode.FSImage (FSImage.java:loadEdits(834)) - About to load edits:
  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000010-0000000000000000011
2016-09-12 17:14:52,682 INFO  namenode.FSImage (FSImage.java:loadEdits(844)) - Reading /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000010-0000000000000000011 expecting start txid #10
2016-09-12 17:14:52,683 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000010-0000000000000000011
2016-09-12 17:14:52,684 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_END_LOG_SEGMENT=1
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:52,684 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/edits_0000000000000000010-0000000000000000011 of size 42 edits # 2 loaded in 0 seconds
2016-09-12 17:14:52,725 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/fsimage.ckpt_0000000000000000011 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/fsimage_0000000000000000011
2016-09-12 17:14:52,726 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 9
2016-09-12 17:14:52,727 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-checkpoint1/current/fsimage_0000000000000000007, cpktTxId=0000000000000000007)
2016-09-12 17:14:52,761 INFO  namenode.TransferFsImage (TransferFsImage.java:receiveFile(553)) - Transfer took 0.02s at 0.00 KB/s
2016-09-12 17:14:52,761 INFO  namenode.TransferFsImage (TransferFsImage.java:handleUploadImageRequest(134)) - Downloaded file fsimage.ckpt_0000000000000000011 size 350 bytes.
2016-09-12 17:14:52,797 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage.ckpt_0000000000000000011 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000011
2016-09-12 17:14:52,798 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage.ckpt_0000000000000000011 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000011
2016-09-12 17:14:52,799 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 9
2016-09-12 17:14:52,799 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000007, cpktTxId=0000000000000000007)
2016-09-12 17:14:52,800 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000007, cpktTxId=0000000000000000007)
2016-09-12 17:14:52,804 INFO  namenode.TransferFsImage (TransferFsImage.java:uploadImageFromStorage(237)) - Uploaded image with txid 11 to namenode at http://localhost:53667 in 0.07 seconds
2016-09-12 17:14:52,806 INFO  namenode.FSNamesystem (FSNamesystem.java:endCheckpoint(6375)) - End checkpoint for localhost:48689
2016-09-12 17:14:52,807 INFO  namenode.FSImage (FSImage.java:endCheckpoint(1373)) - End checkpoint at txid 12
2016-09-12 17:14:52,808 INFO  namenode.Checkpointer (Checkpointer.java:doCheckpoint(278)) - Checkpoint completed in 0 seconds. New Image Size: 350
2016-09-12 17:14:52,808 INFO  namenode.TestBackupNode (TestBackupNode.java:waitCheckpointDone(115)) - Waiting checkpoint to complete... checkpoint txid should increase above 10
2016-09-12 17:14:53,809 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(462)) - examining name dir with files: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000011.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000009,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000003-0000000000000000004,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000001-0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000011,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/VERSION,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000009.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000008-0000000000000000009,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000012,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/seen_txid,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000005-0000000000000000007,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000010-0000000000000000011
2016-09-12 17:14:53,810 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(465)) - Examining storage dir /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current with contents: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000011.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000009, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000003-0000000000000000004, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000001-0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000011, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/VERSION, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000009.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000008-0000000000000000009, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000012, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/seen_txid, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000005-0000000000000000007, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000010-0000000000000000011
2016-09-12 17:14:53,810 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(462)) - examining name dir with files: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000011.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000009,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000003-0000000000000000004,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000001-0000000000000000002,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000011,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/VERSION,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000009.md5,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000008-0000000000000000009,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000012,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/seen_txid,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000005-0000000000000000007,/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000010-0000000000000000011
2016-09-12 17:14:53,811 INFO  namenode.FSImageTestUtil (FSImageTestUtil.java:assertNNHasCheckpoints(465)) - Examining storage dir /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current with contents: /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000011.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000009, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000003-0000000000000000004, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000001-0000000000000000002, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000011, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/VERSION, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000009.md5, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000008-0000000000000000009, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000012, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/seen_txid, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000005-0000000000000000007, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000010-0000000000000000011
2016-09-12 17:14:53,824 INFO  ipc.Server (Server.java:run(2063)) - IPC Server handler 0 on 48689, call org.apache.hadoop.hdfs.protocol.ClientProtocol.create from 127.0.0.1:38323 Call#185 Retry#0: org.apache.hadoop.ipc.StandbyException: Operation category WRITE is not supported at Checkpoint Node
2016-09-12 17:14:53,826 INFO  namenode.TestBackupNode (TestBackupNode.java:testCheckpoint(357)) - Write to Checkpoint Node failed as expected: 
org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.ipc.StandbyException): Operation category WRITE is not supported at Checkpoint Node
	at org.apache.hadoop.hdfs.server.namenode.BackupNode$BNHAContext.checkOperation(BackupNode.java:442)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.checkOperation(FSNamesystem.java:1333)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.startFileInt(FSNamesystem.java:2596)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.startFile(FSNamesystem.java:2552)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.create(NameNodeRpcServer.java:623)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.create(ClientNamenodeProtocolServerSideTranslatorPB.java:397)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:616)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:969)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2049)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2045)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1657)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2043)

	at org.apache.hadoop.ipc.Client.call(Client.java:1476)
	at org.apache.hadoop.ipc.Client.call(Client.java:1407)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:229)
	at com.sun.proxy.$Proxy15.create(Unknown Source)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.create(ClientNamenodeProtocolTranslatorPB.java:296)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:187)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:102)
	at com.sun.proxy.$Proxy16.create(Unknown Source)
	at org.apache.hadoop.hdfs.DFSOutputStream.newStreamForCreate(DFSOutputStream.java:1623)
	at org.apache.hadoop.hdfs.DFSClient.create(DFSClient.java:1703)
	at org.apache.hadoop.hdfs.DFSClient.create(DFSClient.java:1638)
	at org.apache.hadoop.hdfs.DistributedFileSystem$7.doCall(DistributedFileSystem.java:448)
	at org.apache.hadoop.hdfs.DistributedFileSystem$7.doCall(DistributedFileSystem.java:444)
	at org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)
	at org.apache.hadoop.hdfs.DistributedFileSystem.create(DistributedFileSystem.java:444)
	at org.apache.hadoop.hdfs.DistributedFileSystem.create(DistributedFileSystem.java:387)
	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:909)
	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:890)
	at org.apache.hadoop.hdfs.server.namenode.TestCheckpoint.writeFile(TestCheckpoint.java:143)
	at org.apache.hadoop.hdfs.server.namenode.TestBackupNode.testCheckpoint(TestBackupNode.java:355)
	at org.apache.hadoop.hdfs.server.namenode.TestBackupNode.testCheckpointNode(TestBackupNode.java:130)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:264)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:153)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:200)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:153)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:103)
2016-09-12 17:14:53,830 INFO  ipc.Server (Server.java:run(2063)) - IPC Server handler 1 on 48689, call org.apache.hadoop.hdfs.protocol.ClientProtocol.getFileInfo from 127.0.0.1:38323 Call#186 Retry#0: org.apache.hadoop.ipc.StandbyException: Operation category READ is not supported at Checkpoint Node
2016-09-12 17:14:53,834 INFO  namenode.TestBackupNode (TestBackupNode.java:testCheckpoint(367)) - Read from Checkpoint Node failed: 
org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.ipc.StandbyException): Operation category READ is not supported at Checkpoint Node
	at org.apache.hadoop.hdfs.server.namenode.BackupNode$BNHAContext.checkOperation(BackupNode.java:442)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.checkOperation(FSNamesystem.java:1333)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.getFileInfo(FSNamesystem.java:4271)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.getFileInfo(NameNodeRpcServer.java:1007)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.getFileInfo(ClientNamenodeProtocolServerSideTranslatorPB.java:843)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:616)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:969)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2049)
	at org.apache.hadoop.ipc.Server$Handler$1.run(Server.java:2045)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1657)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2043)

	at org.apache.hadoop.ipc.Client.call(Client.java:1476)
	at org.apache.hadoop.ipc.Client.call(Client.java:1407)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:229)
	at com.sun.proxy.$Proxy15.getFileInfo(Unknown Source)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.getFileInfo(ClientNamenodeProtocolTranslatorPB.java:771)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:187)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:102)
	at com.sun.proxy.$Proxy16.getFileInfo(Unknown Source)
	at org.apache.hadoop.hdfs.DFSClient.getFileInfo(DFSClient.java:2116)
	at org.apache.hadoop.hdfs.DistributedFileSystem$22.doCall(DistributedFileSystem.java:1305)
	at org.apache.hadoop.hdfs.DistributedFileSystem$22.doCall(DistributedFileSystem.java:1301)
	at org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)
	at org.apache.hadoop.hdfs.DistributedFileSystem.getFileStatus(DistributedFileSystem.java:1301)
	at org.apache.hadoop.fs.FileSystem.exists(FileSystem.java:1424)
	at org.apache.hadoop.hdfs.server.namenode.TestBackupNode.testCheckpoint(TestBackupNode.java:365)
	at org.apache.hadoop.hdfs.server.namenode.TestBackupNode.testCheckpointNode(TestBackupNode.java:130)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:264)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:153)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:200)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:153)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:103)
2016-09-12 17:14:53,840 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/backup.dat	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:53,857 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1237998748_1 to complete inode 688171(/backup.dat) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:53,858 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /backup.dat is closed by DFSClient_NONMAPREDUCE_1237998748_1
2016-09-12 17:14:53,860 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/backup.dat	dst=null	perm=null	proto=rpc
2016-09-12 17:14:53,863 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/backup.dat	dst=null	perm=null	proto=rpc
2016-09-12 17:14:53,865 INFO  namenode.NameNode (NameNodeRpcServer.java:errorReport(501)) - Error report from NamenodeRegistration(localhost:48689, role=Checkpoint Node): Shutting down.
SEEEEEEEEEEEEEEEEEEEEETcheckpointManager null
2016-09-12 17:14:53,866 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:53,867 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5269)) - LazyPersistFileScrubber was interrupted, exiting
2016-09-12 17:14:53,868 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 48689
2016-09-12 17:14:53,867 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5196)) - NameNodeEditLogRoller was interrupted, exiting
2016-09-12 17:14:53,870 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 48689
2016-09-12 17:14:53,872 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:53,872 INFO  blockmanagement.BlockManager (BlockManager.java:run(3636)) - Stopping ReplicationMonitor.
2016-09-12 17:14:53,882 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:53,883 INFO  namenode.FSNamesystem (FSNamesystem.java:stopStandbyServices(1317)) - Stopping services started for standby state
2016-09-12 17:14:53,891 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:53,997 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdown(1712)) - Shutting down the Mini HDFS Cluster
2016-09-12 17:14:53,997 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdownDataNodes(1744)) - Shutting down DataNode 2
2016-09-12 17:14:53,997 WARN  datanode.DirectoryScanner (DirectoryScanner.java:shutdown(378)) - DirectoryScanner: shutdown has been called
2016-09-12 17:14:54,007 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:54,108 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 56179
2016-09-12 17:14:54,109 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:54,109 WARN  datanode.DataNode (BPServiceActor.java:offerService(704)) - BPOfferService for Block pool BP-874534698-192.168.9.78-1473671687007 (Datanode Uuid 8ed2a606-46d4-4782-89a7-147deec1c7ca) service to localhost/127.0.0.1:42394 interrupted
2016-09-12 17:14:54,110 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 56179
2016-09-12 17:14:54,110 WARN  datanode.DataNode (BPServiceActor.java:run(834)) - Ending block pool service for: Block pool BP-874534698-192.168.9.78-1473671687007 (Datanode Uuid 8ed2a606-46d4-4782-89a7-147deec1c7ca) service to localhost/127.0.0.1:42394
2016-09-12 17:14:54,111 INFO  datanode.DataNode (BlockPoolManager.java:remove(103)) - Removed Block pool BP-874534698-192.168.9.78-1473671687007 (Datanode Uuid 8ed2a606-46d4-4782-89a7-147deec1c7ca)
2016-09-12 17:14:54,111 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:shutdownBlockPool(2484)) - Removing block pool BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:54,113 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:run(2955)) - LazyWriter was interrupted, exiting
2016-09-12 17:14:54,114 INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(184)) - Shutting down all async disk service threads
2016-09-12 17:14:54,114 INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(192)) - All async disk service threads have been shut down
2016-09-12 17:14:54,115 INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(162)) - Shutting down all async lazy persist service threads
2016-09-12 17:14:54,115 INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(169)) - All async lazy persist service threads have been shut down
2016-09-12 17:14:54,116 INFO  datanode.DataNode (DataNode.java:shutdown(1827)) - Shutdown complete.
2016-09-12 17:14:54,116 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdownDataNodes(1744)) - Shutting down DataNode 1
2016-09-12 17:14:54,116 WARN  datanode.DirectoryScanner (DirectoryScanner.java:shutdown(378)) - DirectoryScanner: shutdown has been called
2016-09-12 17:14:54,122 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:54,223 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 59653
2016-09-12 17:14:54,224 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 59653
2016-09-12 17:14:54,226 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:54,226 WARN  datanode.DataNode (BPServiceActor.java:offerService(704)) - BPOfferService for Block pool BP-874534698-192.168.9.78-1473671687007 (Datanode Uuid 1a5a6641-c868-4b2e-a9f9-3adc5d0cc714) service to localhost/127.0.0.1:42394 interrupted
2016-09-12 17:14:54,226 WARN  datanode.DataNode (BPServiceActor.java:run(834)) - Ending block pool service for: Block pool BP-874534698-192.168.9.78-1473671687007 (Datanode Uuid 1a5a6641-c868-4b2e-a9f9-3adc5d0cc714) service to localhost/127.0.0.1:42394
2016-09-12 17:14:54,226 INFO  datanode.DataNode (BlockPoolManager.java:remove(103)) - Removed Block pool BP-874534698-192.168.9.78-1473671687007 (Datanode Uuid 1a5a6641-c868-4b2e-a9f9-3adc5d0cc714)
2016-09-12 17:14:54,227 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:shutdownBlockPool(2484)) - Removing block pool BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:54,229 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:run(2955)) - LazyWriter was interrupted, exiting
2016-09-12 17:14:54,229 INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(184)) - Shutting down all async disk service threads
2016-09-12 17:14:54,230 INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(192)) - All async disk service threads have been shut down
2016-09-12 17:14:54,230 INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(162)) - Shutting down all async lazy persist service threads
2016-09-12 17:14:54,230 INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(169)) - All async lazy persist service threads have been shut down
2016-09-12 17:14:54,231 INFO  datanode.DataNode (DataNode.java:shutdown(1827)) - Shutdown complete.
2016-09-12 17:14:54,232 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdownDataNodes(1744)) - Shutting down DataNode 0
2016-09-12 17:14:54,232 WARN  datanode.DirectoryScanner (DirectoryScanner.java:shutdown(378)) - DirectoryScanner: shutdown has been called
2016-09-12 17:14:54,246 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:54,348 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 34825
2016-09-12 17:14:54,349 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 34825
2016-09-12 17:14:54,350 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:54,350 WARN  datanode.DataNode (BPServiceActor.java:offerService(704)) - BPOfferService for Block pool BP-874534698-192.168.9.78-1473671687007 (Datanode Uuid 01b352c0-fc14-4f31-b37a-c54ed9bbadf3) service to localhost/127.0.0.1:42394 interrupted
2016-09-12 17:14:54,351 WARN  datanode.DataNode (BPServiceActor.java:run(834)) - Ending block pool service for: Block pool BP-874534698-192.168.9.78-1473671687007 (Datanode Uuid 01b352c0-fc14-4f31-b37a-c54ed9bbadf3) service to localhost/127.0.0.1:42394
2016-09-12 17:14:54,351 INFO  datanode.DataNode (BlockPoolManager.java:remove(103)) - Removed Block pool BP-874534698-192.168.9.78-1473671687007 (Datanode Uuid 01b352c0-fc14-4f31-b37a-c54ed9bbadf3)
2016-09-12 17:14:54,351 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:shutdownBlockPool(2484)) - Removing block pool BP-874534698-192.168.9.78-1473671687007
2016-09-12 17:14:54,354 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:run(2955)) - LazyWriter was interrupted, exiting
2016-09-12 17:14:54,355 INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(184)) - Shutting down all async disk service threads
2016-09-12 17:14:54,355 INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(192)) - All async disk service threads have been shut down
2016-09-12 17:14:54,355 INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(162)) - Shutting down all async lazy persist service threads
2016-09-12 17:14:54,356 INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(169)) - All async lazy persist service threads have been shut down
2016-09-12 17:14:54,357 INFO  datanode.DataNode (DataNode.java:shutdown(1827)) - Shutdown complete.
2016-09-12 17:14:54,357 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:54,358 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5269)) - LazyPersistFileScrubber was interrupted, exiting
2016-09-12 17:14:54,358 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5196)) - NameNodeEditLogRoller was interrupted, exiting
2016-09-12 17:14:54,358 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 12
2016-09-12 17:14:54,359 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 4 Total time for transactions(ms): 1 Number of transactions batched in Syncs: 1 Number of syncs: 5 SyncTimes(ms): 3 3 
2016-09-12 17:14:54,361 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000012 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000012-0000000000000000015
2016-09-12 17:14:54,362 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000012 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000012-0000000000000000015
2016-09-12 17:14:54,363 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 42394
2016-09-12 17:14:54,364 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 42394
2016-09-12 17:14:54,369 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:54,370 INFO  blockmanagement.BlockManager (BlockManager.java:run(3636)) - Stopping ReplicationMonitor.
2016-09-12 17:14:54,380 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:54,381 INFO  namenode.FSNamesystem (FSNamesystem.java:stopStandbyServices(1317)) - Stopping services started for standby state
2016-09-12 17:14:54,385 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:54,485 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(211)) - Stopping CheckpointNode metrics system...
2016-09-12 17:14:54,488 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(217)) - CheckpointNode metrics system stopped.
2016-09-12 17:14:54,488 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:shutdown(606)) - CheckpointNode metrics system shutdown complete.
2016-09-12 17:14:54,498 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:<init>(446)) - starting cluster: numNameNodes=1, numDataNodes=0
2016-09-12 17:14:54,500 INFO  namenode.NameNode (NameNode.java:createNameNode(1419)) - createNameNode []
2016-09-12 17:14:54,501 WARN  impl.MetricsConfig (MetricsConfig.java:loadFirst(125)) - Cannot locate configuration: tried hadoop-metrics2-namenode.properties,hadoop-metrics2.properties
2016-09-12 17:14:54,505 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:startTimer(377)) - Scheduled snapshot period at 10 second(s).
2016-09-12 17:14:54,505 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:start(192)) - NameNode metrics system started
2016-09-12 17:14:54,506 INFO  namenode.NameNode (NameNode.java:setClientNamenodeAddress(399)) - fs.defaultFS is hdfs://127.0.0.1:0
2016-09-12 17:14:54,516 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1703)) - Starting Web-server for hdfs at: http://localhost:0
2016-09-12 17:14:54,519 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:54,520 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.namenode is not defined
2016-09-12 17:14:54,521 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:54,522 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hdfs
2016-09-12 17:14:54,522 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:54,523 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:54,524 INFO  http.HttpServer2 (NameNodeHttpServer.java:initWebHdfs(86)) - Added filter 'org.apache.hadoop.hdfs.web.AuthFilter' (class=org.apache.hadoop.hdfs.web.AuthFilter)
2016-09-12 17:14:54,524 INFO  http.HttpServer2 (HttpServer2.java:addJerseyResourcePackage(609)) - addJerseyResourcePackage: packageName=org.apache.hadoop.hdfs.server.namenode.web.resources;org.apache.hadoop.hdfs.web.resources, pathSpec=/webhdfs/v1/*
2016-09-12 17:14:54,525 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 48687
2016-09-12 17:14:54,526 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:54,543 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:48687
2016-09-12 17:14:54,545 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(727)) - No KeyProvider found.
2016-09-12 17:14:54,546 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(737)) - fsLock is fair:true
2016-09-12 17:14:54,547 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(242)) - dfs.block.invalidate.limit=1000
2016-09-12 17:14:54,548 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(248)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2016-09-12 17:14:54,548 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(71)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2016-09-12 17:14:54,549 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(76)) - The block deletion will start around 2016 九月 12 17:14:54
2016-09-12 17:14:54,549 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map BlocksMap
2016-09-12 17:14:54,550 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:54,550 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 2.0% max memory 3.6 GB = 72.8 MB
2016-09-12 17:14:54,551 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^23 = 8388608 entries
2016-09-12 17:14:54,559 INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(365)) - dfs.block.access.token.enable=false
2016-09-12 17:14:54,560 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(350)) - defaultReplication         = 0
2016-09-12 17:14:54,560 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(351)) - maxReplication             = 512
2016-09-12 17:14:54,560 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(352)) - minReplication             = 1
2016-09-12 17:14:54,560 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(353)) - maxReplicationStreams      = 2
2016-09-12 17:14:54,561 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(354)) - shouldCheckForEnoughRacks  = false
2016-09-12 17:14:54,561 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(355)) - replicationRecheckInterval = 3000
2016-09-12 17:14:54,561 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(356)) - encryptDataTransfer        = false
2016-09-12 17:14:54,561 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(357)) - maxNumBlocksToLog          = 1000
2016-09-12 17:14:54,562 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(757)) - fsOwner             = root (auth:SIMPLE)
2016-09-12 17:14:54,562 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(758)) - supergroup          = supergroup
2016-09-12 17:14:54,562 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(759)) - isPermissionEnabled = true
2016-09-12 17:14:54,563 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(770)) - HA Enabled: false
2016-09-12 17:14:54,563 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(809)) - Append Enabled: true
2016-09-12 17:14:54,564 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map INodeMap
2016-09-12 17:14:54,564 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:54,564 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 1.0% max memory 3.6 GB = 36.4 MB
2016-09-12 17:14:54,565 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^22 = 4194304 entries
2016-09-12 17:14:54,569 INFO  namenode.FSDirectory (FSDirectory.java:<init>(235)) - ACLs enabled? false
2016-09-12 17:14:54,569 INFO  namenode.FSDirectory (FSDirectory.java:<init>(239)) - XAttrs enabled? true
2016-09-12 17:14:54,570 INFO  namenode.FSDirectory (FSDirectory.java:<init>(247)) - Maximum size of an xattr: 16384
2016-09-12 17:14:54,570 INFO  namenode.NameNode (FSDirectory.java:<init>(295)) - Caching file names occuring more than 10 times
2016-09-12 17:14:54,570 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map cachedBlocks
2016-09-12 17:14:54,571 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:54,571 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.25% max memory 3.6 GB = 9.1 MB
2016-09-12 17:14:54,571 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^20 = 1048576 entries
2016-09-12 17:14:54,573 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5664)) - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2016-09-12 17:14:54,573 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5665)) - dfs.namenode.safemode.min.datanodes = 0
2016-09-12 17:14:54,573 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5666)) - dfs.namenode.safemode.extension     = 0
2016-09-12 17:14:54,573 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:54,575 INFO  metrics.TopMetrics (TopMetrics.java:logConf(65)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2016-09-12 17:14:54,575 INFO  metrics.TopMetrics (TopMetrics.java:logConf(67)) - NNTop conf: dfs.namenode.top.num.users = 10
2016-09-12 17:14:54,575 INFO  metrics.TopMetrics (TopMetrics.java:logConf(69)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2016-09-12 17:14:54,575 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(920)) - Retry cache on namenode is enabled
2016-09-12 17:14:54,576 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(928)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2016-09-12 17:14:54,576 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map NameNodeRetryCache
2016-09-12 17:14:54,576 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:54,577 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.029999999329447746% max memory 3.6 GB = 1.1 MB
2016-09-12 17:14:54,577 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^17 = 131072 entries
2016-09-12 17:14:54,622 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:54,626 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:54,626 TRACE namenode.FSImage (FSImage.java:recoverTransitionRead(228)) - Data dir states:
  Storage Directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1: NORMAL
  Storage Directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2: NORMAL
2016-09-12 17:14:54,629 INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(362)) - Recovering unfinalized segments in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current
2016-09-12 17:14:54,630 INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(362)) - Recovering unfinalized segments in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current
2016-09-12 17:14:54,633 DEBUG namenode.FSImage (FSImage.java:loadFSImage(676)) - Planning to load edit log stream: org.apache.hadoop.hdfs.server.namenode.RedundantEditLogInputStream@71dfe402
2016-09-12 17:14:54,634 DEBUG namenode.FSImage (FSImage.java:loadFSImageFile(740)) - Planning to load image :
FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000011, cpktTxId=0000000000000000011)
2016-09-12 17:14:54,635 INFO  namenode.FSImageFormatPBINode (FSImageFormatPBINode.java:loadINodeSection(259)) - Loading 1 INodes.
2016-09-12 17:14:54,636 INFO  namenode.FSImageFormatProtobuf (FSImageFormatProtobuf.java:load(181)) - Loaded FSImage in 0 seconds.
2016-09-12 17:14:54,637 INFO  namenode.FSImage (FSImage.java:loadFSImage(982)) - Loaded image for txid 11 from /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000011
2016-09-12 17:14:54,637 DEBUG namenode.FSImage (FSImage.java:loadEdits(834)) - About to load edits:
  org.apache.hadoop.hdfs.server.namenode.RedundantEditLogInputStream@71dfe402
2016-09-12 17:14:54,637 INFO  namenode.FSImage (FSImage.java:loadEdits(844)) - Reading org.apache.hadoop.hdfs.server.namenode.RedundantEditLogInputStream@71dfe402 expecting start txid #12
2016-09-12 17:14:54,637 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000012-0000000000000000015, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000012-0000000000000000015
2016-09-12 17:14:54,638 INFO  namenode.EditLogInputStream (RedundantEditLogInputStream.java:nextOp(176)) - Fast-forwarding stream '/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000012-0000000000000000015' to transaction ID 12
2016-09-12 17:14:54,640 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
  OP_CLOSE=1
  OP_END_LOG_SEGMENT=1
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:54,640 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000012-0000000000000000015, /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000012-0000000000000000015 of size 267 edits # 4 loaded in 0 seconds
2016-09-12 17:14:54,640 INFO  namenode.FSNamesystem (FSNamesystem.java:loadFSImage(997)) - Need to save fs image? true (staleImage=true, haEnabled=false, isRollingUpgrade=false)
2016-09-12 17:14:54,641 INFO  namenode.FSImage (FSImage.java:saveNamespace(1102)) - Save namespace ...
2016-09-12 17:14:54,706 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage.ckpt_0000000000000000015 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000015
2016-09-12 17:14:54,707 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage.ckpt_0000000000000000015 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000015
2016-09-12 17:14:54,709 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 11
2016-09-12 17:14:54,709 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000009, cpktTxId=0000000000000000009)
2016-09-12 17:14:54,709 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000009, cpktTxId=0000000000000000009)
2016-09-12 17:14:54,724 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 16
2016-09-12 17:14:54,806 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2016-09-12 17:14:54,806 INFO  namenode.FSNamesystem (FSNamesystem.java:loadFromDisk(699)) - Finished loading FSImage in 227 msecs
2016-09-12 17:14:54,807 INFO  namenode.NameNode (NameNodeRpcServer.java:<init>(342)) - RPC server is binding to localhost:0
2016-09-12 17:14:54,808 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:54,809 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 60643
2016-09-12 17:14:54,815 INFO  namenode.NameNode (NameNode.java:initialize(654)) - Clients are to use localhost:60643 to access this namenode/service.
2016-09-12 17:14:54,816 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(6536)) - Registered FSNamesystemState MBean
2016-09-12 17:14:54,833 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:54,834 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:54,835 INFO  namenode.FSNamesystem (FSNamesystem.java:initializeReplQueues(1202)) - initializing replication queues
2016-09-12 17:14:54,835 INFO  hdfs.StateChange (FSNamesystem.java:leave(5739)) - STATE* Leaving safe mode after 0 secs
2016-09-12 17:14:54,836 INFO  hdfs.StateChange (FSNamesystem.java:leave(5751)) - STATE* Network topology has 0 racks and 0 datanodes
2016-09-12 17:14:54,836 INFO  hdfs.StateChange (FSNamesystem.java:leave(5754)) - STATE* UnderReplicatedBlocks has 0 blocks
2016-09-12 17:14:54,837 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:54,848 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2766)) - Total number of blocks            = 0
2016-09-12 17:14:54,849 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2767)) - Number of invalid blocks          = 0
2016-09-12 17:14:54,857 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2768)) - Number of under-replicated blocks = 0
2016-09-12 17:14:54,857 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2769)) - Number of  over-replicated blocks = 0
2016-09-12 17:14:54,857 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2771)) - Number of blocks being written    = 0
2016-09-12 17:14:54,858 INFO  hdfs.StateChange (BlockManager.java:processMisReplicatesAsync(2772)) - STATE* Replication Queue initialization scan for invalid, over- and under-replicated blocks completed in 22 msec
2016-09-12 17:14:54,871 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:54,871 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 60643: starting
2016-09-12 17:14:54,874 INFO  namenode.NameNode (NameNode.java:startCommonServices(697)) - NameNode RPC up at: localhost/127.0.0.1:60643
2016-09-12 17:14:54,874 INFO  namenode.FSNamesystem (FSNamesystem.java:startActiveServices(1123)) - Starting services required for active state
2016-09-12 17:14:54,882 INFO  blockmanagement.CacheReplicationMonitor (CacheReplicationMonitor.java:run(160)) - Starting CacheReplicationMonitor with interval 30000 milliseconds
2016-09-12 17:14:54,888 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2286)) - Cluster is active
2016-09-12 17:14:54,895 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/checkpoint.dat	dst=null	perm=null	proto=rpc
2016-09-12 17:14:54,899 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/checkpoint2.dat	dst=null	perm=null	proto=rpc
2016-09-12 17:14:54,900 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdown(1712)) - Shutting down the Mini HDFS Cluster
2016-09-12 17:14:54,900 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:54,901 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 16
2016-09-12 17:14:54,901 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5196)) - NameNodeEditLogRoller was interrupted, exiting
2016-09-12 17:14:54,901 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5269)) - LazyPersistFileScrubber was interrupted, exiting
2016-09-12 17:14:54,902 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 2 Total time for transactions(ms): 0 Number of transactions batched in Syncs: 0 Number of syncs: 3 SyncTimes(ms): 2 3 
2016-09-12 17:14:54,903 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000016 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000016-0000000000000000017
2016-09-12 17:14:54,904 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000016 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000016-0000000000000000017
2016-09-12 17:14:54,905 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 60643
2016-09-12 17:14:54,907 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 60643
2016-09-12 17:14:54,907 INFO  blockmanagement.BlockManager (BlockManager.java:run(3636)) - Stopping ReplicationMonitor.
2016-09-12 17:14:54,908 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:54,919 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:54,920 INFO  namenode.FSNamesystem (FSNamesystem.java:stopStandbyServices(1317)) - Stopping services started for standby state
2016-09-12 17:14:54,923 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:55,024 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(211)) - Stopping NameNode metrics system...
2016-09-12 17:14:55,025 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(217)) - NameNode metrics system stopped.
2016-09-12 17:14:55,025 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:shutdown(606)) - NameNode metrics system shutdown complete.
2016-09-12 17:14:55,058 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:<init>(446)) - starting cluster: numNameNodes=1, numDataNodes=1
Formatting using clusterid: testClusterID
2016-09-12 17:14:55,061 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(727)) - No KeyProvider found.
2016-09-12 17:14:55,061 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(737)) - fsLock is fair:true
2016-09-12 17:14:55,064 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(242)) - dfs.block.invalidate.limit=1000
2016-09-12 17:14:55,064 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(248)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2016-09-12 17:14:55,065 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(71)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2016-09-12 17:14:55,066 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(76)) - The block deletion will start around 2016 九月 12 17:14:55
2016-09-12 17:14:55,066 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map BlocksMap
2016-09-12 17:14:55,066 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:55,067 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 2.0% max memory 3.6 GB = 72.8 MB
2016-09-12 17:14:55,067 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^23 = 8388608 entries
2016-09-12 17:14:55,091 INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(365)) - dfs.block.access.token.enable=false
2016-09-12 17:14:55,092 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(350)) - defaultReplication         = 1
2016-09-12 17:14:55,092 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(351)) - maxReplication             = 512
2016-09-12 17:14:55,092 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(352)) - minReplication             = 1
2016-09-12 17:14:55,093 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(353)) - maxReplicationStreams      = 2
2016-09-12 17:14:55,093 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(354)) - shouldCheckForEnoughRacks  = false
2016-09-12 17:14:55,093 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(355)) - replicationRecheckInterval = 3000
2016-09-12 17:14:55,093 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(356)) - encryptDataTransfer        = false
2016-09-12 17:14:55,093 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(357)) - maxNumBlocksToLog          = 1000
2016-09-12 17:14:55,094 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(757)) - fsOwner             = root (auth:SIMPLE)
2016-09-12 17:14:55,094 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(758)) - supergroup          = supergroup
2016-09-12 17:14:55,094 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(759)) - isPermissionEnabled = true
2016-09-12 17:14:55,095 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(770)) - HA Enabled: false
2016-09-12 17:14:55,095 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(809)) - Append Enabled: true
2016-09-12 17:14:55,096 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map INodeMap
2016-09-12 17:14:55,096 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:55,097 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 1.0% max memory 3.6 GB = 36.4 MB
2016-09-12 17:14:55,097 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^22 = 4194304 entries
2016-09-12 17:14:55,102 INFO  namenode.FSDirectory (FSDirectory.java:<init>(235)) - ACLs enabled? false
2016-09-12 17:14:55,102 INFO  namenode.FSDirectory (FSDirectory.java:<init>(239)) - XAttrs enabled? true
2016-09-12 17:14:55,102 INFO  namenode.FSDirectory (FSDirectory.java:<init>(247)) - Maximum size of an xattr: 16384
2016-09-12 17:14:55,103 INFO  namenode.NameNode (FSDirectory.java:<init>(295)) - Caching file names occuring more than 10 times
2016-09-12 17:14:55,103 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map cachedBlocks
2016-09-12 17:14:55,103 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:55,104 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.25% max memory 3.6 GB = 9.1 MB
2016-09-12 17:14:55,104 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^20 = 1048576 entries
2016-09-12 17:14:55,106 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5664)) - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2016-09-12 17:14:55,106 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5665)) - dfs.namenode.safemode.min.datanodes = 0
2016-09-12 17:14:55,106 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5666)) - dfs.namenode.safemode.extension     = 0
2016-09-12 17:14:55,106 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:55,107 INFO  metrics.TopMetrics (TopMetrics.java:logConf(65)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2016-09-12 17:14:55,108 INFO  metrics.TopMetrics (TopMetrics.java:logConf(67)) - NNTop conf: dfs.namenode.top.num.users = 10
2016-09-12 17:14:55,108 INFO  metrics.TopMetrics (TopMetrics.java:logConf(69)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2016-09-12 17:14:55,108 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(920)) - Retry cache on namenode is enabled
2016-09-12 17:14:55,109 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(928)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2016-09-12 17:14:55,109 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map NameNodeRetryCache
2016-09-12 17:14:55,109 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:55,110 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.029999999329447746% max memory 3.6 GB = 1.1 MB
2016-09-12 17:14:55,110 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^17 = 131072 entries
2016-09-12 17:14:55,113 INFO  namenode.FSImage (FSImage.java:format(168)) - Allocated new BlockPoolId: BP-457114912-192.168.9.78-1473671695113
2016-09-12 17:14:55,150 INFO  common.Storage (NNStorage.java:format(552)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1 has been successfully formatted.
2016-09-12 17:14:55,182 INFO  common.Storage (NNStorage.java:format(552)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2 has been successfully formatted.
2016-09-12 17:14:55,235 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage.ckpt_0000000000000000000 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000
2016-09-12 17:14:55,235 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage.ckpt_0000000000000000000 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000000
2016-09-12 17:14:55,237 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 1 images with txid >= 0
2016-09-12 17:14:55,238 INFO  namenode.NameNode (NameNode.java:createNameNode(1419)) - createNameNode []
2016-09-12 17:14:55,240 WARN  impl.MetricsConfig (MetricsConfig.java:loadFirst(125)) - Cannot locate configuration: tried hadoop-metrics2-namenode.properties,hadoop-metrics2.properties
2016-09-12 17:14:55,243 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:startTimer(377)) - Scheduled snapshot period at 10 second(s).
2016-09-12 17:14:55,243 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:start(192)) - NameNode metrics system started
2016-09-12 17:14:55,244 INFO  namenode.NameNode (NameNode.java:setClientNamenodeAddress(399)) - fs.defaultFS is hdfs://127.0.0.1:0
2016-09-12 17:14:55,254 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1703)) - Starting Web-server for hdfs at: http://localhost:0
2016-09-12 17:14:55,256 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:55,256 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.namenode is not defined
2016-09-12 17:14:55,257 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:55,258 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hdfs
2016-09-12 17:14:55,258 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:55,259 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:55,260 INFO  http.HttpServer2 (NameNodeHttpServer.java:initWebHdfs(86)) - Added filter 'org.apache.hadoop.hdfs.web.AuthFilter' (class=org.apache.hadoop.hdfs.web.AuthFilter)
2016-09-12 17:14:55,260 INFO  http.HttpServer2 (HttpServer2.java:addJerseyResourcePackage(609)) - addJerseyResourcePackage: packageName=org.apache.hadoop.hdfs.server.namenode.web.resources;org.apache.hadoop.hdfs.web.resources, pathSpec=/webhdfs/v1/*
2016-09-12 17:14:55,261 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 48395
2016-09-12 17:14:55,262 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:55,279 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:48395
2016-09-12 17:14:55,281 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(727)) - No KeyProvider found.
2016-09-12 17:14:55,281 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(737)) - fsLock is fair:true
2016-09-12 17:14:55,282 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(242)) - dfs.block.invalidate.limit=1000
2016-09-12 17:14:55,283 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(248)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2016-09-12 17:14:55,283 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(71)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2016-09-12 17:14:55,284 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(76)) - The block deletion will start around 2016 九月 12 17:14:55
2016-09-12 17:14:55,284 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map BlocksMap
2016-09-12 17:14:55,284 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:55,285 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 2.0% max memory 3.6 GB = 72.8 MB
2016-09-12 17:14:55,285 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^23 = 8388608 entries
2016-09-12 17:14:55,293 INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(365)) - dfs.block.access.token.enable=false
2016-09-12 17:14:55,294 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(350)) - defaultReplication         = 1
2016-09-12 17:14:55,294 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(351)) - maxReplication             = 512
2016-09-12 17:14:55,295 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(352)) - minReplication             = 1
2016-09-12 17:14:55,295 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(353)) - maxReplicationStreams      = 2
2016-09-12 17:14:55,295 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(354)) - shouldCheckForEnoughRacks  = false
2016-09-12 17:14:55,295 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(355)) - replicationRecheckInterval = 3000
2016-09-12 17:14:55,296 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(356)) - encryptDataTransfer        = false
2016-09-12 17:14:55,296 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(357)) - maxNumBlocksToLog          = 1000
2016-09-12 17:14:55,296 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(757)) - fsOwner             = root (auth:SIMPLE)
2016-09-12 17:14:55,296 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(758)) - supergroup          = supergroup
2016-09-12 17:14:55,297 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(759)) - isPermissionEnabled = true
2016-09-12 17:14:55,297 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(770)) - HA Enabled: false
2016-09-12 17:14:55,298 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(809)) - Append Enabled: true
2016-09-12 17:14:55,298 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map INodeMap
2016-09-12 17:14:55,298 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:55,299 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 1.0% max memory 3.6 GB = 36.4 MB
2016-09-12 17:14:55,299 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^22 = 4194304 entries
2016-09-12 17:14:55,304 INFO  namenode.FSDirectory (FSDirectory.java:<init>(235)) - ACLs enabled? false
2016-09-12 17:14:55,304 INFO  namenode.FSDirectory (FSDirectory.java:<init>(239)) - XAttrs enabled? true
2016-09-12 17:14:55,304 INFO  namenode.FSDirectory (FSDirectory.java:<init>(247)) - Maximum size of an xattr: 16384
2016-09-12 17:14:55,305 INFO  namenode.NameNode (FSDirectory.java:<init>(295)) - Caching file names occuring more than 10 times
2016-09-12 17:14:55,305 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map cachedBlocks
2016-09-12 17:14:55,305 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:55,306 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.25% max memory 3.6 GB = 9.1 MB
2016-09-12 17:14:55,306 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^20 = 1048576 entries
2016-09-12 17:14:55,307 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5664)) - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2016-09-12 17:14:55,308 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5665)) - dfs.namenode.safemode.min.datanodes = 0
2016-09-12 17:14:55,308 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5666)) - dfs.namenode.safemode.extension     = 0
2016-09-12 17:14:55,308 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:55,309 INFO  metrics.TopMetrics (TopMetrics.java:logConf(65)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2016-09-12 17:14:55,309 INFO  metrics.TopMetrics (TopMetrics.java:logConf(67)) - NNTop conf: dfs.namenode.top.num.users = 10
2016-09-12 17:14:55,309 INFO  metrics.TopMetrics (TopMetrics.java:logConf(69)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2016-09-12 17:14:55,310 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(920)) - Retry cache on namenode is enabled
2016-09-12 17:14:55,310 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(928)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2016-09-12 17:14:55,310 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map NameNodeRetryCache
2016-09-12 17:14:55,311 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:55,311 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.029999999329447746% max memory 3.6 GB = 1.1 MB
2016-09-12 17:14:55,311 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^17 = 131072 entries
2016-09-12 17:14:55,334 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:55,354 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:55,355 TRACE namenode.FSImage (FSImage.java:recoverTransitionRead(228)) - Data dir states:
  Storage Directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1: NORMAL
  Storage Directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2: NORMAL
2016-09-12 17:14:55,357 INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(362)) - Recovering unfinalized segments in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current
2016-09-12 17:14:55,357 INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(362)) - Recovering unfinalized segments in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current
2016-09-12 17:14:55,358 INFO  namenode.FSImage (FSImage.java:loadFSImage(679)) - No edit log streams selected.
2016-09-12 17:14:55,359 DEBUG namenode.FSImage (FSImage.java:loadFSImageFile(740)) - Planning to load image :
FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000, cpktTxId=0000000000000000000)
2016-09-12 17:14:55,360 INFO  namenode.FSImageFormatPBINode (FSImageFormatPBINode.java:loadINodeSection(259)) - Loading 1 INodes.
2016-09-12 17:14:55,361 INFO  namenode.FSImageFormatProtobuf (FSImageFormatProtobuf.java:load(181)) - Loaded FSImage in 0 seconds.
2016-09-12 17:14:55,362 INFO  namenode.FSImage (FSImage.java:loadFSImage(982)) - Loaded image for txid 0 from /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000
2016-09-12 17:14:55,362 DEBUG namenode.FSImage (FSImage.java:loadEdits(834)) - About to load edits:
  
2016-09-12 17:14:55,362 INFO  namenode.FSNamesystem (FSNamesystem.java:loadFSImage(997)) - Need to save fs image? false (staleImage=false, haEnabled=false, isRollingUpgrade=false)
2016-09-12 17:14:55,363 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 1
2016-09-12 17:14:55,435 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2016-09-12 17:14:55,435 INFO  namenode.FSNamesystem (FSNamesystem.java:loadFromDisk(699)) - Finished loading FSImage in 122 msecs
2016-09-12 17:14:55,436 INFO  namenode.NameNode (NameNodeRpcServer.java:<init>(342)) - RPC server is binding to localhost:0
2016-09-12 17:14:55,436 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:55,438 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 60114
2016-09-12 17:14:55,443 INFO  namenode.NameNode (NameNode.java:initialize(654)) - Clients are to use localhost:60114 to access this namenode/service.
2016-09-12 17:14:55,444 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(6536)) - Registered FSNamesystemState MBean
2016-09-12 17:14:55,462 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:55,462 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:55,462 INFO  namenode.FSNamesystem (FSNamesystem.java:initializeReplQueues(1202)) - initializing replication queues
2016-09-12 17:14:55,463 INFO  hdfs.StateChange (FSNamesystem.java:leave(5739)) - STATE* Leaving safe mode after 0 secs
2016-09-12 17:14:55,463 INFO  hdfs.StateChange (FSNamesystem.java:leave(5751)) - STATE* Network topology has 0 racks and 0 datanodes
2016-09-12 17:14:55,464 INFO  hdfs.StateChange (FSNamesystem.java:leave(5754)) - STATE* UnderReplicatedBlocks has 0 blocks
2016-09-12 17:14:55,468 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:55,485 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2766)) - Total number of blocks            = 0
2016-09-12 17:14:55,486 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2767)) - Number of invalid blocks          = 0
2016-09-12 17:14:55,486 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2768)) - Number of under-replicated blocks = 0
2016-09-12 17:14:55,486 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2769)) - Number of  over-replicated blocks = 0
2016-09-12 17:14:55,487 INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(2771)) - Number of blocks being written    = 0
2016-09-12 17:14:55,487 INFO  hdfs.StateChange (BlockManager.java:processMisReplicatesAsync(2772)) - STATE* Replication Queue initialization scan for invalid, over- and under-replicated blocks completed in 24 msec
2016-09-12 17:14:55,499 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:55,499 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 60114: starting
2016-09-12 17:14:55,501 INFO  namenode.NameNode (NameNode.java:startCommonServices(697)) - NameNode RPC up at: localhost/127.0.0.1:60114
2016-09-12 17:14:55,502 INFO  namenode.FSNamesystem (FSNamesystem.java:startActiveServices(1123)) - Starting services required for active state
2016-09-12 17:14:55,509 INFO  blockmanagement.CacheReplicationMonitor (CacheReplicationMonitor.java:run(160)) - Starting CacheReplicationMonitor with interval 30000 milliseconds
2016-09-12 17:14:55,510 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:startDataNodes(1413)) - Starting DataNode 0 with dfs.datanode.data.dir: [DISK]file:/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1,[DISK]file:/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2
2016-09-12 17:14:55,523 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(159)) - DataNode metrics system started (again)
2016-09-12 17:14:55,524 INFO  datanode.BlockScanner (BlockScanner.java:<init>(172)) - Initialized block scanner with targetBytesPerSec 1048576
2016-09-12 17:14:55,524 INFO  datanode.DataNode (DataNode.java:<init>(434)) - Configured hostname is 127.0.0.1
2016-09-12 17:14:55,524 INFO  datanode.DataNode (DataNode.java:startDataNode(1147)) - Starting DataNode with maxLockedMemory = 0
2016-09-12 17:14:55,525 INFO  datanode.DataNode (DataXceiverServer.java:<init>(76)) - Balancing bandwith is 1048576 bytes/s
2016-09-12 17:14:55,526 INFO  datanode.DataNode (DataXceiverServer.java:<init>(77)) - Number threads for balancing is 5
2016-09-12 17:14:55,526 INFO  datanode.DataNode (DataNode.java:initDataXceiver(929)) - Opened streaming server at /127.0.0.1:59873
2016-09-12 17:14:55,529 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:55,530 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.datanode is not defined
2016-09-12 17:14:55,531 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:55,532 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context datanode
2016-09-12 17:14:55,532 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:55,532 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:55,533 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 53002
2016-09-12 17:14:55,534 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:55,552 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:53002
2016-09-12 17:14:55,558 INFO  web.DatanodeHttpServer (DatanodeHttpServer.java:start(186)) - Listening HTTP traffic on /127.0.0.1:50859
2016-09-12 17:14:55,558 INFO  datanode.DataNode (DataNode.java:startDataNode(1164)) - dnUserName = root
2016-09-12 17:14:55,559 INFO  datanode.DataNode (DataNode.java:startDataNode(1165)) - supergroup = supergroup
2016-09-12 17:14:55,559 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:55,560 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 60155
2016-09-12 17:14:55,565 INFO  datanode.DataNode (DataNode.java:initIpcServer(824)) - Opened IPC server at /127.0.0.1:60155
2016-09-12 17:14:55,575 INFO  datanode.DataNode (BlockPoolManager.java:refreshNamenodes(152)) - Refresh request received for nameservices: null
2016-09-12 17:14:55,576 INFO  datanode.DataNode (BlockPoolManager.java:doRefreshNamenodes(197)) - Starting BPOfferServices for nameservices: <default>
2016-09-12 17:14:55,578 INFO  datanode.DataNode (BPServiceActor.java:run(794)) - Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:60114 starting to offer service
2016-09-12 17:14:55,579 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:55,579 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 60155: starting
2016-09-12 17:14:55,599 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2303)) - dnInfo.length != numDataNodes
2016-09-12 17:14:55,600 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2255)) - Waiting for cluster to become active
2016-09-12 17:14:55,626 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:55,626 INFO  common.Storage (DataStorage.java:loadStorageDirectory(273)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1 is not formatted for BP-457114912-192.168.9.78-1473671695113
2016-09-12 17:14:55,627 INFO  common.Storage (DataStorage.java:loadStorageDirectory(275)) - Formatting ...
2016-09-12 17:14:55,673 INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(241)) - Analyzing storage directories for bpid BP-457114912-192.168.9.78-1473671695113
2016-09-12 17:14:55,673 INFO  common.Storage (Storage.java:lock(675)) - Locking is disabled for /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current/BP-457114912-192.168.9.78-1473671695113
2016-09-12 17:14:55,673 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(158)) - Block pool storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current/BP-457114912-192.168.9.78-1473671695113 is not formatted for BP-457114912-192.168.9.78-1473671695113
2016-09-12 17:14:55,673 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(160)) - Formatting ...
2016-09-12 17:14:55,674 INFO  common.Storage (BlockPoolSliceStorage.java:format(267)) - Formatting block pool BP-457114912-192.168.9.78-1473671695113 directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current/BP-457114912-192.168.9.78-1473671695113/current
2016-09-12 17:14:55,694 INFO  common.Storage (BlockPoolSliceStorage.java:doTransition(359)) - Restored 0 block files from trash.
2016-09-12 17:14:55,703 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2303)) - dnInfo.length != numDataNodes
2016-09-12 17:14:55,704 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2255)) - Waiting for cluster to become active
2016-09-12 17:14:55,718 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:55,719 INFO  common.Storage (DataStorage.java:loadStorageDirectory(273)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2 is not formatted for BP-457114912-192.168.9.78-1473671695113
2016-09-12 17:14:55,719 INFO  common.Storage (DataStorage.java:loadStorageDirectory(275)) - Formatting ...
2016-09-12 17:14:55,762 INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(241)) - Analyzing storage directories for bpid BP-457114912-192.168.9.78-1473671695113
2016-09-12 17:14:55,763 INFO  common.Storage (Storage.java:lock(675)) - Locking is disabled for /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current/BP-457114912-192.168.9.78-1473671695113
2016-09-12 17:14:55,763 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(158)) - Block pool storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current/BP-457114912-192.168.9.78-1473671695113 is not formatted for BP-457114912-192.168.9.78-1473671695113
2016-09-12 17:14:55,763 INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(160)) - Formatting ...
2016-09-12 17:14:55,764 INFO  common.Storage (BlockPoolSliceStorage.java:format(267)) - Formatting block pool BP-457114912-192.168.9.78-1473671695113 directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current/BP-457114912-192.168.9.78-1473671695113/current
2016-09-12 17:14:55,779 INFO  common.Storage (BlockPoolSliceStorage.java:doTransition(359)) - Restored 0 block files from trash.
2016-09-12 17:14:55,788 INFO  datanode.DataNode (DataNode.java:initStorage(1411)) - Setting up storage: nsid=259848881;bpid=BP-457114912-192.168.9.78-1473671695113;lv=-56;nsInfo=lv=-63;cid=testClusterID;nsid=259848881;c=0;bpid=BP-457114912-192.168.9.78-1473671695113;dnuuid=null
2016-09-12 17:14:55,807 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shouldWait(2303)) - dnInfo.length != numDataNodes
2016-09-12 17:14:55,807 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2255)) - Waiting for cluster to become active
2016-09-12 17:14:55,827 INFO  datanode.DataNode (DataNode.java:checkDatanodeUuid(1240)) - Generated and persisted new Datanode UUID 2b9cedc8-3d8c-433a-bf66-3c44c106dcfc
2016-09-12 17:14:55,829 INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(303)) - Added new volume: DS-bb245804-7784-4efa-b422-7bc621a3c3c9
2016-09-12 17:14:55,829 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(380)) - Added volume - /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current, StorageType: DISK
2016-09-12 17:14:55,831 INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(303)) - Added new volume: DS-fedd7aa3-9bb8-4493-a29d-68838547aa9e
2016-09-12 17:14:55,831 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(380)) - Added volume - /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current, StorageType: DISK
2016-09-12 17:14:55,833 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:registerMBean(2028)) - Registered FSDatasetState MBean
2016-09-12 17:14:55,834 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addBlockPool(2474)) - Adding block pool BP-457114912-192.168.9.78-1473671695113
2016-09-12 17:14:55,834 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(402)) - Scanning block pool BP-457114912-192.168.9.78-1473671695113 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current...
2016-09-12 17:14:55,835 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(402)) - Scanning block pool BP-457114912-192.168.9.78-1473671695113 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current...
2016-09-12 17:14:55,841 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(407)) - Time taken to scan block pool BP-457114912-192.168.9.78-1473671695113 on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current: 6ms
2016-09-12 17:14:55,841 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(407)) - Time taken to scan block pool BP-457114912-192.168.9.78-1473671695113 on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current: 6ms
2016-09-12 17:14:55,842 INFO  impl.FsDatasetImpl (FsVolumeList.java:addBlockPool(433)) - Total time to scan all replicas for block pool BP-457114912-192.168.9.78-1473671695113: 8ms
2016-09-12 17:14:55,843 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(189)) - Adding replicas to map for block pool BP-457114912-192.168.9.78-1473671695113 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current...
2016-09-12 17:14:55,843 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(189)) - Adding replicas to map for block pool BP-457114912-192.168.9.78-1473671695113 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current...
2016-09-12 17:14:55,843 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(194)) - Time to add replicas to map for block pool BP-457114912-192.168.9.78-1473671695113 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1/current: 0ms
2016-09-12 17:14:55,844 INFO  impl.FsDatasetImpl (FsVolumeList.java:run(194)) - Time to add replicas to map for block pool BP-457114912-192.168.9.78-1473671695113 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2/current: 0ms
2016-09-12 17:14:55,845 INFO  impl.FsDatasetImpl (FsVolumeList.java:getAllVolumesMap(220)) - Total time to add all replicas to map: 2ms
2016-09-12 17:14:55,846 INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(378)) - Now scanning bpid BP-457114912-192.168.9.78-1473671695113 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1
2016-09-12 17:14:55,846 INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(378)) - Now scanning bpid BP-457114912-192.168.9.78-1473671695113 on volume /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2
2016-09-12 17:14:55,846 INFO  datanode.DirectoryScanner (DirectoryScanner.java:start(332)) - Periodic Directory Tree Verification scan starting at 1473673168846 with interval 21600000
2016-09-12 17:14:55,846 INFO  datanode.VolumeScanner (VolumeScanner.java:runLoop(533)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1, DS-bb245804-7784-4efa-b422-7bc621a3c3c9): finished scanning block pool BP-457114912-192.168.9.78-1473671695113
2016-09-12 17:14:55,847 INFO  datanode.VolumeScanner (VolumeScanner.java:runLoop(533)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2, DS-fedd7aa3-9bb8-4493-a29d-68838547aa9e): finished scanning block pool BP-457114912-192.168.9.78-1473671695113
2016-09-12 17:14:55,847 INFO  datanode.DataNode (BPServiceActor.java:register(749)) - Block pool BP-457114912-192.168.9.78-1473671695113 (Datanode Uuid null) service to localhost/127.0.0.1:60114 beginning handshake with NN
2016-09-12 17:14:55,851 INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(395)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1, DS-bb245804-7784-4efa-b422-7bc621a3c3c9): no suitable block pools found to scan.  Waiting 1814399995 ms.
2016-09-12 17:14:55,851 INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(395)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2, DS-fedd7aa3-9bb8-4493-a29d-68838547aa9e): no suitable block pools found to scan.  Waiting 1814399995 ms.
2016-09-12 17:14:55,853 INFO  hdfs.StateChange (DatanodeManager.java:registerDatanode(891)) - BLOCK* registerDatanode: from DatanodeRegistration(127.0.0.1:59873, datanodeUuid=2b9cedc8-3d8c-433a-bf66-3c44c106dcfc, infoPort=50859, infoSecurePort=0, ipcPort=60155, storageInfo=lv=-56;cid=testClusterID;nsid=259848881;c=0) storage 2b9cedc8-3d8c-433a-bf66-3c44c106dcfc
2016-09-12 17:14:55,853 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:55,853 INFO  net.NetworkTopology (NetworkTopology.java:add(419)) - Adding a new node: /default-rack/127.0.0.1:59873
2016-09-12 17:14:55,855 INFO  datanode.DataNode (BPServiceActor.java:register(767)) - Block pool Block pool BP-457114912-192.168.9.78-1473671695113 (Datanode Uuid null) service to localhost/127.0.0.1:60114 successfully registered with NN
2016-09-12 17:14:55,856 INFO  datanode.DataNode (BPServiceActor.java:offerService(625)) - For namenode localhost/127.0.0.1:60114 using DELETEREPORT_INTERVAL of 300000 msec  BLOCKREPORT_INTERVAL of 21600000msec CACHEREPORT_INTERVAL of 10000msec Initial delay: 0msec; heartBeatInterval=3000
2016-09-12 17:14:55,859 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:55,859 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-bb245804-7784-4efa-b422-7bc621a3c3c9 for DN 127.0.0.1:59873
2016-09-12 17:14:55,860 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(864)) - Adding new storage ID DS-fedd7aa3-9bb8-4493-a29d-68838547aa9e for DN 127.0.0.1:59873
2016-09-12 17:14:55,861 INFO  datanode.DataNode (BPOfferService.java:updateActorStatesFromHeartbeat(507)) - Namenode Block pool BP-457114912-192.168.9.78-1473671695113 (Datanode Uuid 2b9cedc8-3d8c-433a-bf66-3c44c106dcfc) service to localhost/127.0.0.1:60114 trying to claim ACTIVE state with txid=1
2016-09-12 17:14:55,861 INFO  datanode.DataNode (BPOfferService.java:updateActorStatesFromHeartbeat(519)) - Acknowledging ACTIVE Namenode Block pool BP-457114912-192.168.9.78-1473671695113 (Datanode Uuid 2b9cedc8-3d8c-433a-bf66-3c44c106dcfc) service to localhost/127.0.0.1:60114
2016-09-12 17:14:55,863 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-bb245804-7784-4efa-b422-7bc621a3c3c9 node DatanodeRegistration(127.0.0.1:59873, datanodeUuid=2b9cedc8-3d8c-433a-bf66-3c44c106dcfc, infoPort=50859, infoSecurePort=0, ipcPort=60155, storageInfo=lv=-56;cid=testClusterID;nsid=259848881;c=0), blocks: 0, hasStaleStorage: true, processing time: 0 msecs
2016-09-12 17:14:55,864 INFO  BlockStateChange (BlockManager.java:processReport(1862)) - BLOCK* processReport: from storage DS-fedd7aa3-9bb8-4493-a29d-68838547aa9e node DatanodeRegistration(127.0.0.1:59873, datanodeUuid=2b9cedc8-3d8c-433a-bf66-3c44c106dcfc, infoPort=50859, infoSecurePort=0, ipcPort=60155, storageInfo=lv=-56;cid=testClusterID;nsid=259848881;c=0), blocks: 0, hasStaleStorage: false, processing time: 0 msecs
2016-09-12 17:14:55,865 INFO  datanode.DataNode (BPServiceActor.java:blockReport(492)) - Successfully sent block report 0x37461ecaf52fc,  containing 2 storage report(s), of which we sent 2. The reports had 0 total blocks and used 1 RPC(s). This took 0 msec to generate and 4 msecs for RPC and NN processing. Got back one command: FinalizeCommand/5.
2016-09-12 17:14:55,865 INFO  datanode.DataNode (BPOfferService.java:processCommandFromActive(690)) - Got finalize command for block pool BP-457114912-192.168.9.78-1473671695113
2016-09-12 17:14:55,910 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2286)) - Cluster is active
2016-09-12 17:14:55,919 INFO  namenode.NameNode (NameNode.java:createNameNode(1419)) - createNameNode [-backup]
2016-09-12 17:14:55,920 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(159)) - BackupNode metrics system started (again)
2016-09-12 17:14:55,920 INFO  namenode.NameNode (NameNode.java:setClientNamenodeAddress(399)) - fs.defaultFS is hdfs://localhost:60114
2016-09-12 17:14:55,920 INFO  namenode.NameNode (NameNode.java:setClientNamenodeAddress(419)) - Clients are to use localhost:60114 to access this namenode/service.
2016-09-12 17:14:55,937 WARN  common.Util (Util.java:stringAsURI(56)) - Path /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/ should be specified as a URI in configuration files. Please update hdfs configuration.
2016-09-12 17:14:55,937 WARN  common.Util (Util.java:stringAsURI(56)) - Path /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/ should be specified as a URI in configuration files. Please update hdfs configuration.
2016-09-12 17:14:55,938 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(727)) - No KeyProvider found.
2016-09-12 17:14:55,938 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(737)) - fsLock is fair:true
2016-09-12 17:14:55,939 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(242)) - dfs.block.invalidate.limit=1000
2016-09-12 17:14:55,940 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(248)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2016-09-12 17:14:55,940 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(71)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2016-09-12 17:14:55,941 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(76)) - The block deletion will start around 2016 九月 12 17:14:55
2016-09-12 17:14:55,941 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map BlocksMap
2016-09-12 17:14:55,941 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:55,942 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 2.0% max memory 3.6 GB = 72.8 MB
2016-09-12 17:14:55,942 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^23 = 8388608 entries
2016-09-12 17:14:55,950 INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(365)) - dfs.block.access.token.enable=false
2016-09-12 17:14:55,951 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(350)) - defaultReplication         = 1
2016-09-12 17:14:55,951 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(351)) - maxReplication             = 512
2016-09-12 17:14:55,951 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(352)) - minReplication             = 1
2016-09-12 17:14:55,952 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(353)) - maxReplicationStreams      = 2
2016-09-12 17:14:55,952 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(354)) - shouldCheckForEnoughRacks  = false
2016-09-12 17:14:55,952 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(355)) - replicationRecheckInterval = 3000
2016-09-12 17:14:55,952 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(356)) - encryptDataTransfer        = false
2016-09-12 17:14:55,953 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(357)) - maxNumBlocksToLog          = 1000
2016-09-12 17:14:55,953 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(757)) - fsOwner             = root (auth:SIMPLE)
2016-09-12 17:14:55,953 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(758)) - supergroup          = supergroup
2016-09-12 17:14:55,953 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(759)) - isPermissionEnabled = true
2016-09-12 17:14:55,954 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(770)) - HA Enabled: false
2016-09-12 17:14:55,954 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(809)) - Append Enabled: true
2016-09-12 17:14:55,955 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map INodeMap
2016-09-12 17:14:55,955 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:55,956 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 1.0% max memory 3.6 GB = 36.4 MB
2016-09-12 17:14:55,956 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^22 = 4194304 entries
2016-09-12 17:14:55,960 INFO  namenode.FSDirectory (FSDirectory.java:<init>(235)) - ACLs enabled? false
2016-09-12 17:14:55,960 INFO  namenode.FSDirectory (FSDirectory.java:<init>(239)) - XAttrs enabled? true
2016-09-12 17:14:55,961 INFO  namenode.FSDirectory (FSDirectory.java:<init>(247)) - Maximum size of an xattr: 16384
2016-09-12 17:14:55,961 INFO  namenode.NameNode (FSDirectory.java:<init>(295)) - Caching file names occuring more than 10 times
2016-09-12 17:14:55,961 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map cachedBlocks
2016-09-12 17:14:55,962 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:55,962 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.25% max memory 3.6 GB = 9.1 MB
2016-09-12 17:14:55,962 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^20 = 1048576 entries
2016-09-12 17:14:55,964 WARN  namenode.FSNamesystem (FSNamesystem.java:<init>(5655)) - The threshold value should't be greater than 1, threshold: 1.5
2016-09-12 17:14:55,964 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5664)) - dfs.namenode.safemode.threshold-pct = 1.5
2016-09-12 17:14:55,964 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5665)) - dfs.namenode.safemode.min.datanodes = 0
2016-09-12 17:14:55,964 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5666)) - dfs.namenode.safemode.extension     = 2147483647
2016-09-12 17:14:55,965 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:55,965 INFO  metrics.TopMetrics (TopMetrics.java:logConf(65)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2016-09-12 17:14:55,966 INFO  metrics.TopMetrics (TopMetrics.java:logConf(67)) - NNTop conf: dfs.namenode.top.num.users = 10
2016-09-12 17:14:55,966 INFO  metrics.TopMetrics (TopMetrics.java:logConf(69)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2016-09-12 17:14:55,966 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(920)) - Retry cache on namenode is enabled
2016-09-12 17:14:55,966 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(928)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2016-09-12 17:14:55,967 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map NameNodeRetryCache
2016-09-12 17:14:55,967 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:55,967 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.029999999329447746% max memory 3.6 GB = 1.1 MB
2016-09-12 17:14:55,968 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^17 = 131072 entries
2016-09-12 17:14:55,999 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:55,999 INFO  namenode.FSImage (BackupImage.java:recoverCreateRead(130)) - Storage directory /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1 is not formatted.
2016-09-12 17:14:55,999 INFO  namenode.FSImage (BackupImage.java:recoverCreateRead(131)) - Formatting ...
2016-09-12 17:14:56,000 INFO  namenode.NameNode (NameNodeRpcServer.java:<init>(342)) - RPC server is binding to localhost:0
2016-09-12 17:14:56,001 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:56,002 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 54472
2016-09-12 17:14:56,008 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(6536)) - Registered FSNamesystemState MBean
2016-09-12 17:14:56,009 WARN  common.Util (Util.java:stringAsURI(56)) - Path /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/ should be specified as a URI in configuration files. Please update hdfs configuration.
2016-09-12 17:14:56,019 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:56,020 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:56,020 INFO  hdfs.StateChange (FSNamesystem.java:leave(5739)) - STATE* Leaving safe mode after 0 secs
2016-09-12 17:14:56,020 INFO  hdfs.StateChange (FSNamesystem.java:leave(5751)) - STATE* Network topology has 0 racks and 0 datanodes
2016-09-12 17:14:56,021 INFO  hdfs.StateChange (FSNamesystem.java:leave(5754)) - STATE* UnderReplicatedBlocks has 0 blocks
2016-09-12 17:14:56,021 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:56,044 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1703)) - Starting Web-server for hdfs at: http://localhost:0
2016-09-12 17:14:56,046 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:56,047 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.namenode is not defined
2016-09-12 17:14:56,048 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:56,049 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hdfs
2016-09-12 17:14:56,049 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:56,049 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:56,050 INFO  http.HttpServer2 (NameNodeHttpServer.java:initWebHdfs(86)) - Added filter 'org.apache.hadoop.hdfs.web.AuthFilter' (class=org.apache.hadoop.hdfs.web.AuthFilter)
2016-09-12 17:14:56,051 INFO  http.HttpServer2 (HttpServer2.java:addJerseyResourcePackage(609)) - addJerseyResourcePackage: packageName=org.apache.hadoop.hdfs.server.namenode.web.resources;org.apache.hadoop.hdfs.web.resources, pathSpec=/webhdfs/v1/*
2016-09-12 17:14:56,052 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 52969
2016-09-12 17:14:56,053 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:56,071 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:52969
2016-09-12 17:14:56,073 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:56,074 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 54472: starting
2016-09-12 17:14:56,080 INFO  namenode.NameNode (NameNode.java:startCommonServices(697)) - Backup Node RPC up at: localhost/127.0.0.1:54472
2016-09-12 17:14:56,081 INFO  hdfs.StateChange (FSNamesystem.java:reportStatus(6007)) - STATE* Safe mode is ON. 
It was turned on manually. Use "hdfs dfsadmin -safemode leave" to turn safe mode off.
2016-09-12 17:14:56,082 INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(362)) - Recovering unfinalized segments in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current
2016-09-12 17:14:56,085 INFO  namenode.FSEditLog (FSEditLog.java:registerBackupNode(1382)) - Registering new backup node: NamenodeRegistration(localhost:54472, role=Backup Node)
2016-09-12 17:14:56,087 INFO  namenode.Checkpointer (Checkpointer.java:initialize(108)) - Checkpoint Period : 3600 secs (60 min)
2016-09-12 17:14:56,087 INFO  namenode.Checkpointer (Checkpointer.java:initialize(111)) - Transactions count is  : 1000000, to trigger checkpoint
2016-09-12 17:14:56,087 INFO  namenode.FSNamesystem (FSNamesystem.java:startActiveServices(1123)) - Starting services required for active state
2016-09-12 17:14:56,090 INFO  namenode.FSNamesystem (FSNamesystem.java:startCheckpoint(6347)) - Start checkpoint for localhost:54472
2016-09-12 17:14:56,090 INFO  namenode.FSImage (FSImage.java:startCheckpoint(1333)) - Start checkpoint at txid 1
2016-09-12 17:14:56,090 INFO  namenode.FSEditLog (FSEditLog.java:rollEditLog(1202)) - Rolling edit logs
2016-09-12 17:14:56,090 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 1
2016-09-12 17:14:56,091 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 2 Total time for transactions(ms): 0 Number of transactions batched in Syncs: 0 Number of syncs: 3 SyncTimes(ms): 3 3 
2016-09-12 17:14:56,102 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000001 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000001-0000000000000000002
2016-09-12 17:14:56,103 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_1_0 on NN
2016-09-12 17:14:56,105 ERROR namenode.FSNamesystem (FSNamesystem.java:run(5190)) - Swallowing exception in NameNodeEditLogRoller:
java.lang.IllegalStateException: Bad state: BETWEEN_LOG_SEGMENTS
	at com.google.common.base.Preconditions.checkState(Preconditions.java:172)
	at org.apache.hadoop.hdfs.server.namenode.FSEditLog.getCurSegmentTxId(FSEditLog.java:515)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem$NameNodeEditLogRoller.run(FSNamesystem.java:5181)
	at java.lang.Thread.run(Thread.java:745)
2016-09-12 17:14:56,106 INFO  blockmanagement.CacheReplicationMonitor (CacheReplicationMonitor.java:run(160)) - Starting CacheReplicationMonitor with interval 30000 milliseconds
2016-09-12 17:14:56,107 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000001 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000001-0000000000000000002
2016-09-12 17:14:56,107 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 3
2016-09-12 17:14:56,137 INFO  namenode.FSImage (BackupImage.java:namenodeStartedLogSegment(350)) - NameNode started a new log segment at txid 3
2016-09-12 17:14:56,137 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 3
2016-09-12 17:14:56,144 DEBUG namenode.FSImage (BackupImage.java:setState(338)) - State transition DROP_UNTIL_NEXT_ROLL -> JOURNAL_ONLY
2016-09-12 17:14:56,147 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 3; numTxns = 1
2016-09-12 17:14:56,304 DEBUG namenode.Checkpointer (Checkpointer.java:doCheckpoint(211)) - Doing checkpoint. Last applied: 0
2016-09-12 17:14:56,306 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 4; numTxns = 1
2016-09-12 17:14:56,307 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_1_0	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:56,308 INFO  namenode.TransferFsImage (TransferFsImage.java:getFileClient(396)) - Opening connection to http://localhost:48395/imagetransfer?getedit=1&startTxId=1&endTxId=2&storageInfo=-63:259848881:0:testClusterID
2016-09-12 17:14:56,313 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_1_0 on BN
2016-09-12 17:14:56,315 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_1_1 on NN
2016-09-12 17:14:56,321 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 5; numTxns = 1
2016-09-12 17:14:56,323 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_1_1	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:56,325 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_1_1 on BN
2016-09-12 17:14:56,326 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_1_2 on NN
2016-09-12 17:14:56,359 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 6; numTxns = 1
2016-09-12 17:14:56,360 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_1_2	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:56,362 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_1_2 on BN
2016-09-12 17:14:56,363 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_1_3 on NN
2016-09-12 17:14:56,368 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 7; numTxns = 1
2016-09-12 17:14:56,369 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_1_3	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:56,371 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_1_3 on BN
2016-09-12 17:14:56,372 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_1_4 on NN
2016-09-12 17:14:56,374 INFO  namenode.TransferFsImage (TransferFsImage.java:receiveFile(553)) - Transfer took 0.06s at 0.00 KB/s
2016-09-12 17:14:56,375 INFO  namenode.TransferFsImage (TransferFsImage.java:downloadEditsToStorage(168)) - Downloaded file edits_tmp_0000000000000000001-0000000000000000002_0000000000972389308 size 0 bytes.
2016-09-12 17:14:56,376 INFO  namenode.Checkpointer (Checkpointer.java:rollForwardByApplyingLogs(309)) - Checkpointer about to load edits from 1 stream(s).
2016-09-12 17:14:56,376 DEBUG namenode.FSImage (FSImage.java:loadEdits(834)) - About to load edits:
  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000001-0000000000000000002
2016-09-12 17:14:56,376 INFO  namenode.FSImage (FSImage.java:loadEdits(844)) - Reading /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000001-0000000000000000002 expecting start txid #1
2016-09-12 17:14:56,376 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 8; numTxns = 1
2016-09-12 17:14:56,376 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000001-0000000000000000002
2016-09-12 17:14:56,377 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_1_4	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:56,377 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_END_LOG_SEGMENT=1
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:56,379 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000001-0000000000000000002 of size 42 edits # 2 loaded in 0 seconds
2016-09-12 17:14:56,379 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2016-09-12 17:14:56,380 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_1_4 on BN
2016-09-12 17:14:56,435 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/fsimage.ckpt_0000000000000000002 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/fsimage_0000000000000000002
2016-09-12 17:14:56,435 INFO  namenode.FSImageTransactionalStorageInspector (FSImageTransactionalStorageInspector.java:inspectDirectory(85)) - No version file in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1
2016-09-12 17:14:56,460 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_1_5 on NN
2016-09-12 17:14:56,465 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 9; numTxns = 1
2016-09-12 17:14:56,466 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_1_5	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:56,468 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_1_5 on BN
2016-09-12 17:14:56,469 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_1_6 on NN
2016-09-12 17:14:56,495 INFO  namenode.TransferFsImage (TransferFsImage.java:receiveFile(553)) - Transfer took 0.03s at 0.00 KB/s
2016-09-12 17:14:56,495 INFO  namenode.TransferFsImage (TransferFsImage.java:handleUploadImageRequest(134)) - Downloaded file fsimage.ckpt_0000000000000000002 size 350 bytes.
2016-09-12 17:14:56,514 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 10; numTxns = 1
2016-09-12 17:14:56,515 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_1_6	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:56,517 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_1_6 on BN
2016-09-12 17:14:56,518 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_1_7 on NN
2016-09-12 17:14:56,522 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 11; numTxns = 1
2016-09-12 17:14:56,523 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_1_7	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:56,524 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_1_7 on BN
2016-09-12 17:14:56,525 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_1_8 on NN
2016-09-12 17:14:56,530 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 12; numTxns = 1
2016-09-12 17:14:56,531 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_1_8	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:56,532 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_1_8 on BN
2016-09-12 17:14:56,533 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_1_9 on NN
2016-09-12 17:14:56,537 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 13; numTxns = 1
2016-09-12 17:14:56,538 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_1_9	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:56,539 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_1_9 on BN
2016-09-12 17:14:56,563 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage.ckpt_0000000000000000002 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000002
2016-09-12 17:14:56,564 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage.ckpt_0000000000000000002 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000002
2016-09-12 17:14:56,565 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 0
2016-09-12 17:14:56,568 INFO  namenode.TransferFsImage (TransferFsImage.java:uploadImageFromStorage(237)) - Uploaded image with txid 2 to namenode at http://localhost:48395 in 0.109 seconds
2016-09-12 17:14:56,570 INFO  namenode.FSNamesystem (FSNamesystem.java:endCheckpoint(6375)) - End checkpoint for localhost:54472
2016-09-12 17:14:56,570 INFO  namenode.FSImage (FSImage.java:endCheckpoint(1373)) - End checkpoint at txid 13
2016-09-12 17:14:56,588 INFO  namenode.FSImage (BackupImage.java:tryConvergeJournalSpool(314)) - Going to finish converging with remaining 11 txns from in-progress stream org.apache.hadoop.hdfs.server.namenode.RedundantEditLogInputStream@2ad7672f
2016-09-12 17:14:56,589 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000003
2016-09-12 17:14:56,589 INFO  namenode.EditLogInputStream (RedundantEditLogInputStream.java:nextOp(176)) - Fast-forwarding stream '/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000003' to transaction ID 3
2016-09-12 17:14:56,596 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=10
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:56,596 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000003 of size 1048576 edits # 11 loaded in 0 seconds
2016-09-12 17:14:56,597 INFO  namenode.FSImage (BackupImage.java:tryConvergeJournalSpool(326)) - Successfully synced BackupNode with NameNode at txnid 13
2016-09-12 17:14:56,597 DEBUG namenode.FSImage (BackupImage.java:setState(338)) - State transition JOURNAL_ONLY -> IN_SYNC
2016-09-12 17:14:56,597 INFO  namenode.Checkpointer (Checkpointer.java:doCheckpoint(278)) - Checkpoint completed in 0 seconds. New Image Size: 350
2016-09-12 17:14:56,729 INFO  namenode.FSEditLog (FSEditLog.java:rollEditLog(1202)) - Rolling edit logs
2016-09-12 17:14:56,729 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 3
2016-09-12 17:14:56,731 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 14; numTxns = 1
2016-09-12 17:14:56,733 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:170000000c000000000000000ec78c3813
2016-09-12 17:14:56,733 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_END_LOG_SEGMENT=1
2016-09-12 17:14:56,735 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 12 Total time for transactions(ms): 12 Number of transactions batched in Syncs: 1 Number of syncs: 13 SyncTimes(ms): 69 2 28 
2016-09-12 17:14:56,736 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000003 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000003-0000000000000000014
2016-09-12 17:14:56,737 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000003 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000003-0000000000000000014
2016-09-12 17:14:56,737 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 15
2016-09-12 17:14:56,764 INFO  namenode.FSImage (BackupImage.java:namenodeStartedLogSegment(350)) - NameNode started a new log segment at txid 15
2016-09-12 17:14:56,764 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 3
2016-09-12 17:14:56,764 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 12 Total time for transactions(ms): 2 Number of transactions batched in Syncs: 0 Number of syncs: 13 SyncTimes(ms): 3 
2016-09-12 17:14:56,765 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000003 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000003-0000000000000000014
2016-09-12 17:14:56,766 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 15
2016-09-12 17:14:56,771 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 15; numTxns = 1
2016-09-12 17:14:56,773 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:180000000c000000000000000f97fbddb0
2016-09-12 17:14:56,774 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:56,907 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_2_0 on NN
2016-09-12 17:14:56,914 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 16; numTxns = 1
2016-09-12 17:14:56,922 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:00000000920000000000000010000000000000000000092f746573745f325f3000010000000000000000000001571dad920f00000000080000000000000004726f6f740001a400000000000023444653436c69656e745f4e4f4e4d41505245445543455f313936353236303738345f3100093132372e302e302e3101000010d2d611c6a86c409fb5e1c603e3d13750000000eb724a988b
2016-09-12 17:14:56,923 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
2016-09-12 17:14:56,924 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_2_0	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:56,926 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_2_0 on BN
2016-09-12 17:14:56,927 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_2_1 on NN
2016-09-12 17:14:56,932 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 17; numTxns = 1
2016-09-12 17:14:56,940 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:00000000920000000000000011000000000000000000092f746573745f325f3100010000000000000000000001571dad922200000000080000000000000004726f6f740001a400000000000023444653436c69656e745f4e4f4e4d41505245445543455f313936353236303738345f3100093132372e302e302e3101000010d2d611c6a86c409fb5e1c603e3d13750000000eda12b08ea
2016-09-12 17:14:56,941 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
2016-09-12 17:14:56,943 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_2_1	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:56,944 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_2_1 on BN
2016-09-12 17:14:56,945 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_2_2 on NN
2016-09-12 17:14:56,950 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 18; numTxns = 1
2016-09-12 17:14:56,958 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:00000000920000000000000012000000000000000000092f746573745f325f3200010000000000000000000001571dad923300000000080000000000000004726f6f740001a400000000000023444653436c69656e745f4e4f4e4d41505245445543455f313936353236303738345f3100093132372e302e302e3101000010d2d611c6a86c409fb5e1c603e3d13750000000effaa6f337
2016-09-12 17:14:56,959 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
2016-09-12 17:14:56,961 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_2_2	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:56,963 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_2_2 on BN
2016-09-12 17:14:56,963 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_2_3 on NN
2016-09-12 17:14:56,969 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 19; numTxns = 1
2016-09-12 17:14:56,976 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:00000000920000000000000013000000000000000000092f746573745f325f3300010000000000000000000001571dad924600000000080000000000000004726f6f740001a400000000000023444653436c69656e745f4e4f4e4d41505245445543455f313936353236303738345f3100093132372e302e302e3101000010d2d611c6a86c409fb5e1c603e3d13750000000f1ab383fdb
2016-09-12 17:14:56,978 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
2016-09-12 17:14:56,979 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_2_3	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:56,980 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_2_3 on BN
2016-09-12 17:14:56,981 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_2_4 on NN
2016-09-12 17:14:56,986 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 20; numTxns = 1
2016-09-12 17:14:56,994 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:00000000920000000000000014000000000000000000092f746573745f325f3400010000000000000000000001571dad925700000000080000000000000004726f6f740001a400000000000023444653436c69656e745f4e4f4e4d41505245445543455f313936353236303738345f3100093132372e302e302e3101000010d2d611c6a86c409fb5e1c603e3d13750000000f3908ccdbc
2016-09-12 17:14:56,995 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
2016-09-12 17:14:56,996 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_2_4	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:56,998 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_2_4 on BN
2016-09-12 17:14:56,999 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_2_5 on NN
2016-09-12 17:14:57,003 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 21; numTxns = 1
2016-09-12 17:14:57,011 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:00000000920000000000000015000000000000000000092f746573745f325f3500010000000000000000000001571dad926900000000080000000000000004726f6f740001a400000000000023444653436c69656e745f4e4f4e4d41505245445543455f313936353236303738345f3100093132372e302e302e3101000010d2d611c6a86c409fb5e1c603e3d13750000000f5e64fa811
2016-09-12 17:14:57,012 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
2016-09-12 17:14:57,014 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_2_5	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:57,015 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_2_5 on BN
2016-09-12 17:14:57,016 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_2_6 on NN
2016-09-12 17:14:57,021 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 22; numTxns = 1
2016-09-12 17:14:57,029 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:00000000920000000000000016000000000000000000092f746573745f325f3600010000000000000000000001571dad927b00000000080000000000000004726f6f740001a400000000000023444653436c69656e745f4e4f4e4d41505245445543455f313936353236303738345f3100093132372e302e302e3101000010d2d611c6a86c409fb5e1c603e3d13750000000f7028cec35
2016-09-12 17:14:57,030 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
2016-09-12 17:14:57,031 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_2_6	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:57,033 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_2_6 on BN
2016-09-12 17:14:57,034 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_2_7 on NN
2016-09-12 17:14:57,038 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 23; numTxns = 1
2016-09-12 17:14:57,045 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:00000000920000000000000017000000000000000000092f746573745f325f3700010000000000000000000001571dad928c00000000080000000000000004726f6f740001a400000000000023444653436c69656e745f4e4f4e4d41505245445543455f313936353236303738345f3100093132372e302e302e3101000010d2d611c6a86c409fb5e1c603e3d13750000000f94c4c4bbb
2016-09-12 17:14:57,047 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
2016-09-12 17:14:57,048 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_2_7	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:57,050 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_2_7 on BN
2016-09-12 17:14:57,051 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_2_8 on NN
2016-09-12 17:14:57,055 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 24; numTxns = 1
2016-09-12 17:14:57,063 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:00000000920000000000000018000000000000000000092f746573745f325f3800010000000000000000000001571dad929d00000000080000000000000004726f6f740001a400000000000023444653436c69656e745f4e4f4e4d41505245445543455f313936353236303738345f3100093132372e302e302e3101000010d2d611c6a86c409fb5e1c603e3d13750000000fbb78aaaa8
2016-09-12 17:14:57,064 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
2016-09-12 17:14:57,065 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_2_8	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:57,067 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_2_8 on BN
2016-09-12 17:14:57,067 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_2_9 on NN
2016-09-12 17:14:57,072 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 25; numTxns = 1
2016-09-12 17:14:57,079 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:00000000920000000000000019000000000000000000092f746573745f325f3900010000000000000000000001571dad92ae00000000080000000000000004726f6f740001a400000000000023444653436c69656e745f4e4f4e4d41505245445543455f313936353236303738345f3100093132372e302e302e3101000010d2d611c6a86c409fb5e1c603e3d13750000000fd3b25af75
2016-09-12 17:14:57,080 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
2016-09-12 17:14:57,081 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_2_9	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:57,082 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_2_9 on BN
2016-09-12 17:14:57,118 INFO  namenode.FSNamesystem (FSNamesystem.java:startCheckpoint(6347)) - Start checkpoint for localhost:54472
2016-09-12 17:14:57,118 INFO  namenode.FSImage (FSImage.java:startCheckpoint(1333)) - Start checkpoint at txid 25
2016-09-12 17:14:57,118 INFO  namenode.FSEditLog (FSEditLog.java:rollEditLog(1202)) - Rolling edit logs
2016-09-12 17:14:57,118 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 15
2016-09-12 17:14:57,120 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 26; numTxns = 1
2016-09-12 17:14:57,121 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:170000000c000000000000001add56ec6e
2016-09-12 17:14:57,122 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_END_LOG_SEGMENT=1
2016-09-12 17:14:57,123 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 12 Total time for transactions(ms): 7 Number of transactions batched in Syncs: 0 Number of syncs: 13 SyncTimes(ms): 3 4 121 
2016-09-12 17:14:57,124 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000015 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000015-0000000000000000026
2016-09-12 17:14:57,125 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000015 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000015-0000000000000000026
2016-09-12 17:14:57,126 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 27
2016-09-12 17:14:57,150 INFO  namenode.FSImage (BackupImage.java:namenodeStartedLogSegment(350)) - NameNode started a new log segment at txid 27
2016-09-12 17:14:57,150 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 15
2016-09-12 17:14:57,151 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 12 Total time for transactions(ms): 2 Number of transactions batched in Syncs: 0 Number of syncs: 13 SyncTimes(ms): 2 
2016-09-12 17:14:57,152 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000015 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000015-0000000000000000026
2016-09-12 17:14:57,152 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 27
2016-09-12 17:14:57,156 INFO  namenode.FSImage (BackupImage.java:namenodeStartedLogSegment(376)) - Stopped applying edits to prepare for checkpoint.
2016-09-12 17:14:57,156 DEBUG namenode.FSImage (BackupImage.java:setState(338)) - State transition IN_SYNC -> JOURNAL_ONLY
2016-09-12 17:14:57,158 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 27; numTxns = 1
2016-09-12 17:14:57,291 DEBUG namenode.Checkpointer (Checkpointer.java:doCheckpoint(211)) - Doing checkpoint. Last applied: 26
2016-09-12 17:14:57,342 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/fsimage.ckpt_0000000000000000026 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/fsimage_0000000000000000026
2016-09-12 17:14:57,343 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 2
2016-09-12 17:14:57,378 INFO  namenode.TransferFsImage (TransferFsImage.java:receiveFile(553)) - Transfer took 0.02s at 47.62 KB/s
2016-09-12 17:14:57,378 INFO  namenode.TransferFsImage (TransferFsImage.java:handleUploadImageRequest(134)) - Downloaded file fsimage.ckpt_0000000000000000026 size 1337 bytes.
2016-09-12 17:14:57,414 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage.ckpt_0000000000000000026 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000026
2016-09-12 17:14:57,415 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage.ckpt_0000000000000000026 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000026
2016-09-12 17:14:57,416 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 2
2016-09-12 17:14:57,416 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000000, cpktTxId=0000000000000000000)
2016-09-12 17:14:57,417 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000000, cpktTxId=0000000000000000000)
2016-09-12 17:14:57,419 INFO  namenode.TransferFsImage (TransferFsImage.java:uploadImageFromStorage(237)) - Uploaded image with txid 26 to namenode at http://localhost:48395 in 0.068 seconds
2016-09-12 17:14:57,422 INFO  namenode.FSNamesystem (FSNamesystem.java:endCheckpoint(6375)) - End checkpoint for localhost:54472
2016-09-12 17:14:57,422 INFO  namenode.FSImage (FSImage.java:endCheckpoint(1373)) - End checkpoint at txid 27
2016-09-12 17:14:57,437 INFO  namenode.FSImage (BackupImage.java:tryConvergeJournalSpool(314)) - Going to finish converging with remaining 1 txns from in-progress stream org.apache.hadoop.hdfs.server.namenode.RedundantEditLogInputStream@3e7e8ac0
2016-09-12 17:14:57,438 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000027
2016-09-12 17:14:57,438 INFO  namenode.EditLogInputStream (RedundantEditLogInputStream.java:nextOp(176)) - Fast-forwarding stream '/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000027' to transaction ID 27
2016-09-12 17:14:57,440 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:57,440 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000027 of size 1048576 edits # 1 loaded in 0 seconds
2016-09-12 17:14:57,441 INFO  namenode.FSImage (BackupImage.java:tryConvergeJournalSpool(326)) - Successfully synced BackupNode with NameNode at txnid 27
2016-09-12 17:14:57,441 DEBUG namenode.FSImage (BackupImage.java:setState(338)) - State transition JOURNAL_ONLY -> IN_SYNC
2016-09-12 17:14:57,441 INFO  namenode.Checkpointer (Checkpointer.java:doCheckpoint(278)) - Checkpoint completed in 0 seconds. New Image Size: 1337
2016-09-12 17:14:57,442 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_3_0 on NN
2016-09-12 17:14:57,448 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 28; numTxns = 1
2016-09-12 17:14:57,453 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:0000000092000000000000001c000000000000000000092f746573745f335f3000010000000000000000000001571dad942500000000080000000000000004726f6f740001a400000000000023444653436c69656e745f4e4f4e4d41505245445543455f313936353236303738345f3100093132372e302e302e3101000010d2d611c6a86c409fb5e1c603e3d1375000000105e62c7a3b
2016-09-12 17:14:57,454 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
2016-09-12 17:14:57,455 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_3_0	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:57,457 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_3_0 on BN
2016-09-12 17:14:57,458 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_3_1 on NN
2016-09-12 17:14:57,462 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 29; numTxns = 1
2016-09-12 17:14:57,467 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:0000000092000000000000001d000000000000000000092f746573745f335f3100010000000000000000000001571dad943400000000080000000000000004726f6f740001a400000000000023444653436c69656e745f4e4f4e4d41505245445543455f313936353236303738345f3100093132372e302e302e3101000010d2d611c6a86c409fb5e1c603e3d13750000001078dbd053b
2016-09-12 17:14:57,468 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
2016-09-12 17:14:57,469 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_3_1	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:57,471 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_3_1 on BN
2016-09-12 17:14:57,472 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_3_2 on NN
2016-09-12 17:14:57,477 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 30; numTxns = 1
2016-09-12 17:14:57,482 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:0000000092000000000000001e000000000000000000092f746573745f335f3200010000000000000000000001571dad944200000000080000000000000004726f6f740001a400000000000023444653436c69656e745f4e4f4e4d41505245445543455f313936353236303738345f3100093132372e302e302e3101000010d2d611c6a86c409fb5e1c603e3d13750000001094ec6e297
2016-09-12 17:14:57,483 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
2016-09-12 17:14:57,484 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_3_2	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:57,486 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_3_2 on BN
2016-09-12 17:14:57,487 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_3_3 on NN
2016-09-12 17:14:57,491 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 31; numTxns = 1
2016-09-12 17:14:57,496 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:0000000092000000000000001f000000000000000000092f746573745f335f3300010000000000000000000001571dad945100000000080000000000000004726f6f740001a400000000000023444653436c69656e745f4e4f4e4d41505245445543455f313936353236303738345f3100093132372e302e302e3101000010d2d611c6a86c409fb5e1c603e3d137500000010bf0dcb739
2016-09-12 17:14:57,497 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
2016-09-12 17:14:57,498 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_3_3	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:57,501 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_3_3 on BN
2016-09-12 17:14:57,502 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_3_4 on NN
2016-09-12 17:14:57,507 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 32; numTxns = 1
2016-09-12 17:14:57,511 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:00000000920000000000000020000000000000000000092f746573745f335f3400010000000000000000000001571dad946000000000080000000000000004726f6f740001a400000000000023444653436c69656e745f4e4f4e4d41505245445543455f313936353236303738345f3100093132372e302e302e3101000010d2d611c6a86c409fb5e1c603e3d137500000010df359e362
2016-09-12 17:14:57,512 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
2016-09-12 17:14:57,514 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_3_4	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:57,516 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_3_4 on BN
2016-09-12 17:14:57,517 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_3_5 on NN
2016-09-12 17:14:57,522 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 33; numTxns = 1
2016-09-12 17:14:57,526 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:00000000920000000000000021000000000000000000092f746573745f335f3500010000000000000000000001571dad946f00000000080000000000000004726f6f740001a400000000000023444653436c69656e745f4e4f4e4d41505245445543455f313936353236303738345f3100093132372e302e302e3101000010d2d611c6a86c409fb5e1c603e3d137500000010fc70609de
2016-09-12 17:14:57,527 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
2016-09-12 17:14:57,529 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_3_5	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:57,530 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_3_5 on BN
2016-09-12 17:14:57,531 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_3_6 on NN
2016-09-12 17:14:57,536 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 34; numTxns = 1
2016-09-12 17:14:57,540 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:00000000920000000000000022000000000000000000092f746573745f335f3600010000000000000000000001571dad947e00000000080000000000000004726f6f740001a400000000000023444653436c69656e745f4e4f4e4d41505245445543455f313936353236303738345f3100093132372e302e302e3101000010d2d611c6a86c409fb5e1c603e3d1375000000111888aae4c
2016-09-12 17:14:57,541 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
2016-09-12 17:14:57,542 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_3_6	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:57,544 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_3_6 on BN
2016-09-12 17:14:57,544 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_3_7 on NN
2016-09-12 17:14:57,549 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 35; numTxns = 1
2016-09-12 17:14:57,553 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:00000000920000000000000023000000000000000000092f746573745f335f3700010000000000000000000001571dad948b00000000080000000000000004726f6f740001a400000000000023444653436c69656e745f4e4f4e4d41505245445543455f313936353236303738345f3100093132372e302e302e3101000010d2d611c6a86c409fb5e1c603e3d13750000001131a776f47
2016-09-12 17:14:57,554 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
2016-09-12 17:14:57,555 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_3_7	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:57,557 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_3_7 on BN
2016-09-12 17:14:57,558 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_3_8 on NN
2016-09-12 17:14:57,562 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 36; numTxns = 1
2016-09-12 17:14:57,566 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:00000000920000000000000024000000000000000000092f746573745f335f3800010000000000000000000001571dad949800000000080000000000000004726f6f740001a400000000000023444653436c69656e745f4e4f4e4d41505245445543455f313936353236303738345f3100093132372e302e302e3101000010d2d611c6a86c409fb5e1c603e3d1375000000115ffe644d7
2016-09-12 17:14:57,567 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
2016-09-12 17:14:57,568 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_3_8	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:57,570 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_3_8 on BN
2016-09-12 17:14:57,571 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_3_9 on NN
2016-09-12 17:14:57,575 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = IN_SYNC; firstTxId = 37; numTxns = 1
2016-09-12 17:14:57,579 DEBUG namenode.FSImage (BackupImage.java:applyEdits(214)) - data:00000000920000000000000025000000000000000000092f746573745f335f3900010000000000000000000001571dad94a500000000080000000000000004726f6f740001a400000000000023444653436c69656e745f4e4f4e4d41505245445543455f313936353236303738345f3100093132372e302e302e3101000010d2d611c6a86c409fb5e1c603e3d137500000011731065a9a
2016-09-12 17:14:57,580 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=1
2016-09-12 17:14:57,582 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_3_9	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:57,583 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_3_9 on BN
2016-09-12 17:14:57,618 INFO  namenode.NameNode (NameNodeRpcServer.java:errorReport(501)) - Error report from NamenodeRegistration(localhost:54472, role=Backup Node): Shutting down.
2016-09-12 17:14:57,619 INFO  namenode.FSEditLog (FSEditLog.java:releaseBackupStream(1393)) - Removing backup journal BackupJournalManager
SEEEEEEEEEEEEEEEEEEEEETcheckpointManager null
2016-09-12 17:14:57,620 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:57,621 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5196)) - NameNodeEditLogRoller was interrupted, exiting
2016-09-12 17:14:57,622 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5269)) - LazyPersistFileScrubber was interrupted, exiting
2016-09-12 17:14:57,622 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 54472
2016-09-12 17:14:57,623 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 54472
2016-09-12 17:14:57,624 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:57,624 INFO  blockmanagement.BlockManager (BlockManager.java:run(3636)) - Stopping ReplicationMonitor.
2016-09-12 17:14:57,634 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:57,635 INFO  namenode.FSNamesystem (FSNamesystem.java:stopStandbyServices(1317)) - Stopping services started for standby state
2016-09-12 17:14:57,638 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:57,748 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=mkdirs	src=/edit-while-bn-down	dst=null	perm=root:supergroup:rwxr-xr-x	proto=rpc
2016-09-12 17:14:57,749 INFO  namenode.NameNode (NameNode.java:createNameNode(1419)) - createNameNode [-backup]
2016-09-12 17:14:57,750 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(159)) - BackupNode metrics system started (again)
2016-09-12 17:14:57,750 INFO  namenode.NameNode (NameNode.java:setClientNamenodeAddress(399)) - fs.defaultFS is hdfs://localhost:60114
2016-09-12 17:14:57,750 INFO  namenode.NameNode (NameNode.java:setClientNamenodeAddress(419)) - Clients are to use localhost:60114 to access this namenode/service.
2016-09-12 17:14:57,764 WARN  common.Util (Util.java:stringAsURI(56)) - Path /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/ should be specified as a URI in configuration files. Please update hdfs configuration.
2016-09-12 17:14:57,765 WARN  common.Util (Util.java:stringAsURI(56)) - Path /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/ should be specified as a URI in configuration files. Please update hdfs configuration.
2016-09-12 17:14:57,765 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(727)) - No KeyProvider found.
2016-09-12 17:14:57,766 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(737)) - fsLock is fair:true
2016-09-12 17:14:57,767 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(242)) - dfs.block.invalidate.limit=1000
2016-09-12 17:14:57,767 INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(248)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2016-09-12 17:14:57,768 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(71)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2016-09-12 17:14:57,769 INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(76)) - The block deletion will start around 2016 九月 12 17:14:57
2016-09-12 17:14:57,769 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map BlocksMap
2016-09-12 17:14:57,769 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:57,770 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 2.0% max memory 3.6 GB = 72.8 MB
2016-09-12 17:14:57,770 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^23 = 8388608 entries
2016-09-12 17:14:57,779 INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(365)) - dfs.block.access.token.enable=false
2016-09-12 17:14:57,780 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(350)) - defaultReplication         = 1
2016-09-12 17:14:57,780 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(351)) - maxReplication             = 512
2016-09-12 17:14:57,780 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(352)) - minReplication             = 1
2016-09-12 17:14:57,781 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(353)) - maxReplicationStreams      = 2
2016-09-12 17:14:57,781 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(354)) - shouldCheckForEnoughRacks  = false
2016-09-12 17:14:57,781 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(355)) - replicationRecheckInterval = 3000
2016-09-12 17:14:57,781 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(356)) - encryptDataTransfer        = false
2016-09-12 17:14:57,781 INFO  blockmanagement.BlockManager (BlockManager.java:<init>(357)) - maxNumBlocksToLog          = 1000
2016-09-12 17:14:57,782 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(757)) - fsOwner             = root (auth:SIMPLE)
2016-09-12 17:14:57,782 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(758)) - supergroup          = supergroup
2016-09-12 17:14:57,782 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(759)) - isPermissionEnabled = true
2016-09-12 17:14:57,783 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(770)) - HA Enabled: false
2016-09-12 17:14:57,783 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(809)) - Append Enabled: true
2016-09-12 17:14:57,784 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map INodeMap
2016-09-12 17:14:57,784 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:57,784 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 1.0% max memory 3.6 GB = 36.4 MB
2016-09-12 17:14:57,785 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^22 = 4194304 entries
2016-09-12 17:14:57,789 INFO  namenode.FSDirectory (FSDirectory.java:<init>(235)) - ACLs enabled? false
2016-09-12 17:14:57,789 INFO  namenode.FSDirectory (FSDirectory.java:<init>(239)) - XAttrs enabled? true
2016-09-12 17:14:57,790 INFO  namenode.FSDirectory (FSDirectory.java:<init>(247)) - Maximum size of an xattr: 16384
2016-09-12 17:14:57,790 INFO  namenode.NameNode (FSDirectory.java:<init>(295)) - Caching file names occuring more than 10 times
2016-09-12 17:14:57,790 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map cachedBlocks
2016-09-12 17:14:57,791 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:57,791 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.25% max memory 3.6 GB = 9.1 MB
2016-09-12 17:14:57,791 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^20 = 1048576 entries
2016-09-12 17:14:57,792 WARN  namenode.FSNamesystem (FSNamesystem.java:<init>(5655)) - The threshold value should't be greater than 1, threshold: 1.5
2016-09-12 17:14:57,793 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5664)) - dfs.namenode.safemode.threshold-pct = 1.5
2016-09-12 17:14:57,793 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5665)) - dfs.namenode.safemode.min.datanodes = 0
2016-09-12 17:14:57,793 INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(5666)) - dfs.namenode.safemode.extension     = 2147483647
2016-09-12 17:14:57,793 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:57,795 INFO  metrics.TopMetrics (TopMetrics.java:logConf(65)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2016-09-12 17:14:57,795 INFO  metrics.TopMetrics (TopMetrics.java:logConf(67)) - NNTop conf: dfs.namenode.top.num.users = 10
2016-09-12 17:14:57,795 INFO  metrics.TopMetrics (TopMetrics.java:logConf(69)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2016-09-12 17:14:57,795 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(920)) - Retry cache on namenode is enabled
2016-09-12 17:14:57,796 INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(928)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2016-09-12 17:14:57,796 INFO  util.GSet (LightWeightGSet.java:computeCapacity(354)) - Computing capacity for map NameNodeRetryCache
2016-09-12 17:14:57,796 INFO  util.GSet (LightWeightGSet.java:computeCapacity(355)) - VM type       = 64-bit
2016-09-12 17:14:57,797 INFO  util.GSet (LightWeightGSet.java:computeCapacity(356)) - 0.029999999329447746% max memory 3.6 GB = 1.1 MB
2016-09-12 17:14:57,797 INFO  util.GSet (LightWeightGSet.java:computeCapacity(361)) - capacity      = 2^17 = 131072 entries
2016-09-12 17:14:57,803 INFO  common.Storage (Storage.java:tryLock(715)) - Lock on /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/in_use.lock acquired by nodename 25334@hd8
2016-09-12 17:14:57,804 INFO  namenode.NameNode (NameNodeRpcServer.java:<init>(342)) - RPC server is binding to localhost:0
2016-09-12 17:14:57,805 INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(53)) - Using callQueue class java.util.concurrent.LinkedBlockingQueue
2016-09-12 17:14:57,806 INFO  ipc.Server (Server.java:run(606)) - Starting Socket Reader #1 for port 58851
2016-09-12 17:14:57,812 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(6536)) - Registered FSNamesystemState MBean
2016-09-12 17:14:57,812 WARN  common.Util (Util.java:stringAsURI(56)) - Path /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/ should be specified as a URI in configuration files. Please update hdfs configuration.
2016-09-12 17:14:57,822 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:57,823 INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(140)) - Number of blocks under construction: 0
2016-09-12 17:14:57,823 INFO  hdfs.StateChange (FSNamesystem.java:leave(5739)) - STATE* Leaving safe mode after 0 secs
2016-09-12 17:14:57,824 INFO  hdfs.StateChange (FSNamesystem.java:leave(5751)) - STATE* Network topology has 0 racks and 0 datanodes
2016-09-12 17:14:57,824 INFO  hdfs.StateChange (FSNamesystem.java:leave(5754)) - STATE* UnderReplicatedBlocks has 0 blocks
2016-09-12 17:14:57,824 INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateHeartbeatState(458)) - Number of failed storage changes from 0 to 0
2016-09-12 17:14:57,847 INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1703)) - Starting Web-server for hdfs at: http://localhost:0
2016-09-12 17:14:57,849 INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(284)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2016-09-12 17:14:57,850 INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(80)) - Http request log for http.requests.namenode is not defined
2016-09-12 17:14:57,851 INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(710)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2016-09-12 17:14:57,852 INFO  http.HttpServer2 (HttpServer2.java:addFilter(685)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hdfs
2016-09-12 17:14:57,852 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2016-09-12 17:14:57,853 INFO  http.HttpServer2 (HttpServer2.java:addFilter(693)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2016-09-12 17:14:57,854 INFO  http.HttpServer2 (NameNodeHttpServer.java:initWebHdfs(86)) - Added filter 'org.apache.hadoop.hdfs.web.AuthFilter' (class=org.apache.hadoop.hdfs.web.AuthFilter)
2016-09-12 17:14:57,854 INFO  http.HttpServer2 (HttpServer2.java:addJerseyResourcePackage(609)) - addJerseyResourcePackage: packageName=org.apache.hadoop.hdfs.server.namenode.web.resources;org.apache.hadoop.hdfs.web.resources, pathSpec=/webhdfs/v1/*
2016-09-12 17:14:57,856 INFO  http.HttpServer2 (HttpServer2.java:openListeners(915)) - Jetty bound to port 34147
2016-09-12 17:14:57,856 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2016-09-12 17:14:57,871 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:34147
2016-09-12 17:14:57,872 INFO  ipc.Server (Server.java:run(836)) - IPC Server Responder: starting
2016-09-12 17:14:57,873 INFO  ipc.Server (Server.java:run(676)) - IPC Server listener on 58851: starting
2016-09-12 17:14:57,875 INFO  namenode.NameNode (NameNode.java:startCommonServices(697)) - Backup Node RPC up at: localhost/127.0.0.1:58851
2016-09-12 17:14:57,876 INFO  hdfs.StateChange (FSNamesystem.java:reportStatus(6007)) - STATE* Safe mode is ON. 
It was turned on manually. Use "hdfs dfsadmin -safemode leave" to turn safe mode off.
2016-09-12 17:14:57,877 INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(362)) - Recovering unfinalized segments in /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current
2016-09-12 17:14:57,894 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_inprogress_0000000000000000027 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000027-0000000000000000037
2016-09-12 17:14:57,896 INFO  namenode.FSEditLog (FSEditLog.java:registerBackupNode(1382)) - Registering new backup node: NamenodeRegistration(localhost:58851, role=Backup Node)
2016-09-12 17:14:57,898 INFO  namenode.Checkpointer (Checkpointer.java:initialize(108)) - Checkpoint Period : 3600 secs (60 min)
2016-09-12 17:14:57,898 INFO  namenode.Checkpointer (Checkpointer.java:initialize(111)) - Transactions count is  : 1000000, to trigger checkpoint
2016-09-12 17:14:57,898 INFO  namenode.FSNamesystem (FSNamesystem.java:startActiveServices(1123)) - Starting services required for active state
2016-09-12 17:14:57,900 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_4_0 on NN
2016-09-12 17:14:57,900 INFO  namenode.FSNamesystem (FSNamesystem.java:startCheckpoint(6347)) - Start checkpoint for localhost:58851
2016-09-12 17:14:57,901 INFO  namenode.FSImage (FSImage.java:startCheckpoint(1333)) - Start checkpoint at txid 37
2016-09-12 17:14:57,901 INFO  namenode.FSEditLog (FSEditLog.java:rollEditLog(1202)) - Rolling edit logs
2016-09-12 17:14:57,901 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 27
2016-09-12 17:14:57,902 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 12 Total time for transactions(ms): 7 Number of transactions batched in Syncs: 1 Number of syncs: 13 SyncTimes(ms): 4 2 
2016-09-12 17:14:57,903 ERROR namenode.FSNamesystem (FSNamesystem.java:run(5190)) - Swallowing exception in NameNodeEditLogRoller:
java.lang.IllegalStateException: Bad state: BETWEEN_LOG_SEGMENTS
	at com.google.common.base.Preconditions.checkState(Preconditions.java:172)
	at org.apache.hadoop.hdfs.server.namenode.FSEditLog.getCurSegmentTxId(FSEditLog.java:515)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem$NameNodeEditLogRoller.run(FSNamesystem.java:5181)
	at java.lang.Thread.run(Thread.java:745)
2016-09-12 17:14:57,903 INFO  blockmanagement.CacheReplicationMonitor (CacheReplicationMonitor.java:run(160)) - Starting CacheReplicationMonitor with interval 30000 milliseconds
2016-09-12 17:14:57,905 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000027 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000027-0000000000000000038
2016-09-12 17:14:57,907 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000027 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000027-0000000000000000038
2016-09-12 17:14:57,907 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 39
2016-09-12 17:14:57,933 INFO  namenode.FSImage (BackupImage.java:namenodeStartedLogSegment(350)) - NameNode started a new log segment at txid 39
2016-09-12 17:14:57,934 INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1218)) - Starting log segment at 39
2016-09-12 17:14:57,937 DEBUG namenode.FSImage (BackupImage.java:setState(338)) - State transition DROP_UNTIL_NEXT_ROLL -> JOURNAL_ONLY
2016-09-12 17:14:57,944 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 39; numTxns = 1
2016-09-12 17:14:58,054 DEBUG namenode.Checkpointer (Checkpointer.java:doCheckpoint(211)) - Doing checkpoint. Last applied: 0
2016-09-12 17:14:58,056 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 40; numTxns = 1
2016-09-12 17:14:58,058 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_4_0	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:58,058 INFO  namenode.TransferFsImage (TransferFsImage.java:downloadEditsToStorage(154)) - Skipping download of remote edit log [1,2] since it already is stored locally at /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000001-0000000000000000002
2016-09-12 17:14:58,058 INFO  namenode.TransferFsImage (TransferFsImage.java:downloadEditsToStorage(154)) - Skipping download of remote edit log [3,14] since it already is stored locally at /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000003-0000000000000000014
2016-09-12 17:14:58,059 INFO  namenode.TransferFsImage (TransferFsImage.java:downloadEditsToStorage(154)) - Skipping download of remote edit log [15,26] since it already is stored locally at /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000015-0000000000000000026
2016-09-12 17:14:58,059 INFO  namenode.TransferFsImage (TransferFsImage.java:getFileClient(396)) - Opening connection to http://localhost:48395/imagetransfer?getedit=1&startTxId=27&endTxId=38&storageInfo=-63:259848881:0:testClusterID
2016-09-12 17:14:58,059 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_4_0 on BN
2016-09-12 17:14:58,060 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_4_1 on NN
2016-09-12 17:14:58,065 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 41; numTxns = 1
2016-09-12 17:14:58,066 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_4_1	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:58,067 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_4_1 on BN
2016-09-12 17:14:58,068 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_4_2 on NN
2016-09-12 17:14:58,093 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 42; numTxns = 1
2016-09-12 17:14:58,094 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_4_2	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:58,096 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_4_2 on BN
2016-09-12 17:14:58,097 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_4_3 on NN
2016-09-12 17:14:58,103 INFO  namenode.TransferFsImage (TransferFsImage.java:receiveFile(553)) - Transfer took 0.04s at 25.00 KB/s
2016-09-12 17:14:58,103 INFO  namenode.TransferFsImage (TransferFsImage.java:downloadEditsToStorage(168)) - Downloaded file edits_tmp_0000000000000000027-0000000000000000038_0000000000972391059 size 0 bytes.
2016-09-12 17:14:58,104 INFO  namenode.Checkpointer (Checkpointer.java:rollForwardByApplyingLogs(309)) - Checkpointer about to load edits from 4 stream(s).
2016-09-12 17:14:58,104 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 43; numTxns = 1
2016-09-12 17:14:58,104 DEBUG namenode.FSImage (FSImage.java:loadEdits(834)) - About to load edits:
  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000001-0000000000000000002
  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000003-0000000000000000014
  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000015-0000000000000000026
  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000027-0000000000000000038
2016-09-12 17:14:58,104 INFO  namenode.FSImage (FSImage.java:loadEdits(844)) - Reading /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000001-0000000000000000002 expecting start txid #1
2016-09-12 17:14:58,105 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000001-0000000000000000002
2016-09-12 17:14:58,105 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_4_3	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:58,107 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_END_LOG_SEGMENT=1
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:58,107 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000001-0000000000000000002 of size 42 edits # 2 loaded in 0 seconds
2016-09-12 17:14:58,108 INFO  namenode.FSImage (FSImage.java:loadEdits(844)) - Reading /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000003-0000000000000000014 expecting start txid #3
2016-09-12 17:14:58,108 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000003-0000000000000000014
2016-09-12 17:14:58,108 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_4_3 on BN
2016-09-12 17:14:58,114 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=10
  OP_END_LOG_SEGMENT=1
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:58,114 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000003-0000000000000000014 of size 1552 edits # 12 loaded in 0 seconds
2016-09-12 17:14:58,114 INFO  namenode.FSImage (FSImage.java:loadEdits(844)) - Reading /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000015-0000000000000000026 expecting start txid #15
2016-09-12 17:14:58,115 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000015-0000000000000000026
2016-09-12 17:14:58,115 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_4_4 on NN
2016-09-12 17:14:58,120 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=10
  OP_END_LOG_SEGMENT=1
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:58,120 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000015-0000000000000000026 of size 1552 edits # 12 loaded in 0 seconds
2016-09-12 17:14:58,121 INFO  namenode.FSImage (FSImage.java:loadEdits(844)) - Reading /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000027-0000000000000000038 expecting start txid #27
2016-09-12 17:14:58,121 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(145)) - Start loading edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000027-0000000000000000038
2016-09-12 17:14:58,121 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 44; numTxns = 1
2016-09-12 17:14:58,122 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_4_4	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:58,124 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_4_4 on BN
2016-09-12 17:14:58,126 DEBUG namenode.FSImage (FSEditLogLoader.java:dumpOpCounts(1155)) - Summary of operations loaded from edit log:
  OP_ADD=10
  OP_END_LOG_SEGMENT=1
  OP_START_LOG_SEGMENT=1
2016-09-12 17:14:58,126 INFO  namenode.FSImage (FSEditLogLoader.java:loadFSEdits(148)) - Edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/edits_0000000000000000027-0000000000000000038 of size 1552 edits # 12 loaded in 0 seconds
2016-09-12 17:14:58,127 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2016-09-12 17:14:58,127 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_4_5 on NN
2016-09-12 17:14:58,189 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/fsimage.ckpt_0000000000000000038 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/fsimage_0000000000000000038
2016-09-12 17:14:58,190 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 26
2016-09-12 17:14:58,190 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name-backup1/current/fsimage_0000000000000000002, cpktTxId=0000000000000000002)
2016-09-12 17:14:58,196 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 45; numTxns = 1
2016-09-12 17:14:58,197 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_4_5	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:58,199 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_4_5 on BN
2016-09-12 17:14:58,201 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_4_6 on NN
2016-09-12 17:14:58,205 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 46; numTxns = 1
2016-09-12 17:14:58,228 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_4_6	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:58,230 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_4_6 on BN
2016-09-12 17:14:58,231 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_4_7 on NN
2016-09-12 17:14:58,235 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 47; numTxns = 1
2016-09-12 17:14:58,236 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_4_7	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:58,238 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_4_7 on BN
2016-09-12 17:14:58,239 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_4_8 on NN
2016-09-12 17:14:58,241 INFO  namenode.TransferFsImage (TransferFsImage.java:receiveFile(553)) - Transfer took 0.04s at 23.81 KB/s
2016-09-12 17:14:58,241 INFO  namenode.TransferFsImage (TransferFsImage.java:handleUploadImageRequest(134)) - Downloaded file fsimage.ckpt_0000000000000000038 size 1827 bytes.
2016-09-12 17:14:58,243 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 48; numTxns = 1
2016-09-12 17:14:58,244 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_4_8	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:58,245 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_4_8 on BN
2016-09-12 17:14:58,246 INFO  namenode.TestBackupNode (TestBackupNode.java:testBNInSync(222)) - Creating /test_4_9 on NN
2016-09-12 17:14:58,272 TRACE namenode.FSImage (BackupImage.java:journal(164)) - Got journal, state = JOURNAL_ONLY; firstTxId = 49; numTxns = 1
2016-09-12 17:14:58,273 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(8846)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/test_4_9	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2016-09-12 17:14:58,274 INFO  namenode.TestBackupNode (TestBackupNode.java:get(229)) - Checking for /test_4_9 on BN
2016-09-12 17:14:58,312 INFO  namenode.TestBackupNode (TestBackupNode.java:testBackupNodeTailsEdits(203)) - Shutting down...
2016-09-12 17:14:58,313 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage.ckpt_0000000000000000038 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000038
2016-09-12 17:14:58,314 DEBUG namenode.FSImage (FSImage.java:renameImageFileInDir(1291)) - renaming  /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage.ckpt_0000000000000000038 to /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000038
2016-09-12 17:14:58,314 INFO  namenode.NameNode (NameNodeRpcServer.java:errorReport(501)) - Error report from NamenodeRegistration(localhost:58851, role=Backup Node): Shutting down.
2016-09-12 17:14:58,315 INFO  namenode.FSEditLog (FSEditLog.java:releaseBackupStream(1393)) - Removing backup journal BackupJournalManager
SEEEEEEEEEEEEEEEEEEEEETcheckpointManager null
2016-09-12 17:14:58,315 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 2 images with txid >= 26
2016-09-12 17:14:58,316 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:58,316 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/fsimage_0000000000000000002, cpktTxId=0000000000000000002)
2016-09-12 17:14:58,316 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5196)) - NameNodeEditLogRoller was interrupted, exiting
2016-09-12 17:14:58,316 INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:purgeImage(225)) - Purging old image FSImageFile(file=/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/fsimage_0000000000000000002, cpktTxId=0000000000000000002)
2016-09-12 17:14:58,317 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5269)) - LazyPersistFileScrubber was interrupted, exiting
2016-09-12 17:14:58,318 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 58851
2016-09-12 17:14:58,320 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:58,321 INFO  blockmanagement.BlockManager (BlockManager.java:run(3636)) - Stopping ReplicationMonitor.
2016-09-12 17:14:58,321 INFO  namenode.TransferFsImage (TransferFsImage.java:uploadImageFromStorage(237)) - Uploaded image with txid 38 to namenode at http://localhost:48395 in 0.125 seconds
2016-09-12 17:14:58,322 ERROR namenode.Checkpointer (Checkpointer.java:run(158)) - Throwable Exception in doCheckpoint: 
java.lang.NullPointerException
	at org.apache.hadoop.hdfs.server.namenode.Checkpointer.doCheckpoint(Checkpointer.java:270)
	at org.apache.hadoop.hdfs.server.namenode.Checkpointer.run(Checkpointer.java:152)
2016-09-12 17:14:58,333 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:58,333 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 58851
2016-09-12 17:14:58,333 INFO  namenode.FSNamesystem (FSNamesystem.java:stopStandbyServices(1317)) - Stopping services started for standby state
2016-09-12 17:14:58,337 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:58,445 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688229(/test_4_0) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,446 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_4_0 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,449 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688167(/test_2_2) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,449 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_2_2 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,452 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688237(/test_4_2) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,453 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_4_2 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,455 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688169(/test_2_3) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,456 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_2_3 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,458 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688233(/test_4_1) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,458 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_4_1 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,460 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688172(/test_2_4) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,461 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_2_4 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,463 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688174(/test_2_5) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,464 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_2_5 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,468 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688244(/test_4_4) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,469 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_4_4 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,471 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688176(/test_2_6) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,472 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_2_6 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,474 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688247(/test_4_5) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,474 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_4_5 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,476 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688179(/test_2_7) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,477 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_2_7 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,479 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688240(/test_4_3) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,480 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_4_3 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,483 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688183(/test_2_8) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,484 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_2_8 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,486 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688252(/test_4_7) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,486 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_4_7 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,488 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688254(/test_4_8) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,489 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_4_8 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,491 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688188(/test_2_9) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,492 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_2_9 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,495 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688250(/test_4_6) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,495 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_4_6 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,497 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688190(/test_3_0) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,498 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_3_0 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,501 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688199(/test_3_3) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,502 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_3_3 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,504 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688197(/test_3_2) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,504 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_3_2 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,506 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688135(/test_1_1) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,507 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_1_1 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,509 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688194(/test_3_1) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,510 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_3_1 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,512 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688133(/test_1_0) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,512 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_1_0 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,514 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688256(/test_4_9) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,515 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_4_9 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,517 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688205(/test_3_5) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,518 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_3_5 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,520 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688137(/test_1_2) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,520 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_1_2 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,522 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688143(/test_1_4) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,523 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_1_4 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,525 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688202(/test_3_4) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,526 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_3_4 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,528 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688141(/test_1_3) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,529 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_1_3 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,531 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688147(/test_1_6) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,531 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_1_6 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,533 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688213(/test_3_7) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,534 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_3_7 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,536 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688145(/test_1_5) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,537 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_1_5 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,539 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688151(/test_1_8) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,539 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_1_8 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,541 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688209(/test_3_6) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,542 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_3_6 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,544 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688149(/test_1_7) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,544 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_1_7 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,546 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688154(/test_1_9) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,547 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_1_9 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,550 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688220(/test_3_9) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,551 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_3_9 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,553 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688159(/test_2_1) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,554 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_2_1 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,556 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688216(/test_3_8) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,556 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_3_8 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,558 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3925)) - DIR* completeFile: request from DFSClient_NONMAPREDUCE_1965260784_1 to complete inode 688156(/test_2_0) which is already closed. But, it appears to be an RPC retry. Returning success
2016-09-12 17:14:58,559 INFO  hdfs.StateChange (FSNamesystem.java:completeFile(3944)) - DIR* completeFile: /test_2_0 is closed by DFSClient_NONMAPREDUCE_1965260784_1
2016-09-12 17:14:58,560 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdown(1712)) - Shutting down the Mini HDFS Cluster
2016-09-12 17:14:58,560 INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdownDataNodes(1744)) - Shutting down DataNode 0
2016-09-12 17:14:58,560 WARN  datanode.DirectoryScanner (DirectoryScanner.java:shutdown(378)) - DirectoryScanner: shutdown has been called
2016-09-12 17:14:58,562 INFO  datanode.VolumeScanner (VolumeScanner.java:run(628)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data1, DS-bb245804-7784-4efa-b422-7bc621a3c3c9) exiting.
2016-09-12 17:14:58,562 INFO  datanode.VolumeScanner (VolumeScanner.java:run(628)) - VolumeScanner(/home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/data/data2, DS-fedd7aa3-9bb8-4493-a29d-68838547aa9e) exiting.
2016-09-12 17:14:58,570 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:58,571 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 60155
2016-09-12 17:14:58,573 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 60155
2016-09-12 17:14:58,573 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:58,573 WARN  datanode.DataNode (BPServiceActor.java:offerService(704)) - BPOfferService for Block pool BP-457114912-192.168.9.78-1473671695113 (Datanode Uuid 2b9cedc8-3d8c-433a-bf66-3c44c106dcfc) service to localhost/127.0.0.1:60114 interrupted
2016-09-12 17:14:58,573 WARN  datanode.DataNode (BPServiceActor.java:run(834)) - Ending block pool service for: Block pool BP-457114912-192.168.9.78-1473671695113 (Datanode Uuid 2b9cedc8-3d8c-433a-bf66-3c44c106dcfc) service to localhost/127.0.0.1:60114
2016-09-12 17:14:58,574 INFO  datanode.DataNode (BlockPoolManager.java:remove(103)) - Removed Block pool BP-457114912-192.168.9.78-1473671695113 (Datanode Uuid 2b9cedc8-3d8c-433a-bf66-3c44c106dcfc)
2016-09-12 17:14:58,574 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:shutdownBlockPool(2484)) - Removing block pool BP-457114912-192.168.9.78-1473671695113
2016-09-12 17:14:58,577 INFO  impl.FsDatasetImpl (FsDatasetImpl.java:run(2955)) - LazyWriter was interrupted, exiting
2016-09-12 17:14:58,577 INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(184)) - Shutting down all async disk service threads
2016-09-12 17:14:58,577 INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(192)) - All async disk service threads have been shut down
2016-09-12 17:14:58,578 INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(162)) - Shutting down all async lazy persist service threads
2016-09-12 17:14:58,578 INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(169)) - All async lazy persist service threads have been shut down
2016-09-12 17:14:58,579 INFO  datanode.DataNode (DataNode.java:shutdown(1827)) - Shutdown complete.
2016-09-12 17:14:58,579 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:58,580 INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1259)) - Ending log segment 39
2016-09-12 17:14:58,580 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5269)) - LazyPersistFileScrubber was interrupted, exiting
2016-09-12 17:14:58,580 INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(699)) - Number of transactions: 52 Total time for transactions(ms): 14 Number of transactions batched in Syncs: 1 Number of syncs: 53 SyncTimes(ms): 43 2 
2016-09-12 17:14:58,580 INFO  namenode.FSNamesystem (FSNamesystem.java:run(5196)) - NameNodeEditLogRoller was interrupted, exiting
2016-09-12 17:14:58,581 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_inprogress_0000000000000000039 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name1/current/edits_0000000000000000039-0000000000000000090
2016-09-12 17:14:58,582 INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(133)) - Finalizing edits file /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_inprogress_0000000000000000039 -> /home/zhanglei/extension/nas-hadoop/hadoop-hdfs-project/hadoop-hdfs-nas/target/test/data/dfs/name2/current/edits_0000000000000000039-0000000000000000090
2016-09-12 17:14:58,585 INFO  ipc.Server (Server.java:stop(2447)) - Stopping server on 60114
2016-09-12 17:14:58,586 INFO  ipc.Server (Server.java:run(708)) - Stopping IPC Server listener on 60114
2016-09-12 17:14:58,588 INFO  ipc.Server (Server.java:run(841)) - Stopping IPC Server Responder
2016-09-12 17:14:58,588 INFO  blockmanagement.BlockManager (BlockManager.java:run(3636)) - Stopping ReplicationMonitor.
2016-09-12 17:14:58,598 INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1229)) - Stopping services started for active state
2016-09-12 17:14:58,599 INFO  namenode.FSNamesystem (FSNamesystem.java:stopStandbyServices(1317)) - Stopping services started for standby state
2016-09-12 17:14:58,602 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped HttpServer2$SelectChannelConnectorWithSafeStartup@localhost:0
2016-09-12 17:14:58,703 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(211)) - Stopping BackupNode metrics system...
2016-09-12 17:14:58,705 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(217)) - BackupNode metrics system stopped.
2016-09-12 17:14:58,706 INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:shutdown(606)) - BackupNode metrics system shutdown complete.
